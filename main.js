(()=>{"use strict";const e=()=>{const e=["A","B","C","D","E","F","G","H","I","J"],t=["1","2","3","4","5","6","7","8","9","10"],a=[],r=[],s=(r,s)=>{const o=e.indexOf(r),i=t.indexOf(s);return-1===o||-1===i?null:a[i][o]},o=(r,s,o,i)=>{const l=e.indexOf(r),n=t.indexOf(s);return-1===l||-1===n?null:(a[n][l].status=o,i&&(a[n][l].takenBy=i),a[n][l])};return(()=>{for(let r=0;r<10;r+=1){a[r]=[];for(let s=0;s<10;s+=1)a[r][s]={col:e[s],row:t[r],status:"empty",takenBy:null}}})(),{clearBoard:()=>{for(let e=0;e<10;e+=1)for(let t=0;t<10;t+=1)a[e][t].status="empty",a[e][t].takenBy=void 0;r.length=0},getCell:s,setCell:o,removeShip:(e,t)=>{t.array.flat().forEach((a=>{let s;"taken"===a.status&&a.takenBy.name===e.name&&(a.status="empty",a.takenBy=null),r.forEach((e=>{null===e.takenBy&&r.splice(r.indexOf(e),1)})),t===n.humanGameboard?s="firstBoard":t===n.computerGameboard&&(s="secondBoard");document.querySelectorAll(`#${s} .cell`).forEach((t=>{t.classList.contains("taken")&&t.getAttribute("data-shipName")===e.name.toLowerCase()&&(t.classList.remove("taken"),t.classList.add("empty"),t.removeAttribute("data-shipName"))}))}))},placeShip:(a,i,l,n)=>{a.isVertical="horizontal"!==n;const c="horizontal"===n,d=c?e:t,u=d.indexOf(c?i:l);let h=[];if(u<0||u+a.size>d.length)return!1;for(let e=0;e<a.size;e+=1){const t=c?d[u+e]:i,r=c?l:d[u+e];if("empty"!==s(t,r).status)return!1;o(t,r,"taken",a),h.push(s(t,r))}return r.push(h[0]),!0},receiveAttack:(e,t)=>{const a=s(e,t);return"taken"===a.status?(a.takenBy.hit(),o(e,t,"hit"),a.status):"empty"===a.status||"reserved"===a.status?(o(e,t,"miss"),a.status):null},receiveAround:(e,t)=>{const a=s(e,t);return"empty"===a.status?(o(e,t,"reserved"),a.status):null},reserveSpace:(e,t,a)=>{const r=e.getCell(t,a);if(r&&r.takenBy){e.array.flat().filter((e=>e.takenBy&&e.takenBy.name===r.takenBy.name)).forEach((t=>{[{col:0,row:-1},{col:0,row:1},{col:-1,row:0},{col:1,row:0},{col:-1,row:-1},{col:-1,row:1},{col:1,row:-1},{col:1,row:1}].forEach((a=>{const r=String.fromCharCode(t.col.charCodeAt(0)+a.col),s=(Number(t.row)+a.row).toString();e.getCell(r,s)&&e.receiveAround(r,s)}))}))}},hitButNotSunk:e=>e.array.flat().some((e=>"hit"===e.status&&!1===e.takenBy.isSunk())),sinkShip:(e,t,a)=>{const r=e.getCell(t,a);if(r&&r.takenBy&&r.takenBy.isSunk()){e.array.flat().filter((e=>e.takenBy&&e.takenBy.name===r.takenBy.name)).forEach((t=>{[{col:0,row:-1},{col:0,row:1},{col:-1,row:0},{col:1,row:0},{col:-1,row:-1},{col:-1,row:1},{col:1,row:-1},{col:1,row:1}].forEach((a=>{const r=String.fromCharCode(t.col.charCodeAt(0)+a.col),s=(Number(t.row)+a.row).toString();e.getCell(r,s)&&e.receiveAttack(r,s)}))}))}},allSunk:e=>{let t=e.array.flat().filter((e=>e.takenBy));return!!(t.length>0&&t.every((e=>e.takenBy.isSunk())))},array:a,canBePlaced:(a,r,o,i)=>{const l="horizontal"===i,n=l?e:t,c=n.indexOf(l?r:o);if(c<0||c+a>n.length)return!1;const d=[];for(let e=0;e<a;e+=1){const t=l?n[c+e]:r,a=l?o:n[c+e];d.push("empty"===s(t,a).status)}return d.every((e=>!0===e))},shipsPlaced:r,removeReservedSpace:e=>{e.array.flat().forEach((e=>{"reserved"===e.status&&o(e.col,e.row,"empty")}))}}},t=e=>{let t;return"Carrier"===e&&(t=5),"Battleship"===e&&(t=4),"Destroyer"===e&&(t=3),"Submarine"===e&&(t=3),"PatrolBoat"===e&&(t=2),{name:e,size:t,hitCount:0,isVertical:!1,rotate(){this.isVertical=!this.isVertical},hit(){this.hitCount+=1},isSunk(){return this.hitCount===t}}},a=()=>{const e=["A","B","C","D","E","F","G","H","I","J"];let t=null,a=null;let r=1,s=!0,o=!0;const i=(e,t,c,d)=>{if(d.row===c)if(s){r=1;let o=String.fromCharCode(t.charCodeAt(0)+r);for(;e.getCell(o,c)&&"hit"===e.getCell(o,c).status;)r+=1,o=String.fromCharCode(t.charCodeAt(0)+r);e.getCell(o,c)&&"hit"!==e.getCell(o,c).status&&"miss"!==e.getCell(o,c).status?(e.receiveAttack(o,c),"hit"===e.getCell(o,c).status&&(l(a),n({col:o,row:c})),r+=1):(r=1,s=!1,i(e,o,c,d))}else{r=1;let o=String.fromCharCode(t.charCodeAt(0)-r);for(;e.getCell(o,c)&&"hit"===e.getCell(o,c).status;)r+=1,o=String.fromCharCode(t.charCodeAt(0)-r);e.getCell(o,c)&&"hit"!==e.getCell(o,c).status&&"miss"!==e.getCell(o,c).status?(e.receiveAttack(o,c),"hit"===e.getCell(o,c).status&&(l(a),n({col:o,row:c})),r+=1):(r=1,s=!0,i(e,o,c,d))}else if(d.col===t)if(o){r=1;let s=(Number(c)+r).toString();for(;e.getCell(t,s)&&"hit"===e.getCell(t,s).status;)r+=1,s=(Number(c)+r).toString();e.getCell(t,s)&&"hit"!==e.getCell(t,s).status&&"miss"!==e.getCell(t,s).status?(e.receiveAttack(t,s),"hit"===e.getCell(t,s).status&&(l(a),n({col:t,row:s})),r+=1):(r=1,o=!1,i(e,t,s,d))}else{r=1;let s=(Number(c)-r).toString();for(;e.getCell(t,s)&&"hit"===e.getCell(t,s).status;)r+=1,s=(Number(c)-r).toString();e.getCell(t,s)&&"hit"!==e.getCell(t,s).status&&"miss"!==e.getCell(t,s).status?(e.receiveAttack(t,s),"hit"===e.getCell(t,s).status&&(l(a),n({col:t,row:s})),r+=1):(r=1,o=!0,i(e,t,s,d))}},l=e=>{t=e},n=e=>{a=e};return{attack:(e,t,r)=>{if("hit"!==e.getCell(t,r).status&&"miss"!==e.getCell(t,r).status){let s=e.receiveAttack(t,r);return"hit"===s&&(l(a),n({col:t,row:r})),s}return"already shot"},randomAttack:t=>{let r,s;do{r=e[Math.floor(Math.random()*e.length)],s=Math.ceil(10*Math.random()).toString()}while("hit"===t.getCell(r,s).status||"miss"===t.getCell(r,s).status);if("hit"!==t.getCell(r,s).status&&"miss"!==t.getCell(r,s).status){const e=t.receiveAttack(r,s);return"hit"===t.getCell(r,s).status&&(l(a),n({col:r,row:s})),{result:e,col:r,row:s}}return{result:"already shot",col:r,row:s}},followupAttack:(e,t,s)=>{const o=[{col:0,row:-1},{col:0,row:1},{col:-1,row:0},{col:1,row:0}].filter((a=>{const r=String.fromCharCode(t.charCodeAt(0)+a.col),o=(Number(s)+a.row).toString(),i=e.getCell(r,o);return!(!i||"miss"===i.status||"hit"===i.status)}));if(o.length>0){const i=o[Math.floor(Math.random()*o.length)],c=String.fromCharCode(t.charCodeAt(0)+i.col),d=(Number(s)+i.row).toString();e.receiveAttack(c,d),r=1,"hit"===e.getCell(c,d).status&&(l(a),n({col:c,row:d}))}},finishingAttack:i,prevHit:t,lastHit:a,getPrevHit:()=>t,getLastHit:()=>a,setPrevHit:l,setLastHit:n}};var r=function(e,t,a,r){return new(a||(a=Promise))((function(s,o){function i(e){try{n(r.next(e))}catch(e){o(e)}}function l(e){try{n(r.throw(e))}catch(e){o(e)}}function n(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}n((r=r.apply(e,t||[])).next())}))};const s=(()=>{const e=document.querySelector("#messageBox p"),t=document.querySelector("#boards"),a=document.querySelector("#playerVsComputer"),o=document.querySelector("#newGame"),i=document.querySelector("#computerVsComputer"),l=document.querySelector("#start"),c=document.querySelector("#randomPlacement"),d=[a,o,i,l,c],u=document.getElementsByName("speed"),h=(e,t)=>{e.array.forEach((e=>{e.forEach((e=>{const a=(e=>{const t=document.createElement("div");return t.classList.add("cell"),t.classList.add(e.status),t.setAttribute("data-col",e.col),t.setAttribute("data-row",e.row),e.takenBy&&t.setAttribute("data-shipName",e.takenBy.name.toLowerCase()),t})(e);t.append(a)}))}))},m=e=>{let t;e===n.humanGameboard?t="firstBoard":e===n.computerGameboard&&(t="secondBoard");const a=document.querySelector(`#${t}`);a.innerHTML="",h(e,a)},f=e=>{if(!e.target.classList.contains("hit")&&!e.target.classList.contains("miss")){return{col:e.target.getAttribute("data-col"),row:e.target.getAttribute("data-row")}}},p=(e,t)=>{t.classList.remove("selected"),e.classList.contains("selected")||(e.classList.add("selected"),e===a&&r(void 0,void 0,void 0,(function*(){k("first"),g(!0),d.forEach((e=>e.disabled=!0)),yield new Promise((e=>setTimeout(e,L()))),d.forEach((e=>e.disabled=!1)),g(!1),S(),w()})),e===i&&r(void 0,void 0,void 0,(function*(){g(!0),d.forEach((e=>e.disabled=!0)),yield new Promise((e=>setTimeout(e,L()))),d.forEach((e=>e.disabled=!1)),g(!1),l.disabled=!0,c.disabled=!0,i.disabled=!0})),n.restart(),B())},g=e=>{document.documentElement.classList.toggle("wait",e)},v=(e,t)=>{t.forEach((t=>{const a=document.createElement("div"),r=t.takenBy.name.toLowerCase(),s=t.takenBy.size,o=t.takenBy.isVertical;a.classList.add("ship",r),a.setAttribute("data-size",`${s}`),a.setAttribute("data-name",`${r}`),a.setAttribute("draggable","true"),a.classList.add("draggable");const i=()=>{const e=document.querySelector("html"),t=parseFloat(window.getComputedStyle(e,null).getPropertyValue("font-size"));o?o&&(a.style.width=n/t+"rem",a.style.height=s*(n/t)+"rem"):(a.style.width=s*(n/t)+"rem",a.style.height=n/t+"rem")};let l,n=document.querySelector(".board .cell").getBoundingClientRect().width;i(),window.addEventListener("resize",(function(){n=document.querySelector(".board .cell").getBoundingClientRect().width,i()})),"first"===e?l="firstBoard":"second"===e&&(l="secondBoard");document.querySelector(`#${l} .cell[data-col="${t.col}"][data-row="${t.row}"]`).appendChild(a)}))},S=()=>5===n.humanGameboard.shipsPlaced.length&&0===n.computerGameboard.shipsPlaced.length?(k("second"),l.disabled=!1,!0):(l.disabled=!0,!1),w=()=>{e.textContent="Use 'Random Placement' button, then press Start!",window.matchMedia("(min-width: 1024px)").matches&&(e.textContent="Drag and drop ships onto the left board or use 'Random Placement' button. Right click to rotate. When ready, press Start!")},y=()=>{S()&&(e.textContent="You can now begin the game. Press start!")},B=()=>{e.textContent="Restarting..."},C=(e,t,a)=>{let s,o,i,l,c=0,d=0,u=[];const h={carrier:a[0],battleship:a[1],destroyer:a[2],submarine:a[3],patrolboat:a[4]},f=document.querySelector("#firstBoard"),p=document.querySelector("#secondBoard"),g=f.querySelectorAll(".cell"),w=p.querySelectorAll(".cell"),B=[];for(let e of g)e.classList.contains("taken")||B.push(e);for(let e of w)e.classList.contains("taken")||B.push(e);document.querySelectorAll(".draggable").forEach((e=>{e.addEventListener("mousedown",L),e.addEventListener("mouseup",k),e.addEventListener("dragstart",P),e.addEventListener("dragend",V),e.addEventListener("contextmenu",z),B.forEach((e=>{e.addEventListener("contextmenu",G)}))}));let b=null;function L(a){e.removeReservedSpace(e),t.removeReservedSpace(t);const r=a.target.getAttribute("data-name");let s=e.shipsPlaced.filter((e=>r!==e.takenBy.name.toLowerCase())),o=t.shipsPlaced.filter((e=>r!==e.takenBy.name.toLowerCase()));s.forEach((t=>{e.reserveSpace(e,t.col,t.row)})),o.forEach((e=>{t.reserveSpace(t,e.col,e.row)})),m(e),m(t),v("first",e.shipsPlaced),v("second",t.shipsPlaced),C(e,t,n.humanShips)}function k(){e.shipsPlaced.forEach((t=>{e.reserveSpace(e,t.col,t.row)})),t.shipsPlaced.forEach((e=>{t.reserveSpace(t,e.col,e.row)})),m(e),m(t),v("first",e.shipsPlaced),v("second",t.shipsPlaced),C(e,t,n.humanShips)}function P(a){return r(this,void 0,void 0,(function*(){yield new Promise((e=>setTimeout(e,0)));const r=a.target;r.style.visibility="hidden",this.classList.add("dragging"),s=r.getAttribute("data-name"),o=Number(r.getAttribute("data-size")),c=a.offsetX,d=a.offsetY,i=h[s],l=i.isVertical?"vertical":"horizontal","firstBoard"===r.closest(".board").id&&e.removeShip(i,e),"secondBoard"===r.closest(".board").id&&t.removeShip(i,t)}))}function E(e){return function(t){const a=t.target;if("firstBoard"===a.closest(".board").id&&(t.preventDefault(),i)){let t=e-(i.isVertical?10*Math.floor(d/this.offsetHeight):Math.floor(c/this.offsetWidth));const a=[];for(let e=0;e<o;e++){let r=i.isVertical?t+10*e:t+e;g[r]&&(a.push(g[r]),u.push(g[r]))}M(a)&&(a.forEach((e=>{e.classList.add("highlight")})),b||(b=q(u,o)))}if("secondBoard"===a.closest(".board").id&&(t.preventDefault(),i)){let t=e-(i.isVertical?10*Math.floor(d/this.offsetHeight):Math.floor(c/this.offsetWidth));const a=[];for(let e=0;e<o;e++){let r=i.isVertical?t+10*e:t+e;w[r]&&(a.push(w[r]),u.push(w[r]))}M(a)&&(a.forEach((e=>{e.classList.add("highlight")})),b||(b=q(u,o)))}}}function A(){u.forEach((e=>{e.classList.remove("highlight")})),u=[]}function H(a){u.forEach((e=>{e.classList.remove("highlight")}));const r=q(u,o),s=a.target;"firstBoard"===s.closest(".board").id&&i&&null!==b&&(e.canBePlaced(i.size,r[0].dataset.col,r[0].dataset.row,l)?(e.placeShip(i,r[0].dataset.col,r[0].dataset.row,l),e.reserveSpace(e,r[0].dataset.col,r[0].dataset.row)):(e.placeShip(i,b[0].dataset.col,b[0].dataset.row,l),e.reserveSpace(e,b[0].dataset.col,b[0].dataset.row))),"secondBoard"===s.closest(".board").id&&i&&null!==b&&(t.canBePlaced(i.size,r[0].dataset.col,r[0].dataset.row,l)?(t.placeShip(i,r[0].dataset.col,r[0].dataset.row,l),t.reserveSpace(t,r[0].dataset.col,r[0].dataset.row)):(t.placeShip(i,b[0].dataset.col,b[0].dataset.row,l),t.reserveSpace(t,b[0].dataset.col,b[0].dataset.row))),e.removeReservedSpace(e),t.removeReservedSpace(t),e.shipsPlaced.forEach((t=>{e.reserveSpace(e,t.col,t.row)})),t.shipsPlaced.forEach((e=>{t.reserveSpace(t,e.col,e.row)})),m(e),m(t),v("first",e.shipsPlaced),v("second",t.shipsPlaced),C(e,t,n.humanShips),S(),y(),b=null}function V(a){const r=a.target;r.style.visibility="visible",this.classList.remove("dragging"),0===u.length&&("firstBoard"===r.closest(".board").id?b&&e.canBePlaced(i.size,b[0].dataset.col,b[0].dataset.row,l)&&(e.placeShip(i,b[0].dataset.col,b[0].dataset.row,l),e.reserveSpace(e,b[0].dataset.col,b[0].dataset.row),m(e),m(t),v("first",e.shipsPlaced),v("second",t.shipsPlaced),C(e,t,n.humanShips)):"secondBoard"===r.closest(".board").id&&b&&t.canBePlaced(i.size,b[0].dataset.col,b[0].dataset.row,l)&&(t.placeShip(i,b[0].dataset.col,b[0].dataset.row,l),t.reserveSpace(t,b[0].dataset.col,b[0].dataset.row),m(e),m(t),v("first",e.shipsPlaced),v("second",t.shipsPlaced),C(e,t,n.humanShips)))}function M(e){return e.every((e=>e.classList.contains("empty")))&&(e.every((t=>t.dataset.col===e[0].dataset.col))||e.every((t=>t.dataset.row===e[0].dataset.row)))&&e.length===o&&e.every((e=>e.dataset.col>="A"&&e.dataset.col<="J"))&&e.every((e=>Number(e.dataset.row)>=1&&Number(e.dataset.row)<=10))}function q(e,t){return e.slice(Math.min(e.length-t,0))}function z(a){a.preventDefault();const r=a.target;let c;"firstBoard"===r.closest(".board").id&&(c=e),"secondBoard"===r.closest(".board").id&&(c=t),s=r.getAttribute("data-name"),o=Number(r.getAttribute("data-size")),i=h[s];const d=i,u=c.shipsPlaced.filter((e=>e.takenBy.name.toLowerCase()===s));c.removeShip(i,c),c.removeReservedSpace(c),c.shipsPlaced.forEach((e=>{c.reserveSpace(c,e.col,e.row)})),d.rotate(),l=d.isVertical?"vertical":"horizontal",c.canBePlaced(d.size,u[0].col,u[0].row,l)||(d.rotate(),l=d.isVertical?"vertical":"horizontal"),c.placeShip(d,u[0].col,u[0].row,l),c.shipsPlaced.forEach((e=>{c.reserveSpace(c,e.col,e.row)})),m(c),v("first",e.shipsPlaced),v("second",t.shipsPlaced),C(e,t,n.humanShips)}function G(e){e.preventDefault()}g.forEach(((e,t)=>{e.addEventListener("dragover",E(t)),e.addEventListener("dragleave",A),e.addEventListener("drop",H)})),w.forEach(((e,t)=>{e.addEventListener("dragover",E(t)),e.addEventListener("dragleave",A),e.addEventListener("drop",H)}))};a.addEventListener("click",(()=>{k("first"),p(a,i);document.querySelector("#secondBoard").classList.remove("start"),P("first"),l.disabled=!0,a.disabled=!0})),i.addEventListener("click",(()=>{k("first"),k("second"),p(i,a);const e=document.querySelector("#secondBoard");e.classList.remove("hide"),e.classList.add("start"),Promise.all([P("first"),P("second")]),l.disabled=!0,c.disabled=!0,i.disabled=!0})),o.addEventListener("click",(()=>r(void 0,void 0,void 0,(function*(){k("first"),i.classList.contains("selected")&&(k("second"),l.disabled=!0,c.disabled=!0,i.disabled=!0),s.removeBoardPointer(),yield r(void 0,void 0,void 0,(function*(){B(),g(!0),d.forEach((e=>e.disabled=!0)),yield n.newGame(),d.forEach((e=>e.disabled=!1)),g(!1),S(),a.classList.contains("selected")&&w()}));const e=document.querySelector("#secondBoard");e.classList.remove("hide"),a.classList.contains("selected")&&(e.classList.remove("start"),P("first"),l.disabled=!0,a.disabled=!0),i.classList.contains("selected")&&(e.classList.add("start"),c.disabled=!0,Promise.all([P("first"),P("second")]),l.disabled=!0,c.disabled=!0,i.disabled=!0)})))),l.addEventListener("click",(()=>{n.start();document.querySelector("#firstBoard").classList.add("hide");const e=document.querySelector("#secondBoard");e.classList.add("hide"),e.classList.add("start"),P("second"),l.disabled=!0,c.disabled=!0})),c.addEventListener("click",(()=>{n.computerGameboard.clearBoard(),m(n.computerGameboard),n.randomizeShipsPlacement("first",n.humanGameboard),C(n.humanGameboard,n.computerGameboard,n.humanShips),S(),y(),k("second")}));let b=1e3;u.forEach((e=>{e.addEventListener("click",(()=>{let t=e;t.checked&&(b=Number(t.value))}))}));const L=()=>b;window.addEventListener("resize",w);const k=e=>{let t;"first"===e?t=document.querySelector("#firstBoard"):"second"===e&&(t=document.querySelector("#secondBoard"));t.querySelectorAll(".cell").forEach((e=>{e.classList.add("filled")}))},P=e=>r(void 0,void 0,void 0,(function*(){let t;g(!0),"first"===e?t=document.querySelector("#firstBoard"):"second"===e&&(t=document.querySelector("#secondBoard"));const a=t.querySelectorAll(".cell");a.forEach((e=>{e.classList.add("filled")})),yield new Promise((e=>{a.forEach(((t,r)=>{setTimeout((()=>{t.classList.remove("filled"),r===a.length-1&&e()}),L()/120*r)}))})),g(!1)}));return{renderBoard:e=>{const a=document.createElement("div");a.classList.add("board"),e===n.humanGameboard?a.id="firstBoard":e===n.computerGameboard&&(a.id="secondBoard"),h(e,a),t.append(a)},refreshBoard:m,handleUserInput:()=>r(void 0,void 0,void 0,(function*(){const e=document.querySelectorAll("#secondBoard .cell");let t;do{t=yield new Promise((t=>{e.forEach((e=>{e.classList.contains("hit")||e.classList.contains("miss")||e.addEventListener("click",(e=>{t(f(e))}),{once:!0})}))}))}while(!t);return{col:t.col.toString(),row:t.row.toString()}})),pVcBtn:a,cVcBtn:i,waiting:g,setBoardPointer:e=>{const t=document.querySelector("#secondBoard");"player"===e?t.classList.add("boardOutline"):"computer"===e&&t.classList.remove("boardOutline")},removeBoardPointer:()=>{document.querySelector("#secondBoard").classList.remove("boardOutline")},createShipOverlay:v,dragAndDrop:C,canBeStarted:S,setInitMessage:w,setTurnMessagePvC:t=>{e.textContent=t?"Player's turn. Take aim and attack!":"Computer's turn. The shot is coming!"},setTurnMessageCvC:t=>{e.textContent=t?"Violet's turn":"Blue's turn"},setGameOverMessagePvC:t=>{"player"===t?e.textContent="Game over, Player wins!":"computer"===t&&(e.textContent="Game over, Computer wins!")},setGameOverMessageCvC:t=>{"player"===t?e.textContent="Game over, Blue Computer wins!":"computer"===t&&(e.textContent="Game over, Violet Computer wins!")},setRestartMessage:B,getSpeedValue:L,unFillCells:P}})(),o=s;var i=function(e,t,a,r){return new(a||(a=Promise))((function(s,o){function i(e){try{n(r.next(e))}catch(e){o(e)}}function l(e){try{n(r.throw(e))}catch(e){o(e)}}function n(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}n((r=r.apply(e,t||[])).next())}))};const l=(()=>{const r=e(),s=e(),n=a(),c=a();let d=!0,u=t("Carrier"),h=t("Battleship"),m=t("Destroyer"),f=t("Submarine"),p=t("PatrolBoat");const g=[u,h,m,f,p],v=()=>{s.placeShip(u,"A","1","horizontal"),s.placeShip(h,"A","3","horizontal"),s.placeShip(m,"A","5","horizontal"),s.placeShip(f,"A","7","horizontal"),s.placeShip(p,"A","9","horizontal"),s.reserveSpace(s,"A","1"),s.reserveSpace(s,"A","3"),s.reserveSpace(s,"A","5"),s.reserveSpace(s,"A","7"),s.reserveSpace(s,"A","9")},S=()=>s.allSunk(s)?(o.removeBoardPointer(),o.pVcBtn.classList.contains("selected")&&o.setGameOverMessagePvC("player"),o.cVcBtn.classList.contains("selected")&&o.setGameOverMessageCvC("player"),!0):!!r.allSunk(r)&&(o.removeBoardPointer(),o.pVcBtn.classList.contains("selected")&&o.setGameOverMessagePvC("computer"),o.cVcBtn.classList.contains("selected")&&o.setGameOverMessageCvC("computer"),!0),w=e=>{let t;if(e===r?t=c:e===s&&(t=n),e.hitButNotSunk(e)){if(null!==t.getPrevHit()&&null!==t.getLastHit()&&e.getCell(t.getLastHit().col,t.getLastHit().row).takenBy.hitCount>=2&&e.getCell(t.getLastHit().col,t.getLastHit().row).takenBy.hitCount<=4){if(t.finishingAttack(e,t.getLastHit().col,t.getLastHit().row,t.getPrevHit()),e.sinkShip(e,t.getLastHit().col,t.getLastHit().row),S())return}else if(1===e.getCell(t.getLastHit().col,t.getLastHit().row).takenBy.hitCount&&(t.followupAttack(e,t.getLastHit().col,t.getLastHit().row),e.sinkShip(e,t.getLastHit().col,t.getLastHit().row),S()))return}else{const{col:a,row:r}=t.randomAttack(e);if("hit"===e.getCell(a,r).status&&(t.setPrevHit(t.getLastHit()),t.setLastHit({col:a,row:r})),"hit"===e.getCell(a,r).status&&e.getCell(a,r).takenBy.isSunk()&&(e.sinkShip(e,a,r),t.setPrevHit(null),t.setLastHit(null),S()))return}},y=(e,a)=>{a.clearBoard(),(e=>{let a;e===r?(u=t("Carrier"),h=t("Battleship"),m=t("Destroyer"),f=t("Submarine"),p=t("PatrolBoat"),a=[u,h,m,f,p]):e===s&&(a=[t("Carrier"),t("Battleship"),t("Destroyer"),t("Submarine"),t("PatrolBoat")]);l.humanShips.length=0;const o=["A","B","C","D","E","F","G","H","I","J"],i=()=>o[Math.floor(Math.random()*o.length)],n=()=>Math.ceil(10*Math.random()).toString(),c=()=>Math.random()>.5?"horizontal":"vertical";a.forEach((t=>{let a=i(),r=n(),s=c(),o=e.canBePlaced(t.size,a,r,s);for(;!o;)a=i(),r=n(),s=c(),o=e.canBePlaced(t.size,a,r,s);o&&(e.placeShip(t,a,r,s),e.reserveSpace(e,a,r)),l.humanShips.push(t)}))})(a),o.refreshBoard(a),"first"===e&&o.createShipOverlay("first",a.shipsPlaced)},B=()=>{o.cVcBtn.classList.contains("selected")&&(y("first",r),y("second",s),d=!1,i(void 0,void 0,void 0,(function*(){o.removeBoardPointer();let e=!0;for(;!S()&&!d;){if(o.waiting(!0),e){if(o.setTurnMessageCvC(e),yield new Promise((e=>setTimeout(e,o.getSpeedValue()))),!o.cVcBtn.classList.contains("selected")||d)break;w(r),o.refreshBoard(r),e=!1}if(S()||d)break;if(!e){if(o.setTurnMessageCvC(e),yield new Promise((e=>setTimeout(e,o.getSpeedValue()))),!o.cVcBtn.classList.contains("selected")||d)break;w(s),o.refreshBoard(s),e=!0}}d=!1,o.waiting(!1)})),o.refreshBoard(r))},C=()=>{d=!0,n.setPrevHit(null),n.setLastHit(null),c.setPrevHit(null),c.setLastHit(null),r.clearBoard(),s.clearBoard(),v(),o.refreshBoard(r),o.refreshBoard(s),o.createShipOverlay("second",s.shipsPlaced),o.dragAndDrop(r,s,g),o.canBeStarted(),B(),g.forEach((e=>{!0===e.isVertical&&(e.isVertical=!1)}))};return{init:()=>{o.setInitMessage(),o.renderBoard(r),o.renderBoard(s),v(),o.refreshBoard(s),o.createShipOverlay("second",s.shipsPlaced),o.dragAndDrop(r,s,g),o.canBeStarted(),B(),o.unFillCells("first"),o.pVcBtn.disabled=!0},humanGameboard:r,computerGameboard:s,restart:C,newGame:()=>i(void 0,void 0,void 0,(function*(){d=!0,yield new Promise((e=>setTimeout(e,o.getSpeedValue()))),d=!1,C()})),start:()=>{o.refreshBoard(r),y("second",s),d=!1,i(void 0,void 0,void 0,(function*(){let e=!0;for(;!S()&&!d;){if(e){o.setTurnMessagePvC(e),o.setBoardPointer("player"),o.waiting(!1);const{col:t,row:a}=yield o.handleUserInput();n.attack(s,t,a),s.sinkShip(s,t,a),o.refreshBoard(s),e=!1}if(S()||d)break;if(!e){if(o.setTurnMessagePvC(e),o.setBoardPointer("computer"),o.waiting(!0),yield new Promise((e=>setTimeout(e,o.getSpeedValue()))),!o.pVcBtn.classList.contains("selected")||d)break;w(r),o.refreshBoard(r),e=!0}}d=!1,o.waiting(!1)}))},randomizeShipsPlacement:y,humanShips:g}})(),n=l;n.init()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoibUJBQ0EsTUFxT0EsRUFyT3lCLEtBQ3JCLE1BQU1BLEVBQU8sQ0FBQyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxLQUNyREMsRUFBTyxDQUFDLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLE1BQ3JEQyxFQUFRLEdBQ1JDLEVBQWMsR0FrQmRDLEVBQVUsQ0FBQ0MsRUFBS0MsS0FDbEIsTUFBTUMsRUFBV1AsRUFBS1EsUUFBUUgsR0FDeEJJLEVBQVdSLEVBQUtPLFFBQVFGLEdBQzlCLE9BQWtCLElBQWRDLElBQWlDLElBQWRFLEVBQ1osS0FFSlAsRUFBTU8sR0FBVUYsRUFBUyxFQUU5QkcsRUFBVSxDQUFDTCxFQUFLQyxFQUFLSyxFQUFXQyxLQUNsQyxNQUFNTCxFQUFXUCxFQUFLUSxRQUFRSCxHQUN4QkksRUFBV1IsRUFBS08sUUFBUUYsR0FDOUIsT0FBa0IsSUFBZEMsSUFBaUMsSUFBZEUsRUFDWixNQUVYUCxFQUFNTyxHQUFVRixHQUFVTSxPQUFTRixFQUMvQkMsSUFDQVYsRUFBTU8sR0FBVUYsR0FBVU8sUUFBVUYsR0FFakNWLEVBQU1PLEdBQVVGLEdBQVMsRUEyS3BDLE1BOU1zQixNQUNsQixJQUFLLElBQUlRLEVBQUksRUFBR0EsRUFBSSxHQUFJQSxHQUFLLEVBQUcsQ0FDNUJiLEVBQU1hLEdBQUssR0FDWCxJQUFLLElBQUlDLEVBQUksRUFBR0EsRUFBSSxHQUFJQSxHQUFLLEVBQ3pCZCxFQUFNYSxHQUFHQyxHQUFLLENBQUVYLElBQUtMLEVBQUtnQixHQUFJVixJQUFLTCxFQUFLYyxHQUFJRixPQUFRLFFBQVNDLFFBQVMsS0FFOUUsR0F1TUpHLEdBQ08sQ0FDSEMsV0F2TWUsS0FDZixJQUFLLElBQUlILEVBQUksRUFBR0EsRUFBSSxHQUFJQSxHQUFLLEVBQ3pCLElBQUssSUFBSUMsRUFBSSxFQUFHQSxFQUFJLEdBQUlBLEdBQUssRUFDekJkLEVBQU1hLEdBQUdDLEdBQUdILE9BQVMsUUFDckJYLEVBQU1hLEdBQUdDLEdBQUdGLGFBQVVLLEVBRzlCaEIsRUFBWWlCLE9BQVMsQ0FBQyxFQWlNdEJoQixVQUNBTSxVQUNBVyxXQTdLZSxDQUFDQyxFQUFNQyxLQUNDQSxFQUFVckIsTUFBTXNCLE9BQ3hCQyxTQUFTQyxJQVVwQixJQUFJQyxFQVRnQixVQUFoQkQsRUFBS2IsUUFBc0JhLEVBQUtaLFFBQVFjLE9BQVNOLEVBQUtNLE9BQ3RERixFQUFLYixPQUFTLFFBQ2RhLEVBQUtaLFFBQVUsTUFFbkJYLEVBQVlzQixTQUFTSCxJQUNJLE9BQWpCQSxFQUFLUixTQUNMWCxFQUFZMEIsT0FBTzFCLEVBQVlLLFFBQVFjLEdBQU8sRUFDbEQsSUFHQUMsSUFBYyxFQUFXTyxlQUN6QkgsRUFBVSxhQUVMSixJQUFjLEVBQVdRLG9CQUM5QkosRUFBVSxlQUVBSyxTQUFTQyxpQkFBaUIsSUFBSU4sV0FDdENGLFNBQVNDLElBQ1BBLEVBQUtRLFVBQVVDLFNBQVMsVUFBWVQsRUFBS1UsYUFBYSxtQkFBcUJkLEVBQUtNLEtBQUtTLGdCQUNyRlgsRUFBS1EsVUFBVUksT0FBTyxTQUN0QlosRUFBS1EsVUFBVUssSUFBSSxTQUNuQmIsRUFBS2MsZ0JBQWdCLGlCQUN6QixHQUNGLEdBQ0osRUFtSkZDLFVBakpjLENBQUNuQixFQUFNakIsRUFBS0MsRUFBS29DLEtBRTNCcEIsRUFBS3FCLFdBRFcsZUFBaEJELEVBTUosTUFBTUUsRUFBK0IsZUFBaEJGLEVBQ2ZHLEVBQVFELEVBQWU1QyxFQUFPQyxFQUM5QjZDLEVBQVFELEVBQU1yQyxRQUFRb0MsRUFBZXZDLEVBQU1DLEdBQ2pELElBQUl5QyxFQUFZLEdBQ2hCLEdBQUlELEVBQVEsR0FBS0EsRUFBUXhCLEVBQUswQixLQUFPSCxFQUFNekIsT0FDdkMsT0FBTyxFQUVYLElBQUssSUFBSUwsRUFBSSxFQUFHQSxFQUFJTyxFQUFLMEIsS0FBTWpDLEdBQUssRUFBRyxDQUNuQyxNQUFNa0MsRUFBYUwsRUFBZUMsRUFBTUMsRUFBUS9CLEdBQUtWLEVBQy9DNkMsRUFBYU4sRUFBZXRDLEVBQU11QyxFQUFNQyxFQUFRL0IsR0FDdEQsR0FBK0MsVUFBM0NYLEVBQVE2QyxFQUFZQyxHQUFZckMsT0FDaEMsT0FBTyxFQUVYSCxFQUFRdUMsRUFBWUMsRUFBWSxRQUFTNUIsR0FDekN5QixFQUFVSSxLQUFLL0MsRUFBUTZDLEVBQVlDLEdBQ3ZDLENBRUEsT0FEQS9DLEVBQVlnRCxLQUFLSixFQUFVLEtBQ3BCLENBQUksRUEwSFhLLGNBekdrQixDQUFDL0MsRUFBS0MsS0FDeEIsTUFBTW9CLEVBQU90QixFQUFRQyxFQUFLQyxHQUMxQixNQUFvQixVQUFoQm9CLEVBQUtiLFFBQ0xhLEVBQUtaLFFBQVF1QyxNQUNiM0MsRUFBUUwsRUFBS0MsRUFBSyxPQUNYb0IsRUFBS2IsUUFFSSxVQUFoQmEsRUFBS2IsUUFBc0MsYUFBaEJhLEVBQUtiLFFBQ2hDSCxFQUFRTCxFQUFLQyxFQUFLLFFBQ1hvQixFQUFLYixRQUVULElBQUksRUErRlh5QyxjQTdGa0IsQ0FBQ2pELEVBQUtDLEtBQ3hCLE1BQU1vQixFQUFPdEIsRUFBUUMsRUFBS0MsR0FDMUIsTUFBb0IsVUFBaEJvQixFQUFLYixRQUNMSCxFQUFRTCxFQUFLQyxFQUFLLFlBQ1hvQixFQUFLYixRQUVULElBQUksRUF3RlgwQyxhQXRGaUIsQ0FBQ2hDLEVBQVdsQixFQUFLQyxLQUNsQyxNQUFNb0IsRUFBT0gsRUFBVW5CLFFBQVFDLEVBQUtDLEdBQ3BDLEdBQUlvQixHQUFRQSxFQUFLWixRQUFTLENBQ0pTLEVBQVVyQixNQUFNc0IsT0FBT2dDLFFBQVFDLEdBQU1BLEVBQUUzQyxTQUFXMkMsRUFBRTNDLFFBQVFjLE9BQVNGLEVBQUtaLFFBQVFjLE9BQzFGSCxTQUFTQyxJQUNJLENBQ2YsQ0FBRXJCLElBQUssRUFBR0MsS0FBTSxHQUNoQixDQUFFRCxJQUFLLEVBQUdDLElBQUssR0FDZixDQUFFRCxLQUFNLEVBQUdDLElBQUssR0FDaEIsQ0FBRUQsSUFBSyxFQUFHQyxJQUFLLEdBQ2YsQ0FBRUQsS0FBTSxFQUFHQyxLQUFNLEdBQ2pCLENBQUVELEtBQU0sRUFBR0MsSUFBSyxHQUNoQixDQUFFRCxJQUFLLEVBQUdDLEtBQU0sR0FDaEIsQ0FBRUQsSUFBSyxFQUFHQyxJQUFLLElBRVJtQixTQUFTaUMsSUFDaEIsTUFBTUMsRUFBU0MsT0FBT0MsYUFBYW5DLEVBQUtyQixJQUFJeUQsV0FBVyxHQUFLSixFQUFVckQsS0FDaEUwRCxHQUFVQyxPQUFPdEMsRUFBS3BCLEtBQU9vRCxFQUFVcEQsS0FBSzJELFdBQzlDMUMsRUFBVW5CLFFBQVF1RCxFQUFRSSxJQUMxQnhDLEVBQVUrQixjQUFjSyxFQUFRSSxFQUNwQyxHQUNGLEdBRVYsR0FnRUFHLGNBN0JtQjNDLEdBQ0lBLEVBQVVyQixNQUFNc0IsT0FDakIyQyxNQUFNekMsR0FDSixRQUFoQkEsRUFBS2IsU0FBOEMsSUFBMUJhLEVBQUtaLFFBQVFzRCxXQTJCOUNDLFNBdkRhLENBQUM5QyxFQUFXbEIsRUFBS0MsS0FDOUIsTUFBTW9CLEVBQU9ILEVBQVVuQixRQUFRQyxFQUFLQyxHQUNwQyxHQUFJb0IsR0FBUUEsRUFBS1osU0FBV1ksRUFBS1osUUFBUXNELFNBQVUsQ0FDN0I3QyxFQUFVckIsTUFBTXNCLE9BQU9nQyxRQUFRQyxHQUFNQSxFQUFFM0MsU0FBVzJDLEVBQUUzQyxRQUFRYyxPQUFTRixFQUFLWixRQUFRYyxPQUMxRkgsU0FBU0MsSUFDSSxDQUNmLENBQUVyQixJQUFLLEVBQUdDLEtBQU0sR0FDaEIsQ0FBRUQsSUFBSyxFQUFHQyxJQUFLLEdBQ2YsQ0FBRUQsS0FBTSxFQUFHQyxJQUFLLEdBQ2hCLENBQUVELElBQUssRUFBR0MsSUFBSyxHQUNmLENBQUVELEtBQU0sRUFBR0MsS0FBTSxHQUNqQixDQUFFRCxLQUFNLEVBQUdDLElBQUssR0FDaEIsQ0FBRUQsSUFBSyxFQUFHQyxLQUFNLEdBQ2hCLENBQUVELElBQUssRUFBR0MsSUFBSyxJQUVSbUIsU0FBU2lDLElBQ2hCLE1BQU1DLEVBQVNDLE9BQU9DLGFBQWFuQyxFQUFLckIsSUFBSXlELFdBQVcsR0FBS0osRUFBVXJELEtBQ2hFMEQsR0FBVUMsT0FBT3RDLEVBQUtwQixLQUFPb0QsRUFBVXBELEtBQUsyRCxXQUM5QzFDLEVBQVVuQixRQUFRdUQsRUFBUUksSUFDMUJ4QyxFQUFVNkIsY0FBY08sRUFBUUksRUFDcEMsR0FDRixHQUVWLEdBaUNBTyxRQXRCYS9DLElBRWIsSUFBSWdELEVBRG1CaEQsRUFBVXJCLE1BQU1zQixPQUNMZ0MsUUFBUTlCLEdBQVNBLEVBQUtaLFVBQ3hELFNBQUl5RCxFQUFhbkQsT0FBUyxHQUFLbUQsRUFBYUMsT0FBTzlDLEdBQVNBLEVBQUtaLFFBQVFzRCxXQUt6RSxFQWVBbEUsUUFDQXVFLFlBL0hnQixDQUFDekIsRUFBTTNDLEVBQUtDLEVBQUtvQyxLQUNqQyxNQUFNRSxFQUErQixlQUFoQkYsRUFDZkcsRUFBUUQsRUFBZTVDLEVBQU9DLEVBQzlCNkMsRUFBUUQsRUFBTXJDLFFBQVFvQyxFQUFldkMsRUFBTUMsR0FDakQsR0FBSXdDLEVBQVEsR0FBS0EsRUFBUUUsRUFBT0gsRUFBTXpCLE9BQ2xDLE9BQU8sRUFFWCxNQUFNc0QsRUFBVyxHQUNqQixJQUFLLElBQUkzRCxFQUFJLEVBQUdBLEVBQUlpQyxFQUFNakMsR0FBSyxFQUFHLENBQzlCLE1BQU1rQyxFQUFhTCxFQUFlQyxFQUFNQyxFQUFRL0IsR0FBS1YsRUFDL0M2QyxFQUFhTixFQUFldEMsRUFBTXVDLEVBQU1DLEVBQVEvQixHQUN0RDJELEVBQVN2QixLQUFnRCxVQUEzQy9DLEVBQVE2QyxFQUFZQyxHQUFZckMsT0FDbEQsQ0FDQSxPQUFPNkQsRUFBU0YsT0FBT0csSUFBa0IsSUFBVEEsR0FBYyxFQW1IOUN4RSxjQUNBeUUsb0JBcEV5QnJELElBQ0ZBLEVBQVVyQixNQUFNc0IsT0FDeEJDLFNBQVNDLElBQ0EsYUFBaEJBLEVBQUtiLFFBQ0xILEVBQVFnQixFQUFLckIsSUFBS3FCLEVBQUtwQixJQUFLLFFBQ2hDLEdBQ0YsRUErREwsRUNuTUwsRUFqQ3FCc0IsSUFDakIsSUFBSW9CLEVBZ0JKLE1BZmEsWUFBVHBCLElBQ0FvQixFQUFPLEdBRUUsZUFBVHBCLElBQ0FvQixFQUFPLEdBRUUsY0FBVHBCLElBQ0FvQixFQUFPLEdBRUUsY0FBVHBCLElBQ0FvQixFQUFPLEdBRUUsZUFBVHBCLElBQ0FvQixFQUFPLEdBRUosQ0FDSHBCLE9BQ0FvQixPQUNBNkIsU0FBVSxFQUNWbEMsWUFBWSxFQUNaLE1BQUFtQyxHQUNJQyxLQUFLcEMsWUFBY29DLEtBQUtwQyxVQUM1QixFQUNBLEdBQUFVLEdBQ0kwQixLQUFLRixVQUFZLENBQ3JCLEVBQ0EsTUFBQVQsR0FDSSxPQUFPVyxLQUFLRixXQUFhN0IsQ0FDN0IsRUFDSCxFQzJLTCxFQTFNc0IsS0FDbEIsTUFBTWhELEVBQU8sQ0FBQyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxLQUMzRCxJQUFJZ0YsRUFBVSxLQUNWQyxFQUFVLEtBb0VkLElBQUlDLEVBQVEsRUFDUkMsR0FBVSxFQUNWQyxHQUFTLEVBQ2IsTUFBTUMsRUFBa0IsQ0FBQzlELEVBQVdsQixFQUFLQyxFQUFLMEUsS0FHMUMsR0FBSUEsRUFBUTFFLE1BQVFBLEVBRWhCLEdBQUk2RSxFQUFTLENBQ1RELEVBQVEsRUFFUixJQUFJdkIsRUFBU0MsT0FBT0MsYUFBYXhELEVBQUl5RCxXQUFXLEdBQUtvQixHQUNyRCxLQUFPM0QsRUFBVW5CLFFBQVF1RCxFQUFRckQsSUFBa0QsUUFBMUNpQixFQUFVbkIsUUFBUXVELEVBQVFyRCxHQUFLTyxRQUNwRXFFLEdBQVMsRUFDVHZCLEVBQVNDLE9BQU9DLGFBQWF4RCxFQUFJeUQsV0FBVyxHQUFLb0IsR0FFakQzRCxFQUFVbkIsUUFBUXVELEVBQVFyRCxJQUFrRCxRQUExQ2lCLEVBQVVuQixRQUFRdUQsRUFBUXJELEdBQUtPLFFBQThELFNBQTFDVSxFQUFVbkIsUUFBUXVELEVBQVFyRCxHQUFLTyxRQUNwSFUsRUFBVTZCLGNBQWNPLEVBQVFyRCxHQUNjLFFBQTFDaUIsRUFBVW5CLFFBQVF1RCxFQUFRckQsR0FBS08sU0FDL0J5RSxFQUFXTCxHQUNYTSxFQUFXLENBQUVsRixJQUFLc0QsRUFBUXJELElBQUtBLEtBTW5DNEUsR0FBUyxJQUdUQSxFQUFRLEVBQ1JDLEdBQVUsRUFDVkUsRUFBZ0I5RCxFQUFXb0MsRUFBUXJELEVBQUswRSxHQUVoRCxLQUNLLENBQ0RFLEVBQVEsRUFFUixJQUFJdkIsRUFBU0MsT0FBT0MsYUFBYXhELEVBQUl5RCxXQUFXLEdBQUtvQixHQUNyRCxLQUFPM0QsRUFBVW5CLFFBQVF1RCxFQUFRckQsSUFBa0QsUUFBMUNpQixFQUFVbkIsUUFBUXVELEVBQVFyRCxHQUFLTyxRQUNwRXFFLEdBQVMsRUFDVHZCLEVBQVNDLE9BQU9DLGFBQWF4RCxFQUFJeUQsV0FBVyxHQUFLb0IsR0FFakQzRCxFQUFVbkIsUUFBUXVELEVBQVFyRCxJQUFrRCxRQUExQ2lCLEVBQVVuQixRQUFRdUQsRUFBUXJELEdBQUtPLFFBQThELFNBQTFDVSxFQUFVbkIsUUFBUXVELEVBQVFyRCxHQUFLTyxRQUNwSFUsRUFBVTZCLGNBQWNPLEVBQVFyRCxHQUNjLFFBQTFDaUIsRUFBVW5CLFFBQVF1RCxFQUFRckQsR0FBS08sU0FDL0J5RSxFQUFXTCxHQUNYTSxFQUFXLENBQUVsRixJQUFLc0QsRUFBUXJELElBQUtBLEtBTW5DNEUsR0FBUyxJQUdUQSxFQUFRLEVBQ1JDLEdBQVUsRUFDVkUsRUFBZ0I5RCxFQUFXb0MsRUFBUXJELEVBQUswRSxHQUVoRCxNQUVDLEdBQUlBLEVBQVEzRSxNQUFRQSxFQUVyQixHQUFJK0UsRUFBUSxDQUNSRixFQUFRLEVBRVIsSUFBSW5CLEdBQVVDLE9BQU8xRCxHQUFPNEUsR0FBT2pCLFdBQ25DLEtBQU8xQyxFQUFVbkIsUUFBUUMsRUFBSzBELElBQXFELFFBQTFDeEMsRUFBVW5CLFFBQVFDLEVBQUswRCxHQUFRbEQsUUFDcEVxRSxHQUFTLEVBQ1RuQixHQUFVQyxPQUFPMUQsR0FBTzRFLEdBQU9qQixXQUUvQjFDLEVBQVVuQixRQUFRQyxFQUFLMEQsSUFBcUQsUUFBMUN4QyxFQUFVbkIsUUFBUUMsRUFBSzBELEdBQVFsRCxRQUE4RCxTQUExQ1UsRUFBVW5CLFFBQVFDLEVBQUswRCxHQUFRbEQsUUFDcEhVLEVBQVU2QixjQUFjL0MsRUFBSzBELEdBQ2lCLFFBQTFDeEMsRUFBVW5CLFFBQVFDLEVBQUswRCxHQUFRbEQsU0FDL0J5RSxFQUFXTCxHQUNYTSxFQUFXLENBQUVsRixJQUFLQSxFQUFLQyxJQUFLeUQsS0FNaENtQixHQUFTLElBR1RBLEVBQVEsRUFDUkUsR0FBUyxFQUNUQyxFQUFnQjlELEVBQVdsQixFQUFLMEQsRUFBUWlCLEdBRWhELEtBQ0ssQ0FDREUsRUFBUSxFQUVSLElBQUluQixHQUFVQyxPQUFPMUQsR0FBTzRFLEdBQU9qQixXQUNuQyxLQUFPMUMsRUFBVW5CLFFBQVFDLEVBQUswRCxJQUFxRCxRQUExQ3hDLEVBQVVuQixRQUFRQyxFQUFLMEQsR0FBUWxELFFBQ3BFcUUsR0FBUyxFQUNUbkIsR0FBVUMsT0FBTzFELEdBQU80RSxHQUFPakIsV0FFL0IxQyxFQUFVbkIsUUFBUUMsRUFBSzBELElBQXFELFFBQTFDeEMsRUFBVW5CLFFBQVFDLEVBQUswRCxHQUFRbEQsUUFBOEQsU0FBMUNVLEVBQVVuQixRQUFRQyxFQUFLMEQsR0FBUWxELFFBQ3BIVSxFQUFVNkIsY0FBYy9DLEVBQUswRCxHQUNpQixRQUExQ3hDLEVBQVVuQixRQUFRQyxFQUFLMEQsR0FBUWxELFNBQy9CeUUsRUFBV0wsR0FDWE0sRUFBVyxDQUFFbEYsSUFBS0EsRUFBS0MsSUFBS3lELEtBTWhDbUIsR0FBUyxJQUdUQSxFQUFRLEVBQ1JFLEdBQVMsRUFDVEMsRUFBZ0I5RCxFQUFXbEIsRUFBSzBELEVBQVFpQixHQUVoRCxDQUNKLEVBUUVNLEVBQWNFLElBQ2hCUixFQUFVUSxDQUFVLEVBRWxCRCxFQUFjRSxJQUNoQlIsRUFBVVEsQ0FBVSxFQUV4QixNQUFPLENBQUVDLE9BcE1NLENBQUNuRSxFQUFXbEIsRUFBS0MsS0FDNUIsR0FBMkMsUUFBdkNpQixFQUFVbkIsUUFBUUMsRUFBS0MsR0FBS08sUUFBMkQsU0FBdkNVLEVBQVVuQixRQUFRQyxFQUFLQyxHQUFLTyxPQUFtQixDQUMvRixJQUFJOEUsRUFBU3BFLEVBQVU2QixjQUFjL0MsRUFBS0MsR0FLMUMsTUFKZSxRQUFYcUYsSUFDQUwsRUFBV0wsR0FDWE0sRUFBVyxDQUFFbEYsSUFBS0EsRUFBS0MsSUFBS0EsS0FFekJxRixDQUNYLENBQ0EsTUFBTyxjQUFjLEVBMkxSQyxhQXpMS3JFLElBQ2xCLElBQUlzRSxFQUNBQyxFQUNKLEdBQ0lELEVBQVk3RixFQUFLK0YsS0FBS0MsTUFBTUQsS0FBS0UsU0FBV2pHLEVBQUtvQixTQUNqRDBFLEVBQVlDLEtBQUtHLEtBQXFCLEdBQWhCSCxLQUFLRSxVQUFlaEMsaUJBQ2MsUUFBbkQxQyxFQUFVbkIsUUFBUXlGLEVBQVdDLEdBQVdqRixRQUF1RSxTQUFuRFUsRUFBVW5CLFFBQVF5RixFQUFXQyxHQUFXakYsUUFDN0csR0FBdUQsUUFBbkRVLEVBQVVuQixRQUFReUYsRUFBV0MsR0FBV2pGLFFBQXVFLFNBQW5EVSxFQUFVbkIsUUFBUXlGLEVBQVdDLEdBQVdqRixPQUFtQixDQUN2SCxNQUFNOEUsRUFBU3BFLEVBQVU2QixjQUFjeUMsRUFBV0MsR0FTbEQsTUFSdUQsUUFBbkR2RSxFQUFVbkIsUUFBUXlGLEVBQVdDLEdBQVdqRixTQUN4Q3lFLEVBQVdMLEdBQ1hNLEVBQVcsQ0FBRWxGLElBQUt3RixFQUFXdkYsSUFBS3dGLEtBTS9CLENBQUVILFNBQVF0RixJQUFLd0YsRUFBV3ZGLElBQUt3RixFQUMxQyxDQUNBLE1BQU8sQ0FBRUgsT0FBUSxlQUFnQnRGLElBQUt3RixFQUFXdkYsSUFBS3dGLEVBQVcsRUFzS3RDSyxlQXBLUixDQUFDNUUsRUFBV2xCLEVBQUtDLEtBQ3BDLE1BTU04RixFQU5hLENBQ2YsQ0FBRS9GLElBQUssRUFBR0MsS0FBTSxHQUNoQixDQUFFRCxJQUFLLEVBQUdDLElBQUssR0FDZixDQUFFRCxLQUFNLEVBQUdDLElBQUssR0FDaEIsQ0FBRUQsSUFBSyxFQUFHQyxJQUFLLElBRWdCa0QsUUFBUUUsSUFDdkMsTUFBTUMsRUFBU0MsT0FBT0MsYUFBYXhELEVBQUl5RCxXQUFXLEdBQUtKLEVBQVVyRCxLQUMzRDBELEdBQVVDLE9BQU8xRCxHQUFPb0QsRUFBVXBELEtBQUsyRCxXQUN2Q3ZDLEVBQU9ILEVBQVVuQixRQUFRdUQsRUFBUUksR0FDdkMsU0FBSXJDLEdBQXdCLFNBQWhCQSxFQUFLYixRQUFxQyxRQUFoQmEsRUFBS2IsT0FHL0IsSUFFaEIsR0FBSXVGLEVBQWdCaEYsT0FBUyxFQUFHLENBQzVCLE1BQU1pRixFQUFrQkQsRUFBZ0JMLEtBQUtDLE1BQU1ELEtBQUtFLFNBQVdHLEVBQWdCaEYsU0FDN0V1QyxFQUFTQyxPQUFPQyxhQUFheEQsRUFBSXlELFdBQVcsR0FBS3VDLEVBQWdCaEcsS0FDakUwRCxHQUFVQyxPQUFPMUQsR0FBTytGLEVBQWdCL0YsS0FBSzJELFdBQ25EMUMsRUFBVTZCLGNBQWNPLEVBQVFJLEdBQ2hDbUIsRUFBUSxFQUN5QyxRQUE3QzNELEVBQVVuQixRQUFRdUQsRUFBUUksR0FBUWxELFNBQ2xDeUUsRUFBV0wsR0FDWE0sRUFBVyxDQUFFbEYsSUFBS3NELEVBQVFyRCxJQUFLeUQsSUFNdkMsQ0FHQSxFQW1JMkNzQixrQkFBaUJMLFVBQVNDLFVBQVNxQixXQVovRCxJQUNSdEIsRUFXbUZ1QixXQVQzRSxJQUNSdEIsRUFRK0ZLLGFBQVlDLGFBQVksRUN4TXRJLElBQUlpQixFQUF3QyxTQUFVQyxFQUFTQyxFQUFZQyxFQUFHQyxHQUUxRSxPQUFPLElBQUtELElBQU1BLEVBQUlFLFdBQVUsU0FBVUMsRUFBU0MsR0FDL0MsU0FBU0MsRUFBVUMsR0FBUyxJQUFNQyxFQUFLTixFQUFVTyxLQUFLRixHQUFTLENBQUUsTUFBT0csR0FBS0wsRUFBT0ssRUFBSSxDQUFFLENBQzFGLFNBQVNDLEVBQVNKLEdBQVMsSUFBTUMsRUFBS04sRUFBaUIsTUFBRUssR0FBUyxDQUFFLE1BQU9HLEdBQUtMLEVBQU9LLEVBQUksQ0FBRSxDQUM3RixTQUFTRixFQUFLdkIsR0FKbEIsSUFBZXNCLEVBSWF0QixFQUFPMkIsS0FBT1IsRUFBUW5CLEVBQU9zQixRQUoxQ0EsRUFJeUR0QixFQUFPc0IsTUFKaERBLGFBQWlCTixFQUFJTSxFQUFRLElBQUlOLEdBQUUsU0FBVUcsR0FBV0EsRUFBUUcsRUFBUSxLQUlqQk0sS0FBS1AsRUFBV0ssRUFBVyxDQUM3R0gsR0FBTU4sRUFBWUEsRUFBVVksTUFBTWYsRUFBU0MsR0FBYyxLQUFLUyxPQUNsRSxHQUNKLEVBRUEsTUFBTU0sRUFBSyxNQUNQLE1BQU1DLEVBQVkxRixTQUFTMkYsY0FBYyxpQkFDbkNDLEVBQVM1RixTQUFTMkYsY0FBYyxXQUNoQ0UsRUFBUzdGLFNBQVMyRixjQUFjLHFCQUNoQ0csRUFBYTlGLFNBQVMyRixjQUFjLFlBQ3BDSSxFQUFTL0YsU0FBUzJGLGNBQWMsdUJBQ2hDSyxFQUFXaEcsU0FBUzJGLGNBQWMsVUFDbENNLEVBQVlqRyxTQUFTMkYsY0FBYyxvQkFDbkNPLEVBQVUsQ0FBQ0wsRUFBUUMsRUFBWUMsRUFBUUMsRUFBVUMsR0FDakRFLEVBQVNuRyxTQUFTb0csa0JBQWtCLFNBWXBDQyxFQUFjLENBQUM5RyxFQUFXK0csS0FDNUIvRyxFQUFVckIsTUFBTXVCLFNBQVNuQixJQUNyQkEsRUFBSW1CLFNBQVNwQixJQUNULE1BQU1xQixFQWRDLENBQUNBLElBQ2hCLE1BQU02RyxFQUFVdkcsU0FBU3dHLGNBQWMsT0FRdkMsT0FQQUQsRUFBUXJHLFVBQVVLLElBQUksUUFDdEJnRyxFQUFRckcsVUFBVUssSUFBSWIsRUFBS2IsUUFDM0IwSCxFQUFRRSxhQUFhLFdBQVkvRyxFQUFLckIsS0FDdENrSSxFQUFRRSxhQUFhLFdBQVkvRyxFQUFLcEIsS0FDbENvQixFQUFLWixTQUNMeUgsRUFBUUUsYUFBYSxnQkFBaUIvRyxFQUFLWixRQUFRYyxLQUFLUyxlQUVyRGtHLENBQU8sRUFLT0csQ0FBV3JJLEdBQ3hCaUksRUFBTUssT0FBT2pILEVBQUssR0FDcEIsR0FDSixFQWNBa0gsRUFBZ0JySCxJQUNsQixJQUFJSSxFQUNBSixJQUFjLEVBQVdPLGVBQ3pCSCxFQUFVLGFBRUxKLElBQWMsRUFBV1Esb0JBQzlCSixFQUFVLGVBRWQsTUFBTTJHLEVBQVF0RyxTQUFTMkYsY0FBYyxJQUFJaEcsS0FDekMyRyxFQUFNTyxVQUFZLEdBQ2xCUixFQUFZOUcsRUFBVytHLEVBQU0sRUFFM0JRLEVBQWdCMUIsSUFDbEIsSUFBS0EsRUFBRTJCLE9BQU83RyxVQUFVQyxTQUFTLFNBQVdpRixFQUFFMkIsT0FBTzdHLFVBQVVDLFNBQVMsUUFBUyxDQUc3RSxNQUFPLENBQUU5QixJQUZHK0csRUFBRTJCLE9BQU8zRyxhQUFhLFlBRXBCOUIsSUFERjhHLEVBQUUyQixPQUFPM0csYUFBYSxZQUV0QyxHQW9ERTRHLEVBQWlCLENBQUNDLEVBQWlCQyxLQUNyQ0EsRUFBa0JoSCxVQUFVSSxPQUFPLFlBQzlCMkcsRUFBZ0IvRyxVQUFVQyxTQUFTLGNBQ3BDOEcsRUFBZ0IvRyxVQUFVSyxJQUFJLFlBQzFCMEcsSUFBb0JwQixHQXBDUnJCLE9BQVUsT0FBUSxPQUFRLEdBQVEsWUFDdEQyQyxFQUFVLFNBQ1ZDLEdBQVEsR0FDUmxCLEVBQVF6RyxTQUFTNEgsR0FBU0EsRUFBSUMsVUFBVyxVQUNuQyxJQUFJekMsU0FBU0MsR0FBWXlDLFdBQVd6QyxFQUFTMEMsT0FDbkR0QixFQUFRekcsU0FBUzRILEdBQVNBLEVBQUlDLFVBQVcsSUFDekNGLEdBQVEsR0FDUkssSUFDQUMsR0FDSixJQThCWVQsSUFBb0JsQixHQWpCUnZCLE9BQVUsT0FBUSxPQUFRLEdBQVEsWUFDdEQ0QyxHQUFRLEdBQ1JsQixFQUFRekcsU0FBUzRILEdBQVNBLEVBQUlDLFVBQVcsVUFDbkMsSUFBSXpDLFNBQVNDLEdBQVl5QyxXQUFXekMsRUFBUzBDLE9BQ25EdEIsRUFBUXpHLFNBQVM0SCxHQUFTQSxFQUFJQyxVQUFXLElBQ3pDRixHQUFRLEdBQ1JwQixFQUFTc0IsVUFBVyxFQUNwQnJCLEVBQVVxQixVQUFXLEVBQ3JCdkIsRUFBT3VCLFVBQVcsQ0FDdEIsSUFXUSxFQUFXSyxVQUNYQyxJQUNKLEVBRUVSLEVBQVdTLElBQ2I3SCxTQUFTOEgsZ0JBQWdCNUgsVUFBVTZILE9BQU8sT0FBUUYsRUFBSyxFQWVyREcsRUFBb0IsQ0FBQ0MsRUFBZUMsS0FDdENBLEVBQU16SSxTQUFTMEksSUFDWCxNQUFNQyxFQUFjcEksU0FBU3dHLGNBQWMsT0FDckM2QixFQUFXRixFQUFVckosUUFBUWMsS0FBS1MsY0FDbENpSSxFQUFXSCxFQUFVckosUUFBUWtDLEtBQzdCTCxFQUFhd0gsRUFBVXJKLFFBQVE2QixXQUNyQ3lILEVBQVlsSSxVQUFVSyxJQUFJLE9BQVE4SCxHQUNsQ0QsRUFBWTNCLGFBQWEsWUFBYSxHQUFHNkIsS0FDekNGLEVBQVkzQixhQUFhLFlBQWEsR0FBRzRCLEtBQ3pDRCxFQUFZM0IsYUFBYSxZQUFhLFFBQ3RDMkIsRUFBWWxJLFVBQVVLLElBQUksYUFDMUIsTUFBTWdJLEVBQWUsS0FDakIsTUFBTUMsRUFBY3hJLFNBQVMyRixjQUFjLFFBQ3JDOEMsRUFBZUMsV0FBV0MsT0FBT0MsaUJBQWlCSixFQUFhLE1BQU1LLGlCQUFpQixjQUN2RmxJLEVBSUlBLElBQ0x5SCxFQUFZVSxNQUFNQyxNQUFRQyxFQUFXUCxFQUFlLE1BQ3BETCxFQUFZVSxNQUFNRyxPQUFTWCxHQUFZVSxFQUFXUCxHQUFnQixRQUxsRUwsRUFBWVUsTUFBTUMsTUFBUVQsR0FBWVUsRUFBV1AsR0FBZ0IsTUFDakVMLEVBQVlVLE1BQU1HLE9BQVNELEVBQVdQLEVBQWUsTUFLekQsRUFFSixJQU1JbkMsRUFOQTBDLEVBQVdoSixTQUFTMkYsY0FBYyxnQkFBZ0J1RCx3QkFBd0JILE1BQzlFUixJQUNBSSxPQUFPUSxpQkFBaUIsVUFBVSxXQUM5QkgsRUFBV2hKLFNBQVMyRixjQUFjLGdCQUFnQnVELHdCQUF3QkgsTUFDMUVSLEdBQ0osSUFFc0IsVUFBbEJOLEVBQ0EzQixFQUFRLGFBRWUsV0FBbEIyQixJQUNMM0IsRUFBUSxlQUVhdEcsU0FBUzJGLGNBQWMsSUFBSVcscUJBQXlCNkIsRUFBVTlKLG1CQUFtQjhKLEVBQVU3SixTQUNuRzhLLFlBQVloQixFQUFZLEdBQzNDLEVBRUFYLEVBQWUsSUFDb0MsSUFBakQsRUFBVzNILGVBQWUzQixZQUFZaUIsUUFBb0UsSUFBcEQsRUFBV1csa0JBQWtCNUIsWUFBWWlCLFFBQy9GK0gsRUFBVSxVQUNWbkIsRUFBU3NCLFVBQVcsR0FDYixJQUdQdEIsRUFBU3NCLFVBQVcsR0FDYixHQUdUSSxFQUFpQixLQUNuQmhDLEVBQVUyRCxZQUFjLG1EQUNwQlYsT0FBT1csV0FBVyx1QkFBdUJDLFVBQ3pDN0QsRUFBVTJELFlBQWMsNEhBQzVCLEVBRUVHLEVBQWtCLEtBQ2hCL0IsTUFDQS9CLEVBQVUyRCxZQUFjLDJDQUM1QixFQWtDRXpCLEVBQW9CLEtBQ3RCbEMsRUFBVTJELFlBQWMsZUFBZSxFQUVyQ0ksRUFBYyxDQUFDQyxFQUFnQkMsRUFBaUJ6QixLQUNsRCxJQUFJRyxFQUNBQyxFQUdBc0IsRUFDQWxKLEVBSEFtSixFQUFhLEVBQ2JDLEVBQWEsRUFHYkMsRUFBbUIsR0FDdkIsTUFBTUMsRUFBZ0IsQ0FDbEJDLFFBQVMvQixFQUFNLEdBQ2ZnQyxXQUFZaEMsRUFBTSxHQUNsQmlDLFVBQVdqQyxFQUFNLEdBQ2pCa0MsVUFBV2xDLEVBQU0sR0FDakJtQyxXQUFZbkMsRUFBTSxJQUVoQm9DLEVBQW9CdEssU0FBUzJGLGNBQWMsZUFDM0M0RSxFQUFxQnZLLFNBQVMyRixjQUFjLGdCQUM1QzZFLEVBQWtCRixFQUFrQnJLLGlCQUFpQixTQUNyRHdLLEVBQW1CRixFQUFtQnRLLGlCQUFpQixTQUN2RHlLLEVBQWUsR0FDckIsSUFBSyxJQUFJaEwsS0FBUThLLEVBQ1I5SyxFQUFLUSxVQUFVQyxTQUFTLFVBQ3pCdUssRUFBYXZKLEtBQUt6QixHQUcxQixJQUFLLElBQUlBLEtBQVErSyxFQUNSL0ssRUFBS1EsVUFBVUMsU0FBUyxVQUN6QnVLLEVBQWF2SixLQUFLekIsR0FHUE0sU0FBU0MsaUJBQWlCLGNBQ2xDUixTQUFTa0wsSUFDaEJBLEVBQVV4QixpQkFBaUIsWUFBYXlCLEdBQ3hDRCxFQUFVeEIsaUJBQWlCLFVBQVcwQixHQUN0Q0YsRUFBVXhCLGlCQUFpQixZQUFhMkIsR0FDeENILEVBQVV4QixpQkFBaUIsVUFBVzRCLEdBQ3RDSixFQUFVeEIsaUJBQWlCLGNBQWU2QixHQUMxQ04sRUFBYWpMLFNBQVNDLElBQ2xCQSxFQUFLeUosaUJBQWlCLGNBQWU4QixFQUFnQixHQUN2RCxJQUVOLElBQUlDLEVBQWMsS0FDbEIsU0FBU04sRUFBZ0J4RixHQUNyQnNFLEVBQWU5RyxvQkFBb0I4RyxHQUNuQ0MsRUFBZ0IvRyxvQkFBb0IrRyxHQUNwQyxNQUFNd0IsRUFBaUIvRixFQUFFMkIsT0FBTzNHLGFBQWEsYUFDN0MsSUFBSWdMLEVBQTBCMUIsRUFBZXZMLFlBQVlxRCxRQUFRbEMsR0FDdEQ2TCxJQUFtQjdMLEVBQUtSLFFBQVFjLEtBQUtTLGdCQUU1Q2dMLEVBQXlCMUIsRUFBZ0J4TCxZQUFZcUQsUUFBUWxDLEdBQ3RENkwsSUFBbUI3TCxFQUFLUixRQUFRYyxLQUFLUyxnQkFFaEQrSyxFQUF3QjNMLFNBQVNILElBQzdCb0ssRUFBZW5JLGFBQWFtSSxFQUFnQnBLLEVBQUtqQixJQUFLaUIsRUFBS2hCLElBQUksSUFFbkUrTSxFQUF1QjVMLFNBQVNILElBQzVCcUssRUFBZ0JwSSxhQUFhb0ksRUFBaUJySyxFQUFLakIsSUFBS2lCLEVBQUtoQixJQUFJLElBRXJFc0ksRUFBYThDLEdBQ2I5QyxFQUFhK0MsR0FDYjNCLEVBQWtCLFFBQVMwQixFQUFldkwsYUFDMUM2SixFQUFrQixTQUFVMkIsRUFBZ0J4TCxhQUM1Q3NMLEVBQVlDLEVBQWdCQyxFQUFpQixFQUFXMkIsV0FDNUQsQ0FDQSxTQUFTVCxJQUNMbkIsRUFBZXZMLFlBQVlzQixTQUFTSCxJQUNoQ29LLEVBQWVuSSxhQUFhbUksRUFBZ0JwSyxFQUFLakIsSUFBS2lCLEVBQUtoQixJQUFJLElBRW5FcUwsRUFBZ0J4TCxZQUFZc0IsU0FBU0gsSUFDakNxSyxFQUFnQnBJLGFBQWFvSSxFQUFpQnJLLEVBQUtqQixJQUFLaUIsRUFBS2hCLElBQUksSUFFckVzSSxFQUFhOEMsR0FDYjlDLEVBQWErQyxHQUNiM0IsRUFBa0IsUUFBUzBCLEVBQWV2TCxhQUMxQzZKLEVBQWtCLFNBQVUyQixFQUFnQnhMLGFBQzVDc0wsRUFBWUMsRUFBZ0JDLEVBQWlCLEVBQVcyQixXQUM1RCxDQUNBLFNBQVNSLEVBQWdCMUYsR0FDckIsT0FBT1osRUFBVXpCLFVBQU0sT0FBUSxHQUFRLGtCQUM3QixJQUFJOEIsU0FBU0MsR0FBWXlDLFdBQVd6QyxFQUFTLEtBQ25ELE1BQU1pQyxFQUFTM0IsRUFBRTJCLE9BQ2pCQSxFQUFPK0IsTUFBTXlDLFdBQWEsU0FDMUJ4SSxLQUFLN0MsVUFBVUssSUFBSSxZQUNuQjhILEVBQVd0QixFQUFPM0csYUFBYSxhQUMvQmtJLEVBQVd0RyxPQUFPK0UsRUFBTzNHLGFBQWEsY0FDdEN5SixFQUFhekUsRUFBRW9HLFFBQ2YxQixFQUFhMUUsRUFBRXFHLFFBQ2Y3QixFQUFVSSxFQUFjM0IsR0FDeEIzSCxFQUFja0osRUFBUWpKLFdBQWEsV0FBYSxhQUNaLGVBQWhDb0csRUFBTzJFLFFBQVEsVUFBVUMsSUFDekJqQyxFQUFlckssV0FBV3VLLEVBQVNGLEdBRUgsZ0JBQWhDM0MsRUFBTzJFLFFBQVEsVUFBVUMsSUFDekJoQyxFQUFnQnRLLFdBQVd1SyxFQUFTRCxFQUU1QyxHQUNKLENBQ0EsU0FBU2lDLEVBQWVDLEdBQ3BCLE9BQU8sU0FBVXpHLEdBQ2IsTUFBTTJCLEVBQVMzQixFQUFFMkIsT0FDakIsR0FBb0MsZUFBaENBLEVBQU8yRSxRQUFRLFVBQVVDLEtBQ3pCdkcsRUFBRTBHLGlCQUNFbEMsR0FBUyxDQUNULElBQUltQyxFQUFZRixHQUFTakMsRUFBUWpKLFdBQTBELEdBQTdDb0QsS0FBS0MsTUFBTThGLEVBQWEvRyxLQUFLaUosY0FBcUJqSSxLQUFLQyxNQUFNNkYsRUFBYTlHLEtBQUtrSixjQUM3SCxNQUFNQyxFQUFjLEdBQ3BCLElBQUssSUFBSW5OLEVBQUksRUFBR0EsRUFBSXVKLEVBQVV2SixJQUFLLENBQy9CLElBQUlvTixFQUFZdkMsRUFBUWpKLFdBQWFvTCxFQUFnQixHQUFKaE4sRUFBU2dOLEVBQVloTixFQUNsRXlMLEVBQWdCMkIsS0FDaEJELEVBQVkvSyxLQUFLcUosRUFBZ0IyQixJQUNqQ3BDLEVBQWlCNUksS0FBS3FKLEVBQWdCMkIsSUFFOUMsQ0FDSUMsRUFBaUJGLEtBQ2pCQSxFQUFZek0sU0FBU0MsSUFDakJBLEVBQUtRLFVBQVVLLElBQUksWUFBWSxJQUU5QjJLLElBQ0RBLEVBQWNtQixFQUF3QnRDLEVBQWtCekIsSUFNcEUsQ0FFSixHQUFvQyxnQkFBaEN2QixFQUFPMkUsUUFBUSxVQUFVQyxLQUN6QnZHLEVBQUUwRyxpQkFDRWxDLEdBQVMsQ0FDVCxJQUFJbUMsRUFBWUYsR0FBU2pDLEVBQVFqSixXQUEwRCxHQUE3Q29ELEtBQUtDLE1BQU04RixFQUFhL0csS0FBS2lKLGNBQXFCakksS0FBS0MsTUFBTTZGLEVBQWE5RyxLQUFLa0osY0FDN0gsTUFBTUMsRUFBYyxHQUNwQixJQUFLLElBQUluTixFQUFJLEVBQUdBLEVBQUl1SixFQUFVdkosSUFBSyxDQUMvQixJQUFJb04sRUFBWXZDLEVBQVFqSixXQUFhb0wsRUFBZ0IsR0FBSmhOLEVBQVNnTixFQUFZaE4sRUFDbEUwTCxFQUFpQjBCLEtBQ2pCRCxFQUFZL0ssS0FBS3NKLEVBQWlCMEIsSUFDbENwQyxFQUFpQjVJLEtBQUtzSixFQUFpQjBCLElBRS9DLENBQ0lDLEVBQWlCRixLQUNqQkEsRUFBWXpNLFNBQVNDLElBQ2pCQSxFQUFLUSxVQUFVSyxJQUFJLFlBQVksSUFFOUIySyxJQUNEQSxFQUFjbUIsRUFBd0J0QyxFQUFrQnpCLElBTXBFLENBRVIsQ0FDSixDQUNBLFNBQVNnRSxJQUNMdkMsRUFBaUJ0SyxTQUFTOE0sSUFDdEJBLEVBQWdCck0sVUFBVUksT0FBTyxZQUFZLElBRWpEeUosRUFBbUIsRUFDdkIsQ0FDQSxTQUFTeUMsRUFBV3BILEdBQ2hCMkUsRUFBaUJ0SyxTQUFTOE0sSUFDdEJBLEVBQWdCck0sVUFBVUksT0FBTyxZQUFZLElBRWpELE1BQU1tTSxFQUFPSixFQUF3QnRDLEVBQWtCekIsR0FDakR2QixFQUFTM0IsRUFBRTJCLE9BQ21CLGVBQWhDQSxFQUFPMkUsUUFBUSxVQUFVQyxJQUNyQi9CLEdBQTJCLE9BQWhCc0IsSUFDUHhCLEVBQWVqSCxZQUFZbUgsRUFBUTVJLEtBQU15TCxFQUFLLEdBQUdDLFFBQVFyTyxJQUFLb08sRUFBSyxHQUFHQyxRQUFRcE8sSUFBS29DLElBQ25GZ0osRUFBZWpKLFVBQVVtSixFQUFTNkMsRUFBSyxHQUFHQyxRQUFRck8sSUFBS29PLEVBQUssR0FBR0MsUUFBUXBPLElBQUtvQyxHQUM1RWdKLEVBQWVuSSxhQUFhbUksRUFBZ0IrQyxFQUFLLEdBQUdDLFFBQVFyTyxJQUFLb08sRUFBSyxHQUFHQyxRQUFRcE8sT0FHakZvTCxFQUFlakosVUFBVW1KLEVBQVNzQixFQUFZLEdBQUd3QixRQUFRck8sSUFBSzZNLEVBQVksR0FBR3dCLFFBQVFwTyxJQUFLb0MsR0FDMUZnSixFQUFlbkksYUFBYW1JLEVBQWdCd0IsRUFBWSxHQUFHd0IsUUFBUXJPLElBQUs2TSxFQUFZLEdBQUd3QixRQUFRcE8sT0FJdkUsZ0JBQWhDeUksRUFBTzJFLFFBQVEsVUFBVUMsSUFDckIvQixHQUEyQixPQUFoQnNCLElBQ1B2QixFQUFnQmxILFlBQVltSCxFQUFRNUksS0FBTXlMLEVBQUssR0FBR0MsUUFBUXJPLElBQUtvTyxFQUFLLEdBQUdDLFFBQVFwTyxJQUFLb0MsSUFDcEZpSixFQUFnQmxKLFVBQVVtSixFQUFTNkMsRUFBSyxHQUFHQyxRQUFRck8sSUFBS29PLEVBQUssR0FBR0MsUUFBUXBPLElBQUtvQyxHQUM3RWlKLEVBQWdCcEksYUFBYW9JLEVBQWlCOEMsRUFBSyxHQUFHQyxRQUFRck8sSUFBS29PLEVBQUssR0FBR0MsUUFBUXBPLE9BR25GcUwsRUFBZ0JsSixVQUFVbUosRUFBU3NCLEVBQVksR0FBR3dCLFFBQVFyTyxJQUFLNk0sRUFBWSxHQUFHd0IsUUFBUXBPLElBQUtvQyxHQUMzRmlKLEVBQWdCcEksYUFBYW9JLEVBQWlCdUIsRUFBWSxHQUFHd0IsUUFBUXJPLElBQUs2TSxFQUFZLEdBQUd3QixRQUFRcE8sT0FJN0dvTCxFQUFlOUcsb0JBQW9COEcsR0FDbkNDLEVBQWdCL0csb0JBQW9CK0csR0FDcENELEVBQWV2TCxZQUFZc0IsU0FBU0gsSUFDaENvSyxFQUFlbkksYUFBYW1JLEVBQWdCcEssRUFBS2pCLElBQUtpQixFQUFLaEIsSUFBSSxJQUVuRXFMLEVBQWdCeEwsWUFBWXNCLFNBQVNILElBQ2pDcUssRUFBZ0JwSSxhQUFhb0ksRUFBaUJySyxFQUFLakIsSUFBS2lCLEVBQUtoQixJQUFJLElBRXJFc0ksRUFBYThDLEdBQ2I5QyxFQUFhK0MsR0FDYjNCLEVBQWtCLFFBQVMwQixFQUFldkwsYUFDMUM2SixFQUFrQixTQUFVMkIsRUFBZ0J4TCxhQUM1Q3NMLEVBQVlDLEVBQWdCQyxFQUFpQixFQUFXMkIsWUFDeEQ3RCxJQUNBK0IsSUFDQTBCLEVBQWMsSUFDbEIsQ0FDQSxTQUFTSCxFQUFjM0YsR0FDbkIsTUFBTTJCLEVBQVMzQixFQUFFMkIsT0FDakJBLEVBQU8rQixNQUFNeUMsV0FBYSxVQUMxQnhJLEtBQUs3QyxVQUFVSSxPQUFPLFlBQ1UsSUFBNUJ5SixFQUFpQjNLLFNBQ21CLGVBQWhDMkgsRUFBTzJFLFFBQVEsVUFBVUMsR0FDckJULEdBQWV4QixFQUFlakgsWUFBWW1ILEVBQVE1SSxLQUFNa0ssRUFBWSxHQUFHd0IsUUFBUXJPLElBQUs2TSxFQUFZLEdBQUd3QixRQUFRcE8sSUFBS29DLEtBQ2hIZ0osRUFBZWpKLFVBQVVtSixFQUFTc0IsRUFBWSxHQUFHd0IsUUFBUXJPLElBQUs2TSxFQUFZLEdBQUd3QixRQUFRcE8sSUFBS29DLEdBQzFGZ0osRUFBZW5JLGFBQWFtSSxFQUFnQndCLEVBQVksR0FBR3dCLFFBQVFyTyxJQUFLNk0sRUFBWSxHQUFHd0IsUUFBUXBPLEtBQy9Gc0ksRUFBYThDLEdBQ2I5QyxFQUFhK0MsR0FDYjNCLEVBQWtCLFFBQVMwQixFQUFldkwsYUFDMUM2SixFQUFrQixTQUFVMkIsRUFBZ0J4TCxhQUM1Q3NMLEVBQVlDLEVBQWdCQyxFQUFpQixFQUFXMkIsYUFHdkIsZ0JBQWhDdkUsRUFBTzJFLFFBQVEsVUFBVUMsSUFDMUJULEdBQWV2QixFQUFnQmxILFlBQVltSCxFQUFRNUksS0FBTWtLLEVBQVksR0FBR3dCLFFBQVFyTyxJQUFLNk0sRUFBWSxHQUFHd0IsUUFBUXBPLElBQUtvQyxLQUNqSGlKLEVBQWdCbEosVUFBVW1KLEVBQVNzQixFQUFZLEdBQUd3QixRQUFRck8sSUFBSzZNLEVBQVksR0FBR3dCLFFBQVFwTyxJQUFLb0MsR0FDM0ZpSixFQUFnQnBJLGFBQWFvSSxFQUFpQnVCLEVBQVksR0FBR3dCLFFBQVFyTyxJQUFLNk0sRUFBWSxHQUFHd0IsUUFBUXBPLEtBQ2pHc0ksRUFBYThDLEdBQ2I5QyxFQUFhK0MsR0FDYjNCLEVBQWtCLFFBQVMwQixFQUFldkwsYUFDMUM2SixFQUFrQixTQUFVMkIsRUFBZ0J4TCxhQUM1Q3NMLEVBQVlDLEVBQWdCQyxFQUFpQixFQUFXMkIsYUFJeEUsQ0FDQSxTQUFTYyxFQUFpQkYsR0FDdEIsT0FBUUEsRUFBWTFKLE9BQU85QyxHQUFTQSxFQUFLUSxVQUFVQyxTQUFTLGFBQ3ZEK0wsRUFBWTFKLE9BQU85QyxHQUFTQSxFQUFLZ04sUUFBUXJPLE1BQVE2TixFQUFZLEdBQUdRLFFBQVFyTyxPQUNyRTZOLEVBQVkxSixPQUFPOUMsR0FBU0EsRUFBS2dOLFFBQVFwTyxNQUFRNE4sRUFBWSxHQUFHUSxRQUFRcE8sUUFDNUU0TixFQUFZOU0sU0FBV2tKLEdBQ3ZCNEQsRUFBWTFKLE9BQU85QyxHQUFTQSxFQUFLZ04sUUFBUXJPLEtBQU8sS0FBT3FCLEVBQUtnTixRQUFRck8sS0FBTyxPQUMzRTZOLEVBQVkxSixPQUFPOUMsR0FBU3NDLE9BQU90QyxFQUFLZ04sUUFBUXBPLE1BQVEsR0FBSzBELE9BQU90QyxFQUFLZ04sUUFBUXBPLE1BQVEsSUFDakcsQ0FDQSxTQUFTK04sRUFBd0J0QyxFQUFrQnpCLEdBQy9DLE9BQU95QixFQUFpQjRDLE1BQU01SSxLQUFLNkksSUFBSTdDLEVBQWlCM0ssT0FBU2tKLEVBQVUsR0FDL0UsQ0FXQSxTQUFTMEMsRUFBYTVGLEdBQ2xCQSxFQUFFMEcsaUJBQ0YsTUFBTS9FLEVBQVMzQixFQUFFMkIsT0FDakIsSUFBSXhILEVBQ2dDLGVBQWhDd0gsRUFBTzJFLFFBQVEsVUFBVUMsS0FDekJwTSxFQUFZbUssR0FFb0IsZ0JBQWhDM0MsRUFBTzJFLFFBQVEsVUFBVUMsS0FDekJwTSxFQUFZb0ssR0FFaEJ0QixFQUFXdEIsRUFBTzNHLGFBQWEsYUFDL0JrSSxFQUFXdEcsT0FBTytFLEVBQU8zRyxhQUFhLGNBQ3RDd0osRUFBVUksRUFBYzNCLEdBQ3hCLE1BQU13RSxFQUFXakQsRUFDWGtELEVBQVV2TixFQUFVcEIsWUFBWXFELFFBQVFsQyxHQUFTQSxFQUFLUixRQUFRYyxLQUFLUyxnQkFBa0JnSSxJQUMzRjlJLEVBQVVGLFdBQVd1SyxFQUFTckssR0FDOUJBLEVBQVVxRCxvQkFBb0JyRCxHQUM5QkEsRUFBVXBCLFlBQVlzQixTQUFTSCxJQUMzQkMsRUFBVWdDLGFBQWFoQyxFQUFXRCxFQUFLakIsSUFBS2lCLEVBQUtoQixJQUFJLElBRXpEdU8sRUFBUy9KLFNBQ1RwQyxFQUFjbU0sRUFBU2xNLFdBQWEsV0FBYSxhQUM3Q3BCLEVBQVVrRCxZQUFZb0ssRUFBUzdMLEtBQU04TCxFQUFRLEdBQUd6TyxJQUFLeU8sRUFBUSxHQUFHeE8sSUFBS29DLEtBSXJFbU0sRUFBUy9KLFNBQ1RwQyxFQUFjbU0sRUFBU2xNLFdBQWEsV0FBYSxjQUpqRHBCLEVBQVVrQixVQUFVb00sRUFBVUMsRUFBUSxHQUFHek8sSUFBS3lPLEVBQVEsR0FBR3hPLElBQUtvQyxHQU9sRW5CLEVBQVVwQixZQUFZc0IsU0FBU0gsSUFDM0JDLEVBQVVnQyxhQUFhaEMsRUFBV0QsRUFBS2pCLElBQUtpQixFQUFLaEIsSUFBSSxJQUV6RHNJLEVBQWFySCxHQUNieUksRUFBa0IsUUFBUzBCLEVBQWV2TCxhQUMxQzZKLEVBQWtCLFNBQVUyQixFQUFnQnhMLGFBQzVDc0wsRUFBWUMsRUFBZ0JDLEVBQWlCLEVBQVcyQixXQUM1RCxDQUNBLFNBQVNMLEVBQWdCN0YsR0FDckJBLEVBQUUwRyxnQkFDTixDQWxEQXRCLEVBQWdCL0ssU0FBUSxDQUFDQyxFQUFNbU0sS0FDM0JuTSxFQUFLeUosaUJBQWlCLFdBQVl5QyxFQUFlQyxJQUNqRG5NLEVBQUt5SixpQkFBaUIsWUFBYW1ELEdBQ25DNU0sRUFBS3lKLGlCQUFpQixPQUFRcUQsRUFBVyxJQUU3Qy9CLEVBQWlCaEwsU0FBUSxDQUFDQyxFQUFNbU0sS0FDNUJuTSxFQUFLeUosaUJBQWlCLFdBQVl5QyxFQUFlQyxJQUNqRG5NLEVBQUt5SixpQkFBaUIsWUFBYW1ELEdBQ25DNU0sRUFBS3lKLGlCQUFpQixPQUFRcUQsRUFBVyxHQTBDN0MsRUFFSjNHLEVBQU9zRCxpQkFBaUIsU0FBUyxLQUM3QmhDLEVBQVUsU0FDVkgsRUFBZW5CLEVBQVFFLEdBQ1IvRixTQUFTMkYsY0FBYyxnQkFDL0J6RixVQUFVSSxPQUFPLFNBQ3hCeU0sRUFBWSxTQUNaL0csRUFBU3NCLFVBQVcsRUFDcEJ6QixFQUFPeUIsVUFBVyxDQUFJLElBRTFCdkIsRUFBT29ELGlCQUFpQixTQUFTLEtBQzdCaEMsRUFBVSxTQUNWQSxFQUFVLFVBQ1ZILEVBQWVqQixFQUFRRixHQUN2QixNQUFNbUgsRUFBU2hOLFNBQVMyRixjQUFjLGdCQUN0Q3FILEVBQU85TSxVQUFVSSxPQUFPLFFBQ3hCME0sRUFBTzlNLFVBQVVLLElBQUksU0FDckJzRSxRQUFRb0ksSUFBSSxDQUFDRixFQUFZLFNBQVVBLEVBQVksWUFDL0MvRyxFQUFTc0IsVUFBVyxFQUNwQnJCLEVBQVVxQixVQUFXLEVBQ3JCdkIsRUFBT3VCLFVBQVcsQ0FBSSxJQUUxQnhCLEVBQVdxRCxpQkFBaUIsU0FBUyxJQUFNM0UsT0FBVSxPQUFRLE9BQVEsR0FBUSxZQUN6RTJDLEVBQVUsU0FDTnBCLEVBQU83RixVQUFVQyxTQUFTLGNBQzFCZ0gsRUFBVSxVQUNWbkIsRUFBU3NCLFVBQVcsRUFDcEJyQixFQUFVcUIsVUFBVyxFQUNyQnZCLEVBQU91QixVQUFXLEdBRXRCN0IsRUFBR3lILDJCQTNkcUIxSSxPQUFVLE9BQVEsT0FBUSxHQUFRLFlBQzFEb0QsSUFDQVIsR0FBUSxHQUNSbEIsRUFBUXpHLFNBQVM0SCxHQUFTQSxFQUFJQyxVQUFXLFVBQ25DLEVBQVc2RixVQUNqQmpILEVBQVF6RyxTQUFTNEgsR0FBU0EsRUFBSUMsVUFBVyxJQUN6Q0YsR0FBUSxHQUNSSyxJQUNJNUIsRUFBTzNGLFVBQVVDLFNBQVMsYUFDMUJ1SCxHQUVSLElBa2RJLE1BQU1zRixFQUFTaE4sU0FBUzJGLGNBQWMsZ0JBQ3RDcUgsRUFBTzlNLFVBQVVJLE9BQU8sUUFDcEJ1RixFQUFPM0YsVUFBVUMsU0FBUyxjQUMxQjZNLEVBQU85TSxVQUFVSSxPQUFPLFNBQ3hCeU0sRUFBWSxTQUNaL0csRUFBU3NCLFVBQVcsRUFDcEJ6QixFQUFPeUIsVUFBVyxHQUVsQnZCLEVBQU83RixVQUFVQyxTQUFTLGNBQzFCNk0sRUFBTzlNLFVBQVVLLElBQUksU0FDckIwRixFQUFVcUIsVUFBVyxFQUNyQnpDLFFBQVFvSSxJQUFJLENBQUNGLEVBQVksU0FBVUEsRUFBWSxZQUMvQy9HLEVBQVNzQixVQUFXLEVBQ3BCckIsRUFBVXFCLFVBQVcsRUFDckJ2QixFQUFPdUIsVUFBVyxFQUUxQixNQUNBdEIsRUFBU21ELGlCQUFpQixTQUFTLEtBQy9CLEVBQVdySSxRQUNHZCxTQUFTMkYsY0FBYyxlQUMvQnpGLFVBQVVLLElBQUksUUFDcEIsTUFBTXlNLEVBQVNoTixTQUFTMkYsY0FBYyxnQkFDdENxSCxFQUFPOU0sVUFBVUssSUFBSSxRQUNyQnlNLEVBQU85TSxVQUFVSyxJQUFJLFNBQ3JCd00sRUFBWSxVQUNaL0csRUFBU3NCLFVBQVcsRUFDcEJyQixFQUFVcUIsVUFBVyxDQUFJLElBRTdCckIsRUFBVWtELGlCQUFpQixTQUFTLEtBQ2hDLEVBQVdwSixrQkFBa0JiLGFBQzdCMEgsRUFBYSxFQUFXN0csbUJBQ3hCLEVBQVdxTix3QkFBd0IsUUFBUyxFQUFXdE4sZ0JBQ3ZEMkosRUFBWSxFQUFXM0osZUFBZ0IsRUFBV0Msa0JBQW1CLEVBQVd1TCxZQUNoRjdELElBQ0ErQixJQUNBckMsRUFBVSxTQUFTLElBRXZCLElBQUlrRyxFQUFhLElBQ2pCbEgsRUFBTzFHLFNBQVM2TixJQUNaQSxFQUFNbkUsaUJBQWlCLFNBQVMsS0FDNUIsSUFBSW9FLEVBQVFELEVBQ1JDLEVBQU1DLFVBQ05ILEVBQWFyTCxPQUFPdUwsRUFBTXRJLE9BQzlCLEdBQ0YsSUFFTixNQUFNdUMsRUFBZ0IsSUFDWDZGLEVBRVgxRSxPQUFPUSxpQkFBaUIsU0FBVXpCLEdBQ2xDLE1BQU1QLEVBQWFvRyxJQUNmLElBQUlqSCxFQUNVLFVBQVZpSCxFQUNBakgsRUFBUXRHLFNBQVMyRixjQUFjLGVBRWhCLFdBQVY0SCxJQUNMakgsRUFBUXRHLFNBQVMyRixjQUFjLGlCQUVyQlcsRUFBTXJHLGlCQUFpQixTQUMvQlIsU0FBU0MsSUFDWEEsRUFBS1EsVUFBVUssSUFBSSxTQUFTLEdBQzlCLEVBRUF3TSxFQUFlUSxHQUFVL0ksT0FBVSxPQUFRLE9BQVEsR0FBUSxZQUU3RCxJQUFJOEIsRUFESmMsR0FBUSxHQUVNLFVBQVZtRyxFQUNBakgsRUFBUXRHLFNBQVMyRixjQUFjLGVBRWhCLFdBQVY0SCxJQUNMakgsRUFBUXRHLFNBQVMyRixjQUFjLGlCQUVuQyxNQUFNOUUsRUFBUXlGLEVBQU1yRyxpQkFBaUIsU0FDckNZLEVBQU1wQixTQUFTQyxJQUNYQSxFQUFLUSxVQUFVSyxJQUFJLFNBQVMsVUFFMUIsSUFBSXNFLFNBQVNDLElBQ2ZqRSxFQUFNcEIsU0FBUSxDQUFDQyxFQUFNbU0sS0FDakJ0RSxZQUFXLEtBQ1A3SCxFQUFLUSxVQUFVSSxPQUFPLFVBQ2xCdUwsSUFBVWhMLEVBQU16QixPQUFTLEdBQ3pCMEYsR0FDSixHQUNBMEMsSUFBa0IsSUFBT3FFLEVBQU0sR0FDckMsSUFFTnpFLEdBQVEsRUFDWixJQUNBLE1BQU8sQ0FDSHFHLFlBam5CaUJsTyxJQUNqQixNQUFNK0csRUFBUXRHLFNBQVN3RyxjQUFjLE9BQ3JDRixFQUFNcEcsVUFBVUssSUFBSSxTQUNoQmhCLElBQWMsRUFBV08sZUFDekJ3RyxFQUFNcUYsR0FBSyxhQUVOcE0sSUFBYyxFQUFXUSxvQkFDOUJ1RyxFQUFNcUYsR0FBSyxlQUVmdEYsRUFBWTlHLEVBQVcrRyxHQUN2QlYsRUFBT2UsT0FBT0wsRUFBTSxFQXdtQnBCTSxlQUNBOEcsZ0JBcGxCb0IsSUFBTWxKLE9BQVUsT0FBUSxPQUFRLEdBQVEsWUFDNUQsTUFBTTNELEVBQVFiLFNBQVNDLGlCQUFpQixzQkFDeEMsSUFBSTBOLEVBQ0osR0FDSUEsUUFBa0IsSUFBSTlJLFNBQVNDLElBQzNCakUsRUFBTXBCLFNBQVNDLElBQ05BLEVBQUtRLFVBQVVDLFNBQVMsUUFBV1QsRUFBS1EsVUFBVUMsU0FBUyxTQUM1RFQsRUFBS3lKLGlCQUFpQixTQUFVL0QsSUFDNUJOLEVBQVFnQyxFQUFhMUIsR0FBRyxHQUN6QixDQUFFd0ksTUFBTSxHQUNmLEdBQ0YsV0FFQUQsR0FHVixNQUFPLENBQUV0UCxJQUZHc1AsRUFBVXRQLElBQUk0RCxXQUVaM0QsSUFERnFQLEVBQVVyUCxJQUFJMkQsV0FFOUIsSUFva0JJNEQsU0FDQUUsU0FDQXFCLFVBQ0F5RyxnQkFyaEJxQkMsSUFDckIsTUFBTWQsRUFBU2hOLFNBQVMyRixjQUFjLGdCQUN4QixXQUFWbUksRUFDQWQsRUFBTzlNLFVBQVVLLElBQUksZ0JBRU4sYUFBVnVOLEdBQ0xkLEVBQU85TSxVQUFVSSxPQUFPLGVBQzVCLEVBK2dCQTRNLG1CQTdnQnVCLEtBQ1JsTixTQUFTMkYsY0FBYyxnQkFDL0J6RixVQUFVSSxPQUFPLGVBQWUsRUE0Z0J2QzBILG9CQUNBeUIsY0FDQWhDLGVBQ0FDLGlCQUNBcUcsa0JBaGR1QkMsSUFFbkJ0SSxFQUFVMkQsWUFEVjJFLEVBQ3dCLHNDQUdBLHNDQUM1QixFQTJjQUMsa0JBemN1QkQsSUFFbkJ0SSxFQUFVMkQsWUFEVjJFLEVBQ3dCLGdCQUdBLGFBQzVCLEVBb2NBRSxzQkFsYzJCQyxJQUNmLFdBQVJBLEVBQ0F6SSxFQUFVMkQsWUFBYywwQkFFWCxhQUFSOEUsSUFDTHpJLEVBQVUyRCxZQUFjLDRCQUM1QixFQTZiQStFLHNCQTNiMkJELElBQ2YsV0FBUkEsRUFDQXpJLEVBQVUyRCxZQUFjLGlDQUVYLGFBQVI4RSxJQUNMekksRUFBVTJELFlBQWMsbUNBQzVCLEVBc2JBekIsb0JBQ0FKLGdCQUNBdUYsY0FFUCxFQWxxQlUsR0FtcUJYLElDN3FCQSxJQUFJLEVBQXdDLFNBQVV0SSxFQUFTQyxFQUFZQyxFQUFHQyxHQUUxRSxPQUFPLElBQUtELElBQU1BLEVBQUlFLFdBQVUsU0FBVUMsRUFBU0MsR0FDL0MsU0FBU0MsRUFBVUMsR0FBUyxJQUFNQyxFQUFLTixFQUFVTyxLQUFLRixHQUFTLENBQUUsTUFBT0csR0FBS0wsRUFBT0ssRUFBSSxDQUFFLENBQzFGLFNBQVNDLEVBQVNKLEdBQVMsSUFBTUMsRUFBS04sRUFBaUIsTUFBRUssR0FBUyxDQUFFLE1BQU9HLEdBQUtMLEVBQU9LLEVBQUksQ0FBRSxDQUM3RixTQUFTRixFQUFLdkIsR0FKbEIsSUFBZXNCLEVBSWF0QixFQUFPMkIsS0FBT1IsRUFBUW5CLEVBQU9zQixRQUoxQ0EsRUFJeUR0QixFQUFPc0IsTUFKaERBLGFBQWlCTixFQUFJTSxFQUFRLElBQUlOLEdBQUUsU0FBVUcsR0FBV0EsRUFBUUcsRUFBUSxLQUlqQk0sS0FBS1AsRUFBV0ssRUFBVyxDQUM3R0gsR0FBTU4sRUFBWUEsRUFBVVksTUFBTWYsRUFBU0MsR0FBYyxLQUFLUyxPQUNsRSxHQUNKLEVBS0EsTUFBTWtKLEVBQWEsTUFDZixNQUFNdk8sRUFBaUJQLElBQ2pCUSxFQUFvQlIsSUFDcEIrTyxFQUFRQyxJQUNSQyxFQUFXRCxJQUNqQixJQUFJRSxHQUFZLEVBQ1pDLEVBQWVwUCxFQUFZLFdBQzNCcVAsRUFBa0JyUCxFQUFZLGNBQzlCc1AsRUFBaUJ0UCxFQUFZLGFBQzdCdVAsRUFBaUJ2UCxFQUFZLGFBQzdCd1AsRUFBa0J4UCxFQUFZLGNBQ2xDLE1BQU1nTSxFQUFhLENBQUNvRCxFQUFjQyxFQUFpQkMsRUFBZ0JDLEVBQWdCQyxHQUM3RUMsRUFBZ0IsS0FDbEJoUCxFQUFrQlUsVUFBVWlPLEVBQWMsSUFBSyxJQUFLLGNBQ3BEM08sRUFBa0JVLFVBQVVrTyxFQUFpQixJQUFLLElBQUssY0FDdkQ1TyxFQUFrQlUsVUFBVW1PLEVBQWdCLElBQUssSUFBSyxjQUN0RDdPLEVBQWtCVSxVQUFVb08sRUFBZ0IsSUFBSyxJQUFLLGNBQ3REOU8sRUFBa0JVLFVBQVVxTyxFQUFpQixJQUFLLElBQUssY0FDdkQvTyxFQUFrQndCLGFBQWF4QixFQUFtQixJQUFLLEtBQ3ZEQSxFQUFrQndCLGFBQWF4QixFQUFtQixJQUFLLEtBQ3ZEQSxFQUFrQndCLGFBQWF4QixFQUFtQixJQUFLLEtBQ3ZEQSxFQUFrQndCLGFBQWF4QixFQUFtQixJQUFLLEtBQ3ZEQSxFQUFrQndCLGFBQWF4QixFQUFtQixJQUFLLElBQUksRUFFekRpUCxFQUFhLElBQ1hqUCxFQUFrQnVDLFFBQVF2QyxJQUMxQixFQUFHbU4scUJBQ0MsRUFBR3JILE9BQU8zRixVQUFVQyxTQUFTLGFBQzdCLEVBQUcrTixzQkFBc0IsVUFFekIsRUFBR25JLE9BQU83RixVQUFVQyxTQUFTLGFBQzdCLEVBQUdpTyxzQkFBc0IsV0FHdEIsS0FFUHRPLEVBQWV3QyxRQUFReEMsS0FDdkIsRUFBR29OLHFCQUNDLEVBQUdySCxPQUFPM0YsVUFBVUMsU0FBUyxhQUM3QixFQUFHK04sc0JBQXNCLFlBRXpCLEVBQUduSSxPQUFPN0YsVUFBVUMsU0FBUyxhQUM3QixFQUFHaU8sc0JBQXNCLGFBR3RCLEdBSVRhLEVBQWMxUCxJQUNoQixJQUFJZ1AsRUFPSixHQU5JaFAsSUFBY08sRUFDZHlPLEVBQVNDLEVBRUpqUCxJQUFjUSxJQUNuQndPLEVBQVNELEdBRVQvTyxFQUFVMkMsY0FBYzNDLElBQ3hCLEdBQTRCLE9BQXhCZ1AsRUFBT2pLLGNBQ2lCLE9BQXhCaUssRUFBT2hLLGNBQ1BoRixFQUFVbkIsUUFBUW1RLEVBQU9oSyxhQUFhbEcsSUFBS2tRLEVBQU9oSyxhQUFhakcsS0FBS1EsUUFBUStELFVBQVksR0FDeEZ0RCxFQUFVbkIsUUFBUW1RLEVBQU9oSyxhQUFhbEcsSUFBS2tRLEVBQU9oSyxhQUFhakcsS0FBS1EsUUFBUStELFVBQVksR0FJeEYsR0FGQTBMLEVBQU9sTCxnQkFBZ0I5RCxFQUFXZ1AsRUFBT2hLLGFBQWFsRyxJQUFLa1EsRUFBT2hLLGFBQWFqRyxJQUFLaVEsRUFBT2pLLGNBQzNGL0UsRUFBVThDLFNBQVM5QyxFQUFXZ1AsRUFBT2hLLGFBQWFsRyxJQUFLa1EsRUFBT2hLLGFBQWFqRyxLQUN2RTBRLElBQ0EsWUFHSCxHQUE2RixJQUF6RnpQLEVBQVVuQixRQUFRbVEsRUFBT2hLLGFBQWFsRyxJQUFLa1EsRUFBT2hLLGFBQWFqRyxLQUFLUSxRQUFRK0QsV0FDakYwTCxFQUFPcEssZUFBZTVFLEVBQVdnUCxFQUFPaEssYUFBYWxHLElBQUtrUSxFQUFPaEssYUFBYWpHLEtBQzlFaUIsRUFBVThDLFNBQVM5QyxFQUFXZ1AsRUFBT2hLLGFBQWFsRyxJQUFLa1EsRUFBT2hLLGFBQWFqRyxLQUN2RTBRLEtBQ0EsV0FJUCxDQUNELE1BQU0sSUFBRTNRLEVBQUcsSUFBRUMsR0FBUWlRLEVBQU8zSyxhQUFhckUsR0FLekMsR0FKMkMsUUFBdkNBLEVBQVVuQixRQUFRQyxFQUFLQyxHQUFLTyxTQUM1QjBQLEVBQU9qTCxXQUFXaUwsRUFBT2hLLGNBQ3pCZ0ssRUFBT2hMLFdBQVcsQ0FBRWxGLE1BQUtDLFNBRWMsUUFBdkNpQixFQUFVbkIsUUFBUUMsRUFBS0MsR0FBS08sUUFBb0JVLEVBQVVuQixRQUFRQyxFQUFLQyxHQUFLUSxRQUFRc0QsV0FDcEY3QyxFQUFVOEMsU0FBUzlDLEVBQVdsQixFQUFLQyxHQUNuQ2lRLEVBQU9qTCxXQUFXLE1BQ2xCaUwsRUFBT2hMLFdBQVcsTUFDZHlMLEtBQ0EsTUFHWixHQTJHRTVCLEVBQTBCLENBQUNuRixFQUFlMUksS0FDNUNBLEVBQVVMLGFBMUNVLENBQUNLLElBQ3JCLElBQUkyUCxFQUNBM1AsSUFBY08sR0FDZDRPLEVBQWVwUCxFQUFZLFdBQzNCcVAsRUFBa0JyUCxFQUFZLGNBQzlCc1AsRUFBaUJ0UCxFQUFZLGFBQzdCdVAsRUFBaUJ2UCxFQUFZLGFBQzdCd1AsRUFBa0J4UCxFQUFZLGNBQzlCNFAsRUFBVyxDQUFDUixFQUFjQyxFQUFpQkMsRUFBZ0JDLEVBQWdCQyxJQUV0RXZQLElBQWNRLElBTW5CbVAsRUFBVyxDQUxhNVAsRUFBWSxXQUNUQSxFQUFZLGNBQ2JBLEVBQVksYUFDWkEsRUFBWSxhQUNYQSxFQUFZLGdCQUczQytPLEVBQVcvQyxXQUFXbE0sT0FBUyxFQUMvQixNQUFNcEIsRUFBTyxDQUFDLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLEtBQ3JENkYsRUFBWSxJQUFNN0YsRUFBSytGLEtBQUtDLE1BQU1ELEtBQUtFLFNBQVdqRyxFQUFLb0IsU0FDdkQwRSxFQUFZLElBQU1DLEtBQUtHLEtBQXFCLEdBQWhCSCxLQUFLRSxVQUFlaEMsV0FDaERrTixFQUFvQixJQUFPcEwsS0FBS0UsU0FBVyxHQUFNLGFBQWUsV0FDdEVpTCxFQUFTelAsU0FBU0gsSUFDZCxJQUFJakIsRUFBTXdGLElBQ052RixFQUFNd0YsSUFDTnBELEVBQWN5TyxJQUNkeEwsRUFBU3BFLEVBQVVrRCxZQUFZbkQsRUFBSzBCLEtBQU0zQyxFQUFLQyxFQUFLb0MsR0FDeEQsTUFBUWlELEdBQ0p0RixFQUFNd0YsSUFDTnZGLEVBQU13RixJQUNOcEQsRUFBY3lPLElBQ2R4TCxFQUFTcEUsRUFBVWtELFlBQVluRCxFQUFLMEIsS0FBTTNDLEVBQUtDLEVBQUtvQyxHQUVwRGlELElBQ0FwRSxFQUFVa0IsVUFBVW5CLEVBQU1qQixFQUFLQyxFQUFLb0MsR0FDcENuQixFQUFVZ0MsYUFBYWhDLEVBQVdsQixFQUFLQyxJQUUzQytQLEVBQVcvQyxXQUFXbkssS0FBSzdCLEVBQUssR0FDbEMsRUFJRjhQLENBQWdCN1AsR0FDaEIsRUFBR3FILGFBQWFySCxHQUNNLFVBQWxCMEksR0FDQSxFQUFHRCxrQkFBa0IsUUFBU3pJLEVBQVVwQixZQUM1QyxFQVNFa1IsRUFBZSxLQUNiLEVBQUd0SixPQUFPN0YsVUFBVUMsU0FBUyxjQUM3QmlOLEVBQXdCLFFBQVN0TixHQUNqQ3NOLEVBQXdCLFNBQVVyTixHQUNsQzBPLEdBQVksRUE1RmlCLE9BQVUsT0FBUSxPQUFRLEdBQVEsWUFDbkUsRUFBR3ZCLHFCQUNILElBQUljLEdBQWUsRUFDbkIsTUFBUWdCLE1BQWlCUCxHQUFXLENBRWhDLEdBREEsRUFBR3JILFNBQVEsR0FDUDRHLEVBQWMsQ0FHZCxHQUZBLEVBQUdDLGtCQUFrQkQsU0FDZixJQUFJbkosU0FBU0MsR0FBWXlDLFdBQVd6QyxFQUFTLEVBQUcwQyxvQkFDakQsRUFBR3pCLE9BQU83RixVQUFVQyxTQUFTLGFBQWVzTyxFQUM3QyxNQUVKUSxFQUFXblAsR0FDWCxFQUFHOEcsYUFBYTlHLEdBQ2hCa08sR0FBZSxDQUNuQixDQUNBLEdBQUlnQixLQUFnQlAsRUFDaEIsTUFFSixJQUFLVCxFQUFjLENBR2YsR0FGQSxFQUFHQyxrQkFBa0JELFNBQ2YsSUFBSW5KLFNBQVNDLEdBQVl5QyxXQUFXekMsRUFBUyxFQUFHMEMsb0JBQ2pELEVBQUd6QixPQUFPN0YsVUFBVUMsU0FBUyxhQUFlc08sRUFDN0MsTUFFSlEsRUFBV2xQLEdBQ1gsRUFBRzZHLGFBQWE3RyxHQUNoQmlPLEdBQWUsQ0FDbkIsQ0FDSixDQUNBUyxHQUFZLEVBQ1osRUFBR3JILFNBQVEsRUFDZixJQStEUSxFQUFHUixhQUFhOUcsR0FDcEIsRUFRRTZILEVBQVUsS0FDWjhHLEdBQVksRUFDWkgsRUFBTWhMLFdBQVcsTUFDakJnTCxFQUFNL0ssV0FBVyxNQUNqQmlMLEVBQVNsTCxXQUFXLE1BQ3BCa0wsRUFBU2pMLFdBQVcsTUFDcEJ6RCxFQUFlWixhQUNmYSxFQUFrQmIsYUFDbEI2UCxJQUNBLEVBQUduSSxhQUFhOUcsR0FDaEIsRUFBRzhHLGFBQWE3RyxHQUNoQixFQUFHaUksa0JBQWtCLFNBQVVqSSxFQUFrQjVCLGFBQ2pELEVBQUdzTCxZQUFZM0osRUFBZ0JDLEVBQW1CdUwsR0FDbEQsRUFBRzdELGVBQ0g0SCxJQW5DQS9ELEVBQVc3TCxTQUFTSCxLQUNRLElBQXBCQSxFQUFLcUIsYUFDTHJCLEVBQUtxQixZQUFhLEVBQ3RCLEdBaUNjLEVBcUJ0QixNQUFPLENBQUUyTyxLQWJJLEtBQ1QsRUFBRzVILGlCQUNILEVBQUcrRixZQUFZM04sR0FDZixFQUFHMk4sWUFBWTFOLEdBQ2ZnUCxJQUNBLEVBQUduSSxhQUFhN0csR0FDaEIsRUFBR2lJLGtCQUFrQixTQUFVakksRUFBa0I1QixhQUNqRCxFQUFHc0wsWUFBWTNKLEVBQWdCQyxFQUFtQnVMLEdBQ2xELEVBQUc3RCxlQUNINEgsSUFDQSxFQUFHdEMsWUFBWSxTQUNmLEVBQUdsSCxPQUFPeUIsVUFBVyxDQUFJLEVBRWR4SCxpQkFBZ0JDLG9CQUFtQjRILFVBQVN3RixRQW5CM0MsSUFBTSxPQUFVLE9BQVEsT0FBUSxHQUFRLFlBQ3BEc0IsR0FBWSxRQUNOLElBQUk1SixTQUFTQyxHQUFZeUMsV0FBV3pDLEVBQVMsRUFBRzBDLG1CQUN0RGlILEdBQVksRUFDWjlHLEdBQ0osSUFjb0U3RyxNQTFDdEQsS0FDVixFQUFHOEYsYUFBYTlHLEdBQ2hCc04sRUFBd0IsU0FBVXJOLEdBQ2xDME8sR0FBWSxFQXBJbUIsT0FBVSxPQUFRLE9BQVEsR0FBUSxZQUNqRSxJQUFJVCxHQUFlLEVBQ25CLE1BQVFnQixNQUFpQlAsR0FBVyxDQUNoQyxHQUFJVCxFQUFjLENBQ2QsRUFBR0Qsa0JBQWtCQyxHQUNyQixFQUFHSCxnQkFBZ0IsVUFDbkIsRUFBR3pHLFNBQVEsR0FDWCxNQUFNLElBQUUvSSxFQUFHLElBQUVDLFNBQWMsRUFBR29QLGtCQUM5QlksRUFBTTVLLE9BQU8zRCxFQUFtQjFCLEVBQUtDLEdBQ3JDeUIsRUFBa0JzQyxTQUFTdEMsRUFBbUIxQixFQUFLQyxHQUNuRCxFQUFHc0ksYUFBYTdHLEdBQ2hCaU8sR0FBZSxDQUNuQixDQUNBLEdBQUlnQixLQUFnQlAsRUFDaEIsTUFFSixJQUFLVCxFQUFjLENBS2YsR0FKQSxFQUFHRCxrQkFBa0JDLEdBQ3JCLEVBQUdILGdCQUFnQixZQUNuQixFQUFHekcsU0FBUSxTQUNMLElBQUl2QyxTQUFTQyxHQUFZeUMsV0FBV3pDLEVBQVMsRUFBRzBDLG9CQUNqRCxFQUFHM0IsT0FBTzNGLFVBQVVDLFNBQVMsYUFBZXNPLEVBQzdDLE1BRUpRLEVBQVduUCxHQUNYLEVBQUc4RyxhQUFhOUcsR0FDaEJrTyxHQUFlLENBQ25CLENBQ0osQ0FDQVMsR0FBWSxFQUNaLEVBQUdySCxTQUFRLEVBQ2YsR0FzRzBCLEVBc0NpRGdHLDBCQUF5QjlCLGFBQ3ZHLEVBelFrQixHQTBRbkIsSUNwUkEsRUFBV2dFLE0iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL21vZHVsZXMvZ2FtZWJvYXJkLnRzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvbW9kdWxlcy9zaGlwLnRzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvbW9kdWxlcy9wbGF5ZXIudHMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9tb2R1bGVzL3VpLnRzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvbW9kdWxlcy9jb250cm9sbGVyLnRzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNvbnRyb2xsZXIgZnJvbSAnLi9jb250cm9sbGVyJztcbmNvbnN0IGdhbWVib2FyZEZhY3RvcnkgPSAoKSA9PiB7XG4gICAgY29uc3QgY29scyA9IFsnQScsICdCJywgJ0MnLCAnRCcsICdFJywgJ0YnLCAnRycsICdIJywgJ0knLCAnSiddO1xuICAgIGNvbnN0IHJvd3MgPSBbJzEnLCAnMicsICczJywgJzQnLCAnNScsICc2JywgJzcnLCAnOCcsICc5JywgJzEwJ107XG4gICAgY29uc3QgYXJyYXkgPSBbXTtcbiAgICBjb25zdCBzaGlwc1BsYWNlZCA9IFtdO1xuICAgIGNvbnN0IGdlbmVyYXRlQXJyYXkgPSAoKSA9PiB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkgKz0gMSkge1xuICAgICAgICAgICAgYXJyYXlbaV0gPSBbXTtcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTA7IGogKz0gMSkge1xuICAgICAgICAgICAgICAgIGFycmF5W2ldW2pdID0geyBjb2w6IGNvbHNbal0sIHJvdzogcm93c1tpXSwgc3RhdHVzOiAnZW1wdHknLCB0YWtlbkJ5OiBudWxsIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IGNsZWFyQm9hcmQgPSAoKSA9PiB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkgKz0gMSkge1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAxMDsgaiArPSAxKSB7XG4gICAgICAgICAgICAgICAgYXJyYXlbaV1bal0uc3RhdHVzID0gJ2VtcHR5JztcbiAgICAgICAgICAgICAgICBhcnJheVtpXVtqXS50YWtlbkJ5ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHNoaXBzUGxhY2VkLmxlbmd0aCA9IDA7XG4gICAgfTtcbiAgICBjb25zdCBnZXRDZWxsID0gKGNvbCwgcm93KSA9PiB7XG4gICAgICAgIGNvbnN0IGNvbEluZGV4ID0gY29scy5pbmRleE9mKGNvbCk7XG4gICAgICAgIGNvbnN0IHJvd0luZGV4ID0gcm93cy5pbmRleE9mKHJvdyk7XG4gICAgICAgIGlmIChjb2xJbmRleCA9PT0gLTEgfHwgcm93SW5kZXggPT09IC0xKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXJyYXlbcm93SW5kZXhdW2NvbEluZGV4XTtcbiAgICB9O1xuICAgIGNvbnN0IHNldENlbGwgPSAoY29sLCByb3csIG5ld1N0YXR1cywgbmV3VGFrZW5CeSkgPT4ge1xuICAgICAgICBjb25zdCBjb2xJbmRleCA9IGNvbHMuaW5kZXhPZihjb2wpO1xuICAgICAgICBjb25zdCByb3dJbmRleCA9IHJvd3MuaW5kZXhPZihyb3cpO1xuICAgICAgICBpZiAoY29sSW5kZXggPT09IC0xIHx8IHJvd0luZGV4ID09PSAtMSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgYXJyYXlbcm93SW5kZXhdW2NvbEluZGV4XS5zdGF0dXMgPSBuZXdTdGF0dXM7XG4gICAgICAgIGlmIChuZXdUYWtlbkJ5KSB7XG4gICAgICAgICAgICBhcnJheVtyb3dJbmRleF1bY29sSW5kZXhdLnRha2VuQnkgPSBuZXdUYWtlbkJ5O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcnJheVtyb3dJbmRleF1bY29sSW5kZXhdO1xuICAgIH07XG4gICAgY29uc3QgcmVtb3ZlU2hpcCA9IChzaGlwLCBnYW1lYm9hcmQpID0+IHtcbiAgICAgICAgY29uc3QgZ2FtZWJvYXJkQ2VsbHMgPSBnYW1lYm9hcmQuYXJyYXkuZmxhdCgpO1xuICAgICAgICBnYW1lYm9hcmRDZWxscy5mb3JFYWNoKChjZWxsKSA9PiB7XG4gICAgICAgICAgICBpZiAoY2VsbC5zdGF0dXMgPT09ICd0YWtlbicgJiYgY2VsbC50YWtlbkJ5Lm5hbWUgPT09IHNoaXAubmFtZSkge1xuICAgICAgICAgICAgICAgIGNlbGwuc3RhdHVzID0gJ2VtcHR5JztcbiAgICAgICAgICAgICAgICBjZWxsLnRha2VuQnkgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2hpcHNQbGFjZWQuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChzaGlwLnRha2VuQnkgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgc2hpcHNQbGFjZWQuc3BsaWNlKHNoaXBzUGxhY2VkLmluZGV4T2Yoc2hpcCksIDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbGV0IGJvYXJkSWQ7XG4gICAgICAgICAgICBpZiAoZ2FtZWJvYXJkID09PSBjb250cm9sbGVyLmh1bWFuR2FtZWJvYXJkKSB7XG4gICAgICAgICAgICAgICAgYm9hcmRJZCA9ICdmaXJzdEJvYXJkJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGdhbWVib2FyZCA9PT0gY29udHJvbGxlci5jb21wdXRlckdhbWVib2FyZCkge1xuICAgICAgICAgICAgICAgIGJvYXJkSWQgPSAnc2Vjb25kQm9hcmQnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgY2VsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGAjJHtib2FyZElkfSAuY2VsbGApO1xuICAgICAgICAgICAgY2VsbHMuZm9yRWFjaCgoY2VsbCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChjZWxsLmNsYXNzTGlzdC5jb250YWlucygndGFrZW4nKSAmJiBjZWxsLmdldEF0dHJpYnV0ZSgnZGF0YS1zaGlwTmFtZScpID09PSBzaGlwLm5hbWUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5yZW1vdmUoJ3Rha2VuJyk7XG4gICAgICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnZW1wdHknKTtcbiAgICAgICAgICAgICAgICAgICAgY2VsbC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtc2hpcE5hbWUnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBjb25zdCBwbGFjZVNoaXAgPSAoc2hpcCwgY29sLCByb3csIG9yaWVudGF0aW9uKSA9PiB7XG4gICAgICAgIGlmIChvcmllbnRhdGlvbiA9PT0gJ2hvcml6b250YWwnKSB7XG4gICAgICAgICAgICBzaGlwLmlzVmVydGljYWwgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNoaXAuaXNWZXJ0aWNhbCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaXNIb3Jpem9udGFsID0gb3JpZW50YXRpb24gPT09ICdob3Jpem9udGFsJztcbiAgICAgICAgY29uc3QgY2VsbHMgPSBpc0hvcml6b250YWwgPyBjb2xzIDogcm93cztcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBjZWxscy5pbmRleE9mKGlzSG9yaXpvbnRhbCA/IGNvbCA6IHJvdyk7XG4gICAgICAgIGxldCBzaGlwQ2VsbHMgPSBbXTtcbiAgICAgICAgaWYgKHN0YXJ0IDwgMCB8fCBzdGFydCArIHNoaXAuc2l6ZSA+IGNlbGxzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5zaXplOyBpICs9IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRDb2wgPSBpc0hvcml6b250YWwgPyBjZWxsc1tzdGFydCArIGldIDogY29sO1xuICAgICAgICAgICAgY29uc3QgY3VycmVudFJvdyA9IGlzSG9yaXpvbnRhbCA/IHJvdyA6IGNlbGxzW3N0YXJ0ICsgaV07XG4gICAgICAgICAgICBpZiAoZ2V0Q2VsbChjdXJyZW50Q29sLCBjdXJyZW50Um93KS5zdGF0dXMgIT09ICdlbXB0eScpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZXRDZWxsKGN1cnJlbnRDb2wsIGN1cnJlbnRSb3csICd0YWtlbicsIHNoaXApO1xuICAgICAgICAgICAgc2hpcENlbGxzLnB1c2goZ2V0Q2VsbChjdXJyZW50Q29sLCBjdXJyZW50Um93KSk7XG4gICAgICAgIH1cbiAgICAgICAgc2hpcHNQbGFjZWQucHVzaChzaGlwQ2VsbHNbMF0pO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIGNvbnN0IGNhbkJlUGxhY2VkID0gKHNpemUsIGNvbCwgcm93LCBvcmllbnRhdGlvbikgPT4ge1xuICAgICAgICBjb25zdCBpc0hvcml6b250YWwgPSBvcmllbnRhdGlvbiA9PT0gJ2hvcml6b250YWwnO1xuICAgICAgICBjb25zdCBjZWxscyA9IGlzSG9yaXpvbnRhbCA/IGNvbHMgOiByb3dzO1xuICAgICAgICBjb25zdCBzdGFydCA9IGNlbGxzLmluZGV4T2YoaXNIb3Jpem9udGFsID8gY29sIDogcm93KTtcbiAgICAgICAgaWYgKHN0YXJ0IDwgMCB8fCBzdGFydCArIHNpemUgPiBjZWxscy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBhcmVFbXB0eSA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpemU7IGkgKz0gMSkge1xuICAgICAgICAgICAgY29uc3QgY3VycmVudENvbCA9IGlzSG9yaXpvbnRhbCA/IGNlbGxzW3N0YXJ0ICsgaV0gOiBjb2w7XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50Um93ID0gaXNIb3Jpem9udGFsID8gcm93IDogY2VsbHNbc3RhcnQgKyBpXTtcbiAgICAgICAgICAgIGFyZUVtcHR5LnB1c2goZ2V0Q2VsbChjdXJyZW50Q29sLCBjdXJyZW50Um93KS5zdGF0dXMgPT09ICdlbXB0eScpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcmVFbXB0eS5ldmVyeSgoaXRlbSkgPT4gaXRlbSA9PT0gdHJ1ZSk7XG4gICAgfTtcbiAgICBjb25zdCByZWNlaXZlQXR0YWNrID0gKGNvbCwgcm93KSA9PiB7XG4gICAgICAgIGNvbnN0IGNlbGwgPSBnZXRDZWxsKGNvbCwgcm93KTtcbiAgICAgICAgaWYgKGNlbGwuc3RhdHVzID09PSAndGFrZW4nKSB7XG4gICAgICAgICAgICBjZWxsLnRha2VuQnkuaGl0KCk7XG4gICAgICAgICAgICBzZXRDZWxsKGNvbCwgcm93LCAnaGl0Jyk7XG4gICAgICAgICAgICByZXR1cm4gY2VsbC5zdGF0dXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNlbGwuc3RhdHVzID09PSAnZW1wdHknIHx8IGNlbGwuc3RhdHVzID09PSAncmVzZXJ2ZWQnKSB7XG4gICAgICAgICAgICBzZXRDZWxsKGNvbCwgcm93LCAnbWlzcycpO1xuICAgICAgICAgICAgcmV0dXJuIGNlbGwuc3RhdHVzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgY29uc3QgcmVjZWl2ZUFyb3VuZCA9IChjb2wsIHJvdykgPT4ge1xuICAgICAgICBjb25zdCBjZWxsID0gZ2V0Q2VsbChjb2wsIHJvdyk7XG4gICAgICAgIGlmIChjZWxsLnN0YXR1cyA9PT0gJ2VtcHR5Jykge1xuICAgICAgICAgICAgc2V0Q2VsbChjb2wsIHJvdywgJ3Jlc2VydmVkJyk7XG4gICAgICAgICAgICByZXR1cm4gY2VsbC5zdGF0dXM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBjb25zdCByZXNlcnZlU3BhY2UgPSAoZ2FtZWJvYXJkLCBjb2wsIHJvdykgPT4ge1xuICAgICAgICBjb25zdCBjZWxsID0gZ2FtZWJvYXJkLmdldENlbGwoY29sLCByb3cpO1xuICAgICAgICBpZiAoY2VsbCAmJiBjZWxsLnRha2VuQnkpIHtcbiAgICAgICAgICAgIGNvbnN0IHNoaXBDZWxscyA9IGdhbWVib2FyZC5hcnJheS5mbGF0KCkuZmlsdGVyKChjKSA9PiBjLnRha2VuQnkgJiYgYy50YWtlbkJ5Lm5hbWUgPT09IGNlbGwudGFrZW5CeS5uYW1lKTtcbiAgICAgICAgICAgIHNoaXBDZWxscy5mb3JFYWNoKChjZWxsKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGlyZWN0aW9ucyA9IFtcbiAgICAgICAgICAgICAgICAgICAgeyBjb2w6IDAsIHJvdzogLTEgfSxcbiAgICAgICAgICAgICAgICAgICAgeyBjb2w6IDAsIHJvdzogMSB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogLTEsIHJvdzogMCB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogMSwgcm93OiAwIH0sXG4gICAgICAgICAgICAgICAgICAgIHsgY29sOiAtMSwgcm93OiAtMSB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogLTEsIHJvdzogMSB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogMSwgcm93OiAtMSB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogMSwgcm93OiAxIH0sXG4gICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb25zLmZvckVhY2goKGRpcmVjdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdDb2wgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNlbGwuY29sLmNoYXJDb2RlQXQoMCkgKyBkaXJlY3Rpb24uY29sKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3Um93ID0gKE51bWJlcihjZWxsLnJvdykgKyBkaXJlY3Rpb24ucm93KS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCBuZXdSb3cpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnYW1lYm9hcmQucmVjZWl2ZUFyb3VuZChuZXdDb2wsIG5ld1Jvdyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCByZW1vdmVSZXNlcnZlZFNwYWNlID0gKGdhbWVib2FyZCkgPT4ge1xuICAgICAgICBjb25zdCBnYW1lYm9hcmRDZWxscyA9IGdhbWVib2FyZC5hcnJheS5mbGF0KCk7XG4gICAgICAgIGdhbWVib2FyZENlbGxzLmZvckVhY2goKGNlbGwpID0+IHtcbiAgICAgICAgICAgIGlmIChjZWxsLnN0YXR1cyA9PT0gJ3Jlc2VydmVkJykge1xuICAgICAgICAgICAgICAgIHNldENlbGwoY2VsbC5jb2wsIGNlbGwucm93LCAnZW1wdHknKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBjb25zdCBzaW5rU2hpcCA9IChnYW1lYm9hcmQsIGNvbCwgcm93KSA9PiB7XG4gICAgICAgIGNvbnN0IGNlbGwgPSBnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIHJvdyk7XG4gICAgICAgIGlmIChjZWxsICYmIGNlbGwudGFrZW5CeSAmJiBjZWxsLnRha2VuQnkuaXNTdW5rKCkpIHtcbiAgICAgICAgICAgIGNvbnN0IHNoaXBDZWxscyA9IGdhbWVib2FyZC5hcnJheS5mbGF0KCkuZmlsdGVyKChjKSA9PiBjLnRha2VuQnkgJiYgYy50YWtlbkJ5Lm5hbWUgPT09IGNlbGwudGFrZW5CeS5uYW1lKTtcbiAgICAgICAgICAgIHNoaXBDZWxscy5mb3JFYWNoKChjZWxsKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGlyZWN0aW9ucyA9IFtcbiAgICAgICAgICAgICAgICAgICAgeyBjb2w6IDAsIHJvdzogLTEgfSxcbiAgICAgICAgICAgICAgICAgICAgeyBjb2w6IDAsIHJvdzogMSB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogLTEsIHJvdzogMCB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogMSwgcm93OiAwIH0sXG4gICAgICAgICAgICAgICAgICAgIHsgY29sOiAtMSwgcm93OiAtMSB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogLTEsIHJvdzogMSB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogMSwgcm93OiAtMSB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogMSwgcm93OiAxIH0sXG4gICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb25zLmZvckVhY2goKGRpcmVjdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdDb2wgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNlbGwuY29sLmNoYXJDb2RlQXQoMCkgKyBkaXJlY3Rpb24uY29sKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3Um93ID0gKE51bWJlcihjZWxsLnJvdykgKyBkaXJlY3Rpb24ucm93KS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCBuZXdSb3cpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnYW1lYm9hcmQucmVjZWl2ZUF0dGFjayhuZXdDb2wsIG5ld1Jvdyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBoaXRCdXROb3RTdW5rID0gKGdhbWVib2FyZCkgPT4ge1xuICAgICAgICBjb25zdCBnYW1lYm9hcmRDZWxscyA9IGdhbWVib2FyZC5hcnJheS5mbGF0KCk7XG4gICAgICAgIHJldHVybiBnYW1lYm9hcmRDZWxscy5zb21lKChjZWxsKSA9PiB7XG4gICAgICAgICAgICBpZiAoY2VsbC5zdGF0dXMgPT09ICdoaXQnICYmIGNlbGwudGFrZW5CeS5pc1N1bmsoKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBjb25zdCBhbGxTdW5rID0gKGdhbWVib2FyZCkgPT4ge1xuICAgICAgICBjb25zdCBnYW1lYm9hcmRDZWxscyA9IGdhbWVib2FyZC5hcnJheS5mbGF0KCk7XG4gICAgICAgIGxldCB0YWtlbkJ5Q2VsbHMgPSBnYW1lYm9hcmRDZWxscy5maWx0ZXIoKGNlbGwpID0+IGNlbGwudGFrZW5CeSk7XG4gICAgICAgIGlmICh0YWtlbkJ5Q2VsbHMubGVuZ3RoID4gMCAmJiB0YWtlbkJ5Q2VsbHMuZXZlcnkoKGNlbGwpID0+IGNlbGwudGFrZW5CeS5pc1N1bmsoKSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBnZW5lcmF0ZUFycmF5KCk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY2xlYXJCb2FyZCxcbiAgICAgICAgZ2V0Q2VsbCxcbiAgICAgICAgc2V0Q2VsbCxcbiAgICAgICAgcmVtb3ZlU2hpcCxcbiAgICAgICAgcGxhY2VTaGlwLFxuICAgICAgICByZWNlaXZlQXR0YWNrLFxuICAgICAgICByZWNlaXZlQXJvdW5kLFxuICAgICAgICByZXNlcnZlU3BhY2UsXG4gICAgICAgIGhpdEJ1dE5vdFN1bmssXG4gICAgICAgIHNpbmtTaGlwLFxuICAgICAgICBhbGxTdW5rLFxuICAgICAgICBhcnJheSxcbiAgICAgICAgY2FuQmVQbGFjZWQsXG4gICAgICAgIHNoaXBzUGxhY2VkLFxuICAgICAgICByZW1vdmVSZXNlcnZlZFNwYWNlLFxuICAgIH07XG59O1xuZXhwb3J0IGRlZmF1bHQgZ2FtZWJvYXJkRmFjdG9yeTtcbiIsImNvbnN0IHNoaXBGYWN0b3J5ID0gKG5hbWUpID0+IHtcbiAgICBsZXQgc2l6ZTtcbiAgICBpZiAobmFtZSA9PT0gJ0NhcnJpZXInKSB7XG4gICAgICAgIHNpemUgPSA1O1xuICAgIH1cbiAgICBpZiAobmFtZSA9PT0gJ0JhdHRsZXNoaXAnKSB7XG4gICAgICAgIHNpemUgPSA0O1xuICAgIH1cbiAgICBpZiAobmFtZSA9PT0gJ0Rlc3Ryb3llcicpIHtcbiAgICAgICAgc2l6ZSA9IDM7XG4gICAgfVxuICAgIGlmIChuYW1lID09PSAnU3VibWFyaW5lJykge1xuICAgICAgICBzaXplID0gMztcbiAgICB9XG4gICAgaWYgKG5hbWUgPT09ICdQYXRyb2xCb2F0Jykge1xuICAgICAgICBzaXplID0gMjtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgc2l6ZSxcbiAgICAgICAgaGl0Q291bnQ6IDAsXG4gICAgICAgIGlzVmVydGljYWw6IGZhbHNlLFxuICAgICAgICByb3RhdGUoKSB7XG4gICAgICAgICAgICB0aGlzLmlzVmVydGljYWwgPSAhdGhpcy5pc1ZlcnRpY2FsO1xuICAgICAgICB9LFxuICAgICAgICBoaXQoKSB7XG4gICAgICAgICAgICB0aGlzLmhpdENvdW50ICs9IDE7XG4gICAgICAgIH0sXG4gICAgICAgIGlzU3VuaygpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmhpdENvdW50ID09PSBzaXplO1xuICAgICAgICB9LFxuICAgIH07XG59O1xuZXhwb3J0IGRlZmF1bHQgc2hpcEZhY3Rvcnk7XG4iLCJjb25zdCBwbGF5ZXJGYWN0b3J5ID0gKCkgPT4ge1xuICAgIGNvbnN0IGNvbHMgPSBbJ0EnLCAnQicsICdDJywgJ0QnLCAnRScsICdGJywgJ0cnLCAnSCcsICdJJywgJ0onXTtcbiAgICBsZXQgcHJldkhpdCA9IG51bGw7XG4gICAgbGV0IGxhc3RIaXQgPSBudWxsO1xuICAgIGNvbnN0IGF0dGFjayA9IChnYW1lYm9hcmQsIGNvbCwgcm93KSA9PiB7XG4gICAgICAgIGlmIChnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIHJvdykuc3RhdHVzICE9PSAnaGl0JyAmJiBnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIHJvdykuc3RhdHVzICE9PSAnbWlzcycpIHtcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSBnYW1lYm9hcmQucmVjZWl2ZUF0dGFjayhjb2wsIHJvdyk7XG4gICAgICAgICAgICBpZiAocmVzdWx0ID09PSAnaGl0Jykge1xuICAgICAgICAgICAgICAgIHNldFByZXZIaXQobGFzdEhpdCk7XG4gICAgICAgICAgICAgICAgc2V0TGFzdEhpdCh7IGNvbDogY29sLCByb3c6IHJvdyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICdhbHJlYWR5IHNob3QnO1xuICAgIH07XG4gICAgY29uc3QgcmFuZG9tQXR0YWNrID0gKGdhbWVib2FyZCkgPT4ge1xuICAgICAgICBsZXQgcmFuZG9tQ29sO1xuICAgICAgICBsZXQgcmFuZG9tUm93O1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICByYW5kb21Db2wgPSBjb2xzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNvbHMubGVuZ3RoKV07XG4gICAgICAgICAgICByYW5kb21Sb3cgPSBNYXRoLmNlaWwoTWF0aC5yYW5kb20oKSAqIDEwKS50b1N0cmluZygpO1xuICAgICAgICB9IHdoaWxlIChnYW1lYm9hcmQuZ2V0Q2VsbChyYW5kb21Db2wsIHJhbmRvbVJvdykuc3RhdHVzID09PSAnaGl0JyB8fCBnYW1lYm9hcmQuZ2V0Q2VsbChyYW5kb21Db2wsIHJhbmRvbVJvdykuc3RhdHVzID09PSAnbWlzcycpO1xuICAgICAgICBpZiAoZ2FtZWJvYXJkLmdldENlbGwocmFuZG9tQ29sLCByYW5kb21Sb3cpLnN0YXR1cyAhPT0gJ2hpdCcgJiYgZ2FtZWJvYXJkLmdldENlbGwocmFuZG9tQ29sLCByYW5kb21Sb3cpLnN0YXR1cyAhPT0gJ21pc3MnKSB7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBnYW1lYm9hcmQucmVjZWl2ZUF0dGFjayhyYW5kb21Db2wsIHJhbmRvbVJvdyk7XG4gICAgICAgICAgICBpZiAoZ2FtZWJvYXJkLmdldENlbGwocmFuZG9tQ29sLCByYW5kb21Sb3cpLnN0YXR1cyA9PT0gJ2hpdCcpIHtcbiAgICAgICAgICAgICAgICBzZXRQcmV2SGl0KGxhc3RIaXQpO1xuICAgICAgICAgICAgICAgIHNldExhc3RIaXQoeyBjb2w6IHJhbmRvbUNvbCwgcm93OiByYW5kb21Sb3cgfSk7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJy0tLS0tLS0tLS0tLS0tLScpO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdyYW5kb21BdHRhY2sgcHJldkhpdCcsIHByZXZIaXQpO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdyYW5kb21BdHRhY2sgbGFzdEhpdCcsIGxhc3RIaXQpO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdyYW5kb21BdHRhY2sgcmFuZ2UnLCByYW5nZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4geyByZXN1bHQsIGNvbDogcmFuZG9tQ29sLCByb3c6IHJhbmRvbVJvdyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHJlc3VsdDogJ2FscmVhZHkgc2hvdCcsIGNvbDogcmFuZG9tQ29sLCByb3c6IHJhbmRvbVJvdyB9O1xuICAgIH07XG4gICAgY29uc3QgZm9sbG93dXBBdHRhY2sgPSAoZ2FtZWJvYXJkLCBjb2wsIHJvdykgPT4ge1xuICAgICAgICBjb25zdCBkaXJlY3Rpb25zID0gW1xuICAgICAgICAgICAgeyBjb2w6IDAsIHJvdzogLTEgfSxcbiAgICAgICAgICAgIHsgY29sOiAwLCByb3c6IDEgfSxcbiAgICAgICAgICAgIHsgY29sOiAtMSwgcm93OiAwIH0sXG4gICAgICAgICAgICB7IGNvbDogMSwgcm93OiAwIH0sXG4gICAgICAgIF07XG4gICAgICAgIGNvbnN0IHZhbGlkRGlyZWN0aW9ucyA9IGRpcmVjdGlvbnMuZmlsdGVyKChkaXJlY3Rpb24pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5ld0NvbCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoY29sLmNoYXJDb2RlQXQoMCkgKyBkaXJlY3Rpb24uY29sKTtcbiAgICAgICAgICAgIGNvbnN0IG5ld1JvdyA9IChOdW1iZXIocm93KSArIGRpcmVjdGlvbi5yb3cpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICBjb25zdCBjZWxsID0gZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCBuZXdSb3cpO1xuICAgICAgICAgICAgaWYgKGNlbGwgJiYgY2VsbC5zdGF0dXMgIT09ICdtaXNzJyAmJiBjZWxsLnN0YXR1cyAhPT0gJ2hpdCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh2YWxpZERpcmVjdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3QgcmFuZG9tRGlyZWN0aW9uID0gdmFsaWREaXJlY3Rpb25zW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHZhbGlkRGlyZWN0aW9ucy5sZW5ndGgpXTtcbiAgICAgICAgICAgIGNvbnN0IG5ld0NvbCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoY29sLmNoYXJDb2RlQXQoMCkgKyByYW5kb21EaXJlY3Rpb24uY29sKTtcbiAgICAgICAgICAgIGNvbnN0IG5ld1JvdyA9IChOdW1iZXIocm93KSArIHJhbmRvbURpcmVjdGlvbi5yb3cpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICBnYW1lYm9hcmQucmVjZWl2ZUF0dGFjayhuZXdDb2wsIG5ld1Jvdyk7XG4gICAgICAgICAgICByYW5nZSA9IDE7XG4gICAgICAgICAgICBpZiAoZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCBuZXdSb3cpLnN0YXR1cyA9PT0gJ2hpdCcpIHtcbiAgICAgICAgICAgICAgICBzZXRQcmV2SGl0KGxhc3RIaXQpO1xuICAgICAgICAgICAgICAgIHNldExhc3RIaXQoeyBjb2w6IG5ld0NvbCwgcm93OiBuZXdSb3cgfSk7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJy0tLS0tLS0tLS0tLS0tLScpO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdmb2xsb3d1cEF0dGFjayBwcmV2SGl0JywgcHJldkhpdCk7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2ZvbGxvd3VwQXR0YWNrIGxhc3RIaXQnLCBsYXN0SGl0KTtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnZm9sbG93dXBBdHRhY2sgcmFuZ2UnLCByYW5nZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnTmllIG1hIGRvc3TEmXBueWNoIGtpZXJ1bmvDs3cgZG8gYXRha3UnKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgbGV0IHJhbmdlID0gMTtcbiAgICBsZXQgZ29SaWdodCA9IHRydWU7XG4gICAgbGV0IGdvRG93biA9IHRydWU7XG4gICAgY29uc3QgZmluaXNoaW5nQXR0YWNrID0gKGdhbWVib2FyZCwgY29sLCByb3csIHByZXZIaXQpID0+IHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ3N0YXJ0IGZpbmlzaGluZ0F0dGFjayBwcmV2SGl0JywgcHJldkhpdCk7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdzdGFydCBmaW5pc2hpbmdBdHRhY2sgbGFzdEhpdCcsIHsgY29sLCByb3cgfSk7XG4gICAgICAgIGlmIChwcmV2SGl0LnJvdyA9PT0gcm93KSB7XG4gICAgICAgICAgICAvLyBob3Jpem9udGFsIHNoaXAgY2FzZVxuICAgICAgICAgICAgaWYgKGdvUmlnaHQpIHtcbiAgICAgICAgICAgICAgICByYW5nZSA9IDE7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2dvUmlnaHQnKTtcbiAgICAgICAgICAgICAgICBsZXQgbmV3Q29sID0gU3RyaW5nLmZyb21DaGFyQ29kZShjb2wuY2hhckNvZGVBdCgwKSArIHJhbmdlKTtcbiAgICAgICAgICAgICAgICB3aGlsZSAoZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCByb3cpICYmIGdhbWVib2FyZC5nZXRDZWxsKG5ld0NvbCwgcm93KS5zdGF0dXMgPT09ICdoaXQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NvbCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoY29sLmNoYXJDb2RlQXQoMCkgKyByYW5nZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChnYW1lYm9hcmQuZ2V0Q2VsbChuZXdDb2wsIHJvdykgJiYgZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCByb3cpLnN0YXR1cyAhPT0gJ2hpdCcgJiYgZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCByb3cpLnN0YXR1cyAhPT0gJ21pc3MnKSB7XG4gICAgICAgICAgICAgICAgICAgIGdhbWVib2FyZC5yZWNlaXZlQXR0YWNrKG5ld0NvbCwgcm93KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdhbWVib2FyZC5nZXRDZWxsKG5ld0NvbCwgcm93KS5zdGF0dXMgPT09ICdoaXQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRQcmV2SGl0KGxhc3RIaXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0TGFzdEhpdCh7IGNvbDogbmV3Q29sLCByb3c6IHJvdyB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygncHJldkhpdCcsIHByZXZIaXQpO1xuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnbGFzdEhpdCcsIGxhc3RIaXQpO1xuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygncmFuZ2UnLCByYW5nZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCctLS0tLS0tLS0tLS0tLS0nKTtcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2UgKz0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlID0gMTtcbiAgICAgICAgICAgICAgICAgICAgZ29SaWdodCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBmaW5pc2hpbmdBdHRhY2soZ2FtZWJvYXJkLCBuZXdDb2wsIHJvdywgcHJldkhpdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmFuZ2UgPSAxO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdnb0xlZnQnKTtcbiAgICAgICAgICAgICAgICBsZXQgbmV3Q29sID0gU3RyaW5nLmZyb21DaGFyQ29kZShjb2wuY2hhckNvZGVBdCgwKSAtIHJhbmdlKTtcbiAgICAgICAgICAgICAgICB3aGlsZSAoZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCByb3cpICYmIGdhbWVib2FyZC5nZXRDZWxsKG5ld0NvbCwgcm93KS5zdGF0dXMgPT09ICdoaXQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NvbCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoY29sLmNoYXJDb2RlQXQoMCkgLSByYW5nZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChnYW1lYm9hcmQuZ2V0Q2VsbChuZXdDb2wsIHJvdykgJiYgZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCByb3cpLnN0YXR1cyAhPT0gJ2hpdCcgJiYgZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCByb3cpLnN0YXR1cyAhPT0gJ21pc3MnKSB7XG4gICAgICAgICAgICAgICAgICAgIGdhbWVib2FyZC5yZWNlaXZlQXR0YWNrKG5ld0NvbCwgcm93KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdhbWVib2FyZC5nZXRDZWxsKG5ld0NvbCwgcm93KS5zdGF0dXMgPT09ICdoaXQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRQcmV2SGl0KGxhc3RIaXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0TGFzdEhpdCh7IGNvbDogbmV3Q29sLCByb3c6IHJvdyB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygncHJldkhpdCcsIHByZXZIaXQpO1xuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnbGFzdEhpdCcsIGxhc3RIaXQpO1xuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygncmFuZ2UnLCByYW5nZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCctLS0tLS0tLS0tLS0tLS0nKTtcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2UgKz0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlID0gMTtcbiAgICAgICAgICAgICAgICAgICAgZ29SaWdodCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGZpbmlzaGluZ0F0dGFjayhnYW1lYm9hcmQsIG5ld0NvbCwgcm93LCBwcmV2SGl0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocHJldkhpdC5jb2wgPT09IGNvbCkge1xuICAgICAgICAgICAgLy8gdmVydGljYWwgc2hpcCBjYXNlXG4gICAgICAgICAgICBpZiAoZ29Eb3duKSB7XG4gICAgICAgICAgICAgICAgcmFuZ2UgPSAxO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdnb0Rvd24nKTtcbiAgICAgICAgICAgICAgICBsZXQgbmV3Um93ID0gKE51bWJlcihyb3cpICsgcmFuZ2UpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGdhbWVib2FyZC5nZXRDZWxsKGNvbCwgbmV3Um93KSAmJiBnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIG5ld1Jvdykuc3RhdHVzID09PSAnaGl0Jykge1xuICAgICAgICAgICAgICAgICAgICByYW5nZSArPSAxO1xuICAgICAgICAgICAgICAgICAgICBuZXdSb3cgPSAoTnVtYmVyKHJvdykgKyByYW5nZSkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGdhbWVib2FyZC5nZXRDZWxsKGNvbCwgbmV3Um93KSAmJiBnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIG5ld1Jvdykuc3RhdHVzICE9PSAnaGl0JyAmJiBnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIG5ld1Jvdykuc3RhdHVzICE9PSAnbWlzcycpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2FtZWJvYXJkLnJlY2VpdmVBdHRhY2soY29sLCBuZXdSb3cpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ2FtZWJvYXJkLmdldENlbGwoY29sLCBuZXdSb3cpLnN0YXR1cyA9PT0gJ2hpdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFByZXZIaXQobGFzdEhpdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRMYXN0SGl0KHsgY29sOiBjb2wsIHJvdzogbmV3Um93IH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdwcmV2SGl0JywgcHJldkhpdCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdsYXN0SGl0JywgbGFzdEhpdCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdyYW5nZScsIHJhbmdlKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJy0tLS0tLS0tLS0tLS0tLScpO1xuICAgICAgICAgICAgICAgICAgICByYW5nZSArPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2UgPSAxO1xuICAgICAgICAgICAgICAgICAgICBnb0Rvd24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgZmluaXNoaW5nQXR0YWNrKGdhbWVib2FyZCwgY29sLCBuZXdSb3csIHByZXZIaXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJhbmdlID0gMTtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnZ29VcCcpO1xuICAgICAgICAgICAgICAgIGxldCBuZXdSb3cgPSAoTnVtYmVyKHJvdykgLSByYW5nZSkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB3aGlsZSAoZ2FtZWJvYXJkLmdldENlbGwoY29sLCBuZXdSb3cpICYmIGdhbWVib2FyZC5nZXRDZWxsKGNvbCwgbmV3Um93KS5zdGF0dXMgPT09ICdoaXQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIG5ld1JvdyA9IChOdW1iZXIocm93KSAtIHJhbmdlKS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZ2FtZWJvYXJkLmdldENlbGwoY29sLCBuZXdSb3cpICYmIGdhbWVib2FyZC5nZXRDZWxsKGNvbCwgbmV3Um93KS5zdGF0dXMgIT09ICdoaXQnICYmIGdhbWVib2FyZC5nZXRDZWxsKGNvbCwgbmV3Um93KS5zdGF0dXMgIT09ICdtaXNzJykge1xuICAgICAgICAgICAgICAgICAgICBnYW1lYm9hcmQucmVjZWl2ZUF0dGFjayhjb2wsIG5ld1Jvdyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIG5ld1Jvdykuc3RhdHVzID09PSAnaGl0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0UHJldkhpdChsYXN0SGl0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldExhc3RIaXQoeyBjb2w6IGNvbCwgcm93OiBuZXdSb3cgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3ByZXZIaXQnLCBwcmV2SGl0KTtcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2xhc3RIaXQnLCBsYXN0SGl0KTtcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3JhbmdlJywgcmFuZ2UpO1xuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLS0tJyk7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlICs9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByYW5nZSA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGdvRG93biA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGZpbmlzaGluZ0F0dGFjayhnYW1lYm9hcmQsIGNvbCwgbmV3Um93LCBwcmV2SGl0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IGdldFByZXZIaXQgPSAoKSA9PiB7XG4gICAgICAgIHJldHVybiBwcmV2SGl0O1xuICAgIH07XG4gICAgY29uc3QgZ2V0TGFzdEhpdCA9ICgpID0+IHtcbiAgICAgICAgcmV0dXJuIGxhc3RIaXQ7XG4gICAgfTtcbiAgICBjb25zdCBzZXRQcmV2SGl0ID0gKG5ld1ByZXZIaXQpID0+IHtcbiAgICAgICAgcHJldkhpdCA9IG5ld1ByZXZIaXQ7XG4gICAgfTtcbiAgICBjb25zdCBzZXRMYXN0SGl0ID0gKG5ld0xhc3RIaXQpID0+IHtcbiAgICAgICAgbGFzdEhpdCA9IG5ld0xhc3RIaXQ7XG4gICAgfTtcbiAgICByZXR1cm4geyBhdHRhY2ssIHJhbmRvbUF0dGFjaywgZm9sbG93dXBBdHRhY2ssIGZpbmlzaGluZ0F0dGFjaywgcHJldkhpdCwgbGFzdEhpdCwgZ2V0UHJldkhpdCwgZ2V0TGFzdEhpdCwgc2V0UHJldkhpdCwgc2V0TGFzdEhpdCB9O1xufTtcbmV4cG9ydCBkZWZhdWx0IHBsYXllckZhY3Rvcnk7XG4iLCJ2YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCBjb250cm9sbGVyIGZyb20gJy4vY29udHJvbGxlcic7XG5jb25zdCB1aSA9ICgoKSA9PiB7XG4gICAgY29uc3Qgc3RhdHVzQm94ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21lc3NhZ2VCb3ggcCcpO1xuICAgIGNvbnN0IGJvYXJkcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNib2FyZHMnKTtcbiAgICBjb25zdCBwVmNCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcGxheWVyVnNDb21wdXRlcicpO1xuICAgIGNvbnN0IG5ld0dhbWVCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbmV3R2FtZScpO1xuICAgIGNvbnN0IGNWY0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNjb21wdXRlclZzQ29tcHV0ZXInKTtcbiAgICBjb25zdCBzdGFydEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzdGFydCcpO1xuICAgIGNvbnN0IHJhbmRvbUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNyYW5kb21QbGFjZW1lbnQnKTtcbiAgICBjb25zdCBhbGxCdG5zID0gW3BWY0J0biwgbmV3R2FtZUJ0biwgY1ZjQnRuLCBzdGFydEJ0biwgcmFuZG9tQnRuXTtcbiAgICBjb25zdCBzcGVlZHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZSgnc3BlZWQnKTtcbiAgICBjb25zdCBjcmVhdGVDZWxsID0gKGNlbGwpID0+IHtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2NlbGwnKTtcbiAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKGNlbGwuc3RhdHVzKTtcbiAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtY29sJywgY2VsbC5jb2wpO1xuICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1yb3cnLCBjZWxsLnJvdyk7XG4gICAgICAgIGlmIChjZWxsLnRha2VuQnkpIHtcbiAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXNoaXBOYW1lJywgY2VsbC50YWtlbkJ5Lm5hbWUudG9Mb3dlckNhc2UoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgfTtcbiAgICBjb25zdCByZW5kZXJDZWxscyA9IChnYW1lYm9hcmQsIGJvYXJkKSA9PiB7XG4gICAgICAgIGdhbWVib2FyZC5hcnJheS5mb3JFYWNoKChyb3cpID0+IHtcbiAgICAgICAgICAgIHJvdy5mb3JFYWNoKChjb2wpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjZWxsID0gY3JlYXRlQ2VsbChjb2wpO1xuICAgICAgICAgICAgICAgIGJvYXJkLmFwcGVuZChjZWxsKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIGNvbnN0IHJlbmRlckJvYXJkID0gKGdhbWVib2FyZCkgPT4ge1xuICAgICAgICBjb25zdCBib2FyZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBib2FyZC5jbGFzc0xpc3QuYWRkKCdib2FyZCcpO1xuICAgICAgICBpZiAoZ2FtZWJvYXJkID09PSBjb250cm9sbGVyLmh1bWFuR2FtZWJvYXJkKSB7XG4gICAgICAgICAgICBib2FyZC5pZCA9ICdmaXJzdEJvYXJkJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChnYW1lYm9hcmQgPT09IGNvbnRyb2xsZXIuY29tcHV0ZXJHYW1lYm9hcmQpIHtcbiAgICAgICAgICAgIGJvYXJkLmlkID0gJ3NlY29uZEJvYXJkJztcbiAgICAgICAgfVxuICAgICAgICByZW5kZXJDZWxscyhnYW1lYm9hcmQsIGJvYXJkKTtcbiAgICAgICAgYm9hcmRzLmFwcGVuZChib2FyZCk7XG4gICAgfTtcbiAgICBjb25zdCByZWZyZXNoQm9hcmQgPSAoZ2FtZWJvYXJkKSA9PiB7XG4gICAgICAgIGxldCBib2FyZElkO1xuICAgICAgICBpZiAoZ2FtZWJvYXJkID09PSBjb250cm9sbGVyLmh1bWFuR2FtZWJvYXJkKSB7XG4gICAgICAgICAgICBib2FyZElkID0gJ2ZpcnN0Qm9hcmQnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGdhbWVib2FyZCA9PT0gY29udHJvbGxlci5jb21wdXRlckdhbWVib2FyZCkge1xuICAgICAgICAgICAgYm9hcmRJZCA9ICdzZWNvbmRCb2FyZCc7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYm9hcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtib2FyZElkfWApO1xuICAgICAgICBib2FyZC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgcmVuZGVyQ2VsbHMoZ2FtZWJvYXJkLCBib2FyZCk7XG4gICAgfTtcbiAgICBjb25zdCBnZXRVc2VySW5wdXQgPSAoZSkgPT4ge1xuICAgICAgICBpZiAoIWUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnaGl0JykgJiYgIWUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbWlzcycpKSB7XG4gICAgICAgICAgICBjb25zdCBjb2wgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtY29sJyk7XG4gICAgICAgICAgICBjb25zdCByb3cgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtcm93Jyk7XG4gICAgICAgICAgICByZXR1cm4geyBjb2wsIHJvdyB9O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBoYW5kbGVVc2VySW5wdXQgPSAoKSA9PiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgY29uc3QgY2VsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjc2Vjb25kQm9hcmQgLmNlbGwnKTtcbiAgICAgICAgbGV0IHVzZXJJbnB1dDtcbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgdXNlcklucHV0ID0geWllbGQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgICAgICAgICBjZWxscy5mb3JFYWNoKChjZWxsKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghY2VsbC5jbGFzc0xpc3QuY29udGFpbnMoJ2hpdCcpICYmICFjZWxsLmNsYXNzTGlzdC5jb250YWlucygnbWlzcycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGdldFVzZXJJbnB1dChlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCB7IG9uY2U6IHRydWUgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IHdoaWxlICghdXNlcklucHV0KTtcbiAgICAgICAgY29uc3QgY29sID0gdXNlcklucHV0LmNvbC50b1N0cmluZygpO1xuICAgICAgICBjb25zdCByb3cgPSB1c2VySW5wdXQucm93LnRvU3RyaW5nKCk7XG4gICAgICAgIHJldHVybiB7IGNvbCwgcm93IH07XG4gICAgfSk7XG4gICAgY29uc3QgaGFuZGxlUHZDID0gKCkgPT4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgIGZpbGxDZWxscygnZmlyc3QnKTtcbiAgICAgICAgd2FpdGluZyh0cnVlKTtcbiAgICAgICAgYWxsQnRucy5mb3JFYWNoKChidG4pID0+IChidG4uZGlzYWJsZWQgPSB0cnVlKSk7XG4gICAgICAgIHlpZWxkIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIGdldFNwZWVkVmFsdWUoKSkpO1xuICAgICAgICBhbGxCdG5zLmZvckVhY2goKGJ0bikgPT4gKGJ0bi5kaXNhYmxlZCA9IGZhbHNlKSk7XG4gICAgICAgIHdhaXRpbmcoZmFsc2UpO1xuICAgICAgICBjYW5CZVN0YXJ0ZWQoKTtcbiAgICAgICAgc2V0SW5pdE1lc3NhZ2UoKTtcbiAgICB9KTtcbiAgICBjb25zdCBoYW5kbGVOZXdHYW1lID0gKCkgPT4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgIHNldFJlc3RhcnRNZXNzYWdlKCk7XG4gICAgICAgIHdhaXRpbmcodHJ1ZSk7XG4gICAgICAgIGFsbEJ0bnMuZm9yRWFjaCgoYnRuKSA9PiAoYnRuLmRpc2FibGVkID0gdHJ1ZSkpO1xuICAgICAgICB5aWVsZCBjb250cm9sbGVyLm5ld0dhbWUoKTtcbiAgICAgICAgYWxsQnRucy5mb3JFYWNoKChidG4pID0+IChidG4uZGlzYWJsZWQgPSBmYWxzZSkpO1xuICAgICAgICB3YWl0aW5nKGZhbHNlKTtcbiAgICAgICAgY2FuQmVTdGFydGVkKCk7XG4gICAgICAgIGlmIChwVmNCdG4uY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpKSB7XG4gICAgICAgICAgICBzZXRJbml0TWVzc2FnZSgpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgY29uc3QgaGFuZGxlQ3ZDID0gKCkgPT4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgIHdhaXRpbmcodHJ1ZSk7XG4gICAgICAgIGFsbEJ0bnMuZm9yRWFjaCgoYnRuKSA9PiAoYnRuLmRpc2FibGVkID0gdHJ1ZSkpO1xuICAgICAgICB5aWVsZCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCBnZXRTcGVlZFZhbHVlKCkpKTtcbiAgICAgICAgYWxsQnRucy5mb3JFYWNoKChidG4pID0+IChidG4uZGlzYWJsZWQgPSBmYWxzZSkpO1xuICAgICAgICB3YWl0aW5nKGZhbHNlKTtcbiAgICAgICAgc3RhcnRCdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICByYW5kb21CdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICBjVmNCdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0pO1xuICAgIGNvbnN0IGhhbmRsZUdhbWVNb2RlID0gKHNlbGVjdGVkRWxlbWVudCwgZGVzZWxlY3RlZEVsZW1lbnQpID0+IHtcbiAgICAgICAgZGVzZWxlY3RlZEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKTtcbiAgICAgICAgaWYgKCFzZWxlY3RlZEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpKSB7XG4gICAgICAgICAgICBzZWxlY3RlZEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTtcbiAgICAgICAgICAgIGlmIChzZWxlY3RlZEVsZW1lbnQgPT09IHBWY0J0bikge1xuICAgICAgICAgICAgICAgIGhhbmRsZVB2QygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNlbGVjdGVkRWxlbWVudCA9PT0gY1ZjQnRuKSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlQ3ZDKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb250cm9sbGVyLnJlc3RhcnQoKTtcbiAgICAgICAgICAgIHNldFJlc3RhcnRNZXNzYWdlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IHdhaXRpbmcgPSAoYm9vbCkgPT4ge1xuICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LnRvZ2dsZSgnd2FpdCcsIGJvb2wpO1xuICAgIH07XG4gICAgY29uc3Qgc2V0Qm9hcmRQb2ludGVyID0gKHdoaWNoKSA9PiB7XG4gICAgICAgIGNvbnN0IHNlY29uZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzZWNvbmRCb2FyZCcpO1xuICAgICAgICBpZiAod2hpY2ggPT09ICdwbGF5ZXInKSB7XG4gICAgICAgICAgICBzZWNvbmQuY2xhc3NMaXN0LmFkZCgnYm9hcmRPdXRsaW5lJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAod2hpY2ggPT09ICdjb21wdXRlcicpIHtcbiAgICAgICAgICAgIHNlY29uZC5jbGFzc0xpc3QucmVtb3ZlKCdib2FyZE91dGxpbmUnKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3QgcmVtb3ZlQm9hcmRQb2ludGVyID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBzZWNvbmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc2Vjb25kQm9hcmQnKTtcbiAgICAgICAgc2Vjb25kLmNsYXNzTGlzdC5yZW1vdmUoJ2JvYXJkT3V0bGluZScpO1xuICAgIH07XG4gICAgY29uc3QgY3JlYXRlU2hpcE92ZXJsYXkgPSAoZ2FtZWJvYXJkTmFtZSwgc2hpcHMpID0+IHtcbiAgICAgICAgc2hpcHMuZm9yRWFjaCgoZmlyc3RDZWxsKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzaGlwRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgY29uc3Qgc2hpcE5hbWUgPSBmaXJzdENlbGwudGFrZW5CeS5uYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICBjb25zdCBzaGlwU2l6ZSA9IGZpcnN0Q2VsbC50YWtlbkJ5LnNpemU7XG4gICAgICAgICAgICBjb25zdCBpc1ZlcnRpY2FsID0gZmlyc3RDZWxsLnRha2VuQnkuaXNWZXJ0aWNhbDtcbiAgICAgICAgICAgIHNoaXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3NoaXAnLCBzaGlwTmFtZSk7XG4gICAgICAgICAgICBzaGlwRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtc2l6ZScsIGAke3NoaXBTaXplfWApO1xuICAgICAgICAgICAgc2hpcEVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLW5hbWUnLCBgJHtzaGlwTmFtZX1gKTtcbiAgICAgICAgICAgIHNoaXBFbGVtZW50LnNldEF0dHJpYnV0ZSgnZHJhZ2dhYmxlJywgJ3RydWUnKTtcbiAgICAgICAgICAgIHNoaXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2RyYWdnYWJsZScpO1xuICAgICAgICAgICAgY29uc3Qgc2V0U2hpcFN0eWxlID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGh0bWxFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaHRtbCcpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJvb3RGb250U2l6ZSA9IHBhcnNlRmxvYXQod2luZG93LmdldENvbXB1dGVkU3R5bGUoaHRtbEVsZW1lbnQsIG51bGwpLmdldFByb3BlcnR5VmFsdWUoJ2ZvbnQtc2l6ZScpKTtcbiAgICAgICAgICAgICAgICBpZiAoIWlzVmVydGljYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgc2hpcEVsZW1lbnQuc3R5bGUud2lkdGggPSBzaGlwU2l6ZSAqIChjZWxsU2l6ZSAvIHJvb3RGb250U2l6ZSkgKyAncmVtJztcbiAgICAgICAgICAgICAgICAgICAgc2hpcEVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gY2VsbFNpemUgLyByb290Rm9udFNpemUgKyAncmVtJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoaXNWZXJ0aWNhbCkge1xuICAgICAgICAgICAgICAgICAgICBzaGlwRWxlbWVudC5zdHlsZS53aWR0aCA9IGNlbGxTaXplIC8gcm9vdEZvbnRTaXplICsgJ3JlbSc7XG4gICAgICAgICAgICAgICAgICAgIHNoaXBFbGVtZW50LnN0eWxlLmhlaWdodCA9IHNoaXBTaXplICogKGNlbGxTaXplIC8gcm9vdEZvbnRTaXplKSArICdyZW0nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBsZXQgY2VsbFNpemUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYm9hcmQgLmNlbGwnKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aDtcbiAgICAgICAgICAgIHNldFNoaXBTdHlsZSgpO1xuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBjZWxsU2l6ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ib2FyZCAuY2VsbCcpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoO1xuICAgICAgICAgICAgICAgIHNldFNoaXBTdHlsZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBsZXQgYm9hcmQ7XG4gICAgICAgICAgICBpZiAoZ2FtZWJvYXJkTmFtZSA9PT0gJ2ZpcnN0Jykge1xuICAgICAgICAgICAgICAgIGJvYXJkID0gJ2ZpcnN0Qm9hcmQnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZ2FtZWJvYXJkTmFtZSA9PT0gJ3NlY29uZCcpIHtcbiAgICAgICAgICAgICAgICBib2FyZCA9ICdzZWNvbmRCb2FyZCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBmaXJzdENlbGxFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7Ym9hcmR9IC5jZWxsW2RhdGEtY29sPVwiJHtmaXJzdENlbGwuY29sfVwiXVtkYXRhLXJvdz1cIiR7Zmlyc3RDZWxsLnJvd31cIl1gKTtcbiAgICAgICAgICAgIGZpcnN0Q2VsbEVsZW1lbnQuYXBwZW5kQ2hpbGQoc2hpcEVsZW1lbnQpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIGNvbnN0IGNhbkJlU3RhcnRlZCA9ICgpID0+IHtcbiAgICAgICAgaWYgKGNvbnRyb2xsZXIuaHVtYW5HYW1lYm9hcmQuc2hpcHNQbGFjZWQubGVuZ3RoID09PSA1ICYmIGNvbnRyb2xsZXIuY29tcHV0ZXJHYW1lYm9hcmQuc2hpcHNQbGFjZWQubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBmaWxsQ2VsbHMoJ3NlY29uZCcpO1xuICAgICAgICAgICAgc3RhcnRCdG4uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc3RhcnRCdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBzZXRJbml0TWVzc2FnZSA9ICgpID0+IHtcbiAgICAgICAgc3RhdHVzQm94LnRleHRDb250ZW50ID0gXCJVc2UgJ1JhbmRvbSBQbGFjZW1lbnQnIGJ1dHRvbiwgdGhlbiBwcmVzcyBTdGFydCFcIjtcbiAgICAgICAgaWYgKHdpbmRvdy5tYXRjaE1lZGlhKCcobWluLXdpZHRoOiAxMDI0cHgpJykubWF0Y2hlcykge1xuICAgICAgICAgICAgc3RhdHVzQm94LnRleHRDb250ZW50ID0gXCJEcmFnIGFuZCBkcm9wIHNoaXBzIG9udG8gdGhlIGxlZnQgYm9hcmQgb3IgdXNlICdSYW5kb20gUGxhY2VtZW50JyBidXR0b24uIFJpZ2h0IGNsaWNrIHRvIHJvdGF0ZS4gV2hlbiByZWFkeSwgcHJlc3MgU3RhcnQhXCI7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IHNldFN0YXJ0TWVzc2FnZSA9ICgpID0+IHtcbiAgICAgICAgaWYgKGNhbkJlU3RhcnRlZCgpKSB7XG4gICAgICAgICAgICBzdGF0dXNCb3gudGV4dENvbnRlbnQgPSAnWW91IGNhbiBub3cgYmVnaW4gdGhlIGdhbWUuIFByZXNzIHN0YXJ0ISc7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IHNldFR1cm5NZXNzYWdlUHZDID0gKGlzUGxheWVyVHVybikgPT4ge1xuICAgICAgICBpZiAoaXNQbGF5ZXJUdXJuKSB7XG4gICAgICAgICAgICBzdGF0dXNCb3gudGV4dENvbnRlbnQgPSBcIlBsYXllcidzIHR1cm4uIFRha2UgYWltIGFuZCBhdHRhY2shXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzdGF0dXNCb3gudGV4dENvbnRlbnQgPSBcIkNvbXB1dGVyJ3MgdHVybi4gVGhlIHNob3QgaXMgY29taW5nIVwiO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBzZXRUdXJuTWVzc2FnZUN2QyA9IChpc1BsYXllclR1cm4pID0+IHtcbiAgICAgICAgaWYgKGlzUGxheWVyVHVybikge1xuICAgICAgICAgICAgc3RhdHVzQm94LnRleHRDb250ZW50ID0gXCJWaW9sZXQncyB0dXJuXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzdGF0dXNCb3gudGV4dENvbnRlbnQgPSBcIkJsdWUncyB0dXJuXCI7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IHNldEdhbWVPdmVyTWVzc2FnZVB2QyA9ICh3aG8pID0+IHtcbiAgICAgICAgaWYgKHdobyA9PT0gJ3BsYXllcicpIHtcbiAgICAgICAgICAgIHN0YXR1c0JveC50ZXh0Q29udGVudCA9ICdHYW1lIG92ZXIsIFBsYXllciB3aW5zISc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAod2hvID09PSAnY29tcHV0ZXInKSB7XG4gICAgICAgICAgICBzdGF0dXNCb3gudGV4dENvbnRlbnQgPSAnR2FtZSBvdmVyLCBDb21wdXRlciB3aW5zISc7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IHNldEdhbWVPdmVyTWVzc2FnZUN2QyA9ICh3aG8pID0+IHtcbiAgICAgICAgaWYgKHdobyA9PT0gJ3BsYXllcicpIHtcbiAgICAgICAgICAgIHN0YXR1c0JveC50ZXh0Q29udGVudCA9ICdHYW1lIG92ZXIsIEJsdWUgQ29tcHV0ZXIgd2lucyEnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHdobyA9PT0gJ2NvbXB1dGVyJykge1xuICAgICAgICAgICAgc3RhdHVzQm94LnRleHRDb250ZW50ID0gJ0dhbWUgb3ZlciwgVmlvbGV0IENvbXB1dGVyIHdpbnMhJztcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3Qgc2V0UmVzdGFydE1lc3NhZ2UgPSAoKSA9PiB7XG4gICAgICAgIHN0YXR1c0JveC50ZXh0Q29udGVudCA9ICdSZXN0YXJ0aW5nLi4uJztcbiAgICB9O1xuICAgIGNvbnN0IGRyYWdBbmREcm9wID0gKGZpcnN0R2FtZWJvYXJkLCBzZWNvbmRHYW1lYm9hcmQsIHNoaXBzKSA9PiB7XG4gICAgICAgIGxldCBzaGlwTmFtZTtcbiAgICAgICAgbGV0IHNoaXBTaXplO1xuICAgICAgICBsZXQgZ3JhYlBvaW50WCA9IDA7XG4gICAgICAgIGxldCBncmFiUG9pbnRZID0gMDtcbiAgICAgICAgbGV0IHNoaXBPYmo7XG4gICAgICAgIGxldCBvcmllbnRhdGlvbjtcbiAgICAgICAgbGV0IGhpZ2hsaWdodGVkQ2VsbHMgPSBbXTtcbiAgICAgICAgY29uc3Qgc2hpcE5hbWVUb09iaiA9IHtcbiAgICAgICAgICAgIGNhcnJpZXI6IHNoaXBzWzBdLFxuICAgICAgICAgICAgYmF0dGxlc2hpcDogc2hpcHNbMV0sXG4gICAgICAgICAgICBkZXN0cm95ZXI6IHNoaXBzWzJdLFxuICAgICAgICAgICAgc3VibWFyaW5lOiBzaGlwc1szXSxcbiAgICAgICAgICAgIHBhdHJvbGJvYXQ6IHNoaXBzWzRdLFxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBmaXJzdEJvYXJkRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNmaXJzdEJvYXJkJyk7XG4gICAgICAgIGNvbnN0IHNlY29uZEJvYXJkRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzZWNvbmRCb2FyZCcpO1xuICAgICAgICBjb25zdCBmaXJzdEJvYXJkQ2VsbHMgPSBmaXJzdEJvYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2VsbCcpO1xuICAgICAgICBjb25zdCBzZWNvbmRCb2FyZENlbGxzID0gc2Vjb25kQm9hcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jZWxsJyk7XG4gICAgICAgIGNvbnN0IG5vblNoaXBDZWxscyA9IFtdO1xuICAgICAgICBmb3IgKGxldCBjZWxsIG9mIGZpcnN0Qm9hcmRDZWxscykge1xuICAgICAgICAgICAgaWYgKCFjZWxsLmNsYXNzTGlzdC5jb250YWlucygndGFrZW4nKSkge1xuICAgICAgICAgICAgICAgIG5vblNoaXBDZWxscy5wdXNoKGNlbGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGNlbGwgb2Ygc2Vjb25kQm9hcmRDZWxscykge1xuICAgICAgICAgICAgaWYgKCFjZWxsLmNsYXNzTGlzdC5jb250YWlucygndGFrZW4nKSkge1xuICAgICAgICAgICAgICAgIG5vblNoaXBDZWxscy5wdXNoKGNlbGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRyYWdnYWJsZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZHJhZ2dhYmxlJyk7XG4gICAgICAgIGRyYWdnYWJsZXMuZm9yRWFjaCgoZHJhZ2dhYmxlKSA9PiB7XG4gICAgICAgICAgICBkcmFnZ2FibGUuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgaGFuZGxlTW91c2Vkb3duKTtcbiAgICAgICAgICAgIGRyYWdnYWJsZS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgaGFuZGxlTW91c2V1cCk7XG4gICAgICAgICAgICBkcmFnZ2FibGUuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ3N0YXJ0JywgaGFuZGxlRHJhZ1N0YXJ0KTtcbiAgICAgICAgICAgIGRyYWdnYWJsZS5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW5kJywgaGFuZGxlRHJhZ0VuZCk7XG4gICAgICAgICAgICBkcmFnZ2FibGUuYWRkRXZlbnRMaXN0ZW5lcignY29udGV4dG1lbnUnLCBoYW5kbGVSb3RhdGUpO1xuICAgICAgICAgICAgbm9uU2hpcENlbGxzLmZvckVhY2goKGNlbGwpID0+IHtcbiAgICAgICAgICAgICAgICBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2NvbnRleHRtZW51JywgYmxvY2tSaWdodENsaWNrKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgbGV0IGxhc3REcmFnZ2VkID0gbnVsbDtcbiAgICAgICAgZnVuY3Rpb24gaGFuZGxlTW91c2Vkb3duKGUpIHtcbiAgICAgICAgICAgIGZpcnN0R2FtZWJvYXJkLnJlbW92ZVJlc2VydmVkU3BhY2UoZmlyc3RHYW1lYm9hcmQpO1xuICAgICAgICAgICAgc2Vjb25kR2FtZWJvYXJkLnJlbW92ZVJlc2VydmVkU3BhY2Uoc2Vjb25kR2FtZWJvYXJkKTtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldFNoaXBOYW1lID0gZS50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLW5hbWUnKTtcbiAgICAgICAgICAgIGxldCB1cGRhdGVkU2hpcHNQbGFjZWRGaXJzdCA9IGZpcnN0R2FtZWJvYXJkLnNoaXBzUGxhY2VkLmZpbHRlcigoc2hpcCkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRTaGlwTmFtZSAhPT0gc2hpcC50YWtlbkJ5Lm5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbGV0IHVwZGF0ZWRTaGlwc1BsYWNlZFRlbXAgPSBzZWNvbmRHYW1lYm9hcmQuc2hpcHNQbGFjZWQuZmlsdGVyKChzaGlwKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldFNoaXBOYW1lICE9PSBzaGlwLnRha2VuQnkubmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB1cGRhdGVkU2hpcHNQbGFjZWRGaXJzdC5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgICAgICAgICAgICAgZmlyc3RHYW1lYm9hcmQucmVzZXJ2ZVNwYWNlKGZpcnN0R2FtZWJvYXJkLCBzaGlwLmNvbCwgc2hpcC5yb3cpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB1cGRhdGVkU2hpcHNQbGFjZWRUZW1wLmZvckVhY2goKHNoaXApID0+IHtcbiAgICAgICAgICAgICAgICBzZWNvbmRHYW1lYm9hcmQucmVzZXJ2ZVNwYWNlKHNlY29uZEdhbWVib2FyZCwgc2hpcC5jb2wsIHNoaXAucm93KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmVmcmVzaEJvYXJkKGZpcnN0R2FtZWJvYXJkKTtcbiAgICAgICAgICAgIHJlZnJlc2hCb2FyZChzZWNvbmRHYW1lYm9hcmQpO1xuICAgICAgICAgICAgY3JlYXRlU2hpcE92ZXJsYXkoJ2ZpcnN0JywgZmlyc3RHYW1lYm9hcmQuc2hpcHNQbGFjZWQpO1xuICAgICAgICAgICAgY3JlYXRlU2hpcE92ZXJsYXkoJ3NlY29uZCcsIHNlY29uZEdhbWVib2FyZC5zaGlwc1BsYWNlZCk7XG4gICAgICAgICAgICBkcmFnQW5kRHJvcChmaXJzdEdhbWVib2FyZCwgc2Vjb25kR2FtZWJvYXJkLCBjb250cm9sbGVyLmh1bWFuU2hpcHMpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGhhbmRsZU1vdXNldXAoKSB7XG4gICAgICAgICAgICBmaXJzdEdhbWVib2FyZC5zaGlwc1BsYWNlZC5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgICAgICAgICAgICAgZmlyc3RHYW1lYm9hcmQucmVzZXJ2ZVNwYWNlKGZpcnN0R2FtZWJvYXJkLCBzaGlwLmNvbCwgc2hpcC5yb3cpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzZWNvbmRHYW1lYm9hcmQuc2hpcHNQbGFjZWQuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgICAgICAgICAgICAgIHNlY29uZEdhbWVib2FyZC5yZXNlcnZlU3BhY2Uoc2Vjb25kR2FtZWJvYXJkLCBzaGlwLmNvbCwgc2hpcC5yb3cpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZWZyZXNoQm9hcmQoZmlyc3RHYW1lYm9hcmQpO1xuICAgICAgICAgICAgcmVmcmVzaEJvYXJkKHNlY29uZEdhbWVib2FyZCk7XG4gICAgICAgICAgICBjcmVhdGVTaGlwT3ZlcmxheSgnZmlyc3QnLCBmaXJzdEdhbWVib2FyZC5zaGlwc1BsYWNlZCk7XG4gICAgICAgICAgICBjcmVhdGVTaGlwT3ZlcmxheSgnc2Vjb25kJywgc2Vjb25kR2FtZWJvYXJkLnNoaXBzUGxhY2VkKTtcbiAgICAgICAgICAgIGRyYWdBbmREcm9wKGZpcnN0R2FtZWJvYXJkLCBzZWNvbmRHYW1lYm9hcmQsIGNvbnRyb2xsZXIuaHVtYW5TaGlwcyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gaGFuZGxlRHJhZ1N0YXJ0KGUpIHtcbiAgICAgICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICAgICAgeWllbGQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMCkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgICAgICAgICAgIHRhcmdldC5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XG4gICAgICAgICAgICAgICAgdGhpcy5jbGFzc0xpc3QuYWRkKCdkcmFnZ2luZycpO1xuICAgICAgICAgICAgICAgIHNoaXBOYW1lID0gdGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1uYW1lJyk7XG4gICAgICAgICAgICAgICAgc2hpcFNpemUgPSBOdW1iZXIodGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1zaXplJykpO1xuICAgICAgICAgICAgICAgIGdyYWJQb2ludFggPSBlLm9mZnNldFg7XG4gICAgICAgICAgICAgICAgZ3JhYlBvaW50WSA9IGUub2Zmc2V0WTtcbiAgICAgICAgICAgICAgICBzaGlwT2JqID0gc2hpcE5hbWVUb09ialtzaGlwTmFtZV07XG4gICAgICAgICAgICAgICAgb3JpZW50YXRpb24gPSBzaGlwT2JqLmlzVmVydGljYWwgPyAndmVydGljYWwnIDogJ2hvcml6b250YWwnO1xuICAgICAgICAgICAgICAgIGlmICh0YXJnZXQuY2xvc2VzdCgnLmJvYXJkJykuaWQgPT09ICdmaXJzdEJvYXJkJykge1xuICAgICAgICAgICAgICAgICAgICBmaXJzdEdhbWVib2FyZC5yZW1vdmVTaGlwKHNoaXBPYmosIGZpcnN0R2FtZWJvYXJkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRhcmdldC5jbG9zZXN0KCcuYm9hcmQnKS5pZCA9PT0gJ3NlY29uZEJvYXJkJykge1xuICAgICAgICAgICAgICAgICAgICBzZWNvbmRHYW1lYm9hcmQucmVtb3ZlU2hpcChzaGlwT2JqLCBzZWNvbmRHYW1lYm9hcmQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGhhbmRsZURyYWdPdmVyKGluZGV4KSB7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0LmNsb3Nlc3QoJy5ib2FyZCcpLmlkID09PSAnZmlyc3RCb2FyZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2hpcE9iaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0Q2VsbCA9IGluZGV4IC0gKHNoaXBPYmouaXNWZXJ0aWNhbCA/IE1hdGguZmxvb3IoZ3JhYlBvaW50WSAvIHRoaXMub2Zmc2V0SGVpZ2h0KSAqIDEwIDogTWF0aC5mbG9vcihncmFiUG9pbnRYIC8gdGhpcy5vZmZzZXRXaWR0aCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdG9IaWdobGlnaHQgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcFNpemU7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjZWxsSW5kZXggPSBzaGlwT2JqLmlzVmVydGljYWwgPyBzdGFydENlbGwgKyBpICogMTAgOiBzdGFydENlbGwgKyBpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaXJzdEJvYXJkQ2VsbHNbY2VsbEluZGV4XSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b0hpZ2hsaWdodC5wdXNoKGZpcnN0Qm9hcmRDZWxsc1tjZWxsSW5kZXhdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0ZWRDZWxscy5wdXNoKGZpcnN0Qm9hcmRDZWxsc1tjZWxsSW5kZXhdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNWYWxpZFBsYWNlbWVudCh0b0hpZ2hsaWdodCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b0hpZ2hsaWdodC5mb3JFYWNoKChjZWxsKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnaGlnaGxpZ2h0Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFsYXN0RHJhZ2dlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0RHJhZ2dlZCA9IGdldExhc3RTaGlwU2l6ZUVsZW1lbnRzKGhpZ2hsaWdodGVkQ2VsbHMsIHNoaXBTaXplKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFx0Y29uc29sZS5sb2coJ3NoaXAgaXMgb24gdGhlIGVkZ2UnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0LmNsb3Nlc3QoJy5ib2FyZCcpLmlkID09PSAnc2Vjb25kQm9hcmQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNoaXBPYmopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzdGFydENlbGwgPSBpbmRleCAtIChzaGlwT2JqLmlzVmVydGljYWwgPyBNYXRoLmZsb29yKGdyYWJQb2ludFkgLyB0aGlzLm9mZnNldEhlaWdodCkgKiAxMCA6IE1hdGguZmxvb3IoZ3JhYlBvaW50WCAvIHRoaXMub2Zmc2V0V2lkdGgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRvSGlnaGxpZ2h0ID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXBTaXplOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY2VsbEluZGV4ID0gc2hpcE9iai5pc1ZlcnRpY2FsID8gc3RhcnRDZWxsICsgaSAqIDEwIDogc3RhcnRDZWxsICsgaTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2Vjb25kQm9hcmRDZWxsc1tjZWxsSW5kZXhdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvSGlnaGxpZ2h0LnB1c2goc2Vjb25kQm9hcmRDZWxsc1tjZWxsSW5kZXhdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0ZWRDZWxscy5wdXNoKHNlY29uZEJvYXJkQ2VsbHNbY2VsbEluZGV4XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzVmFsaWRQbGFjZW1lbnQodG9IaWdobGlnaHQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9IaWdobGlnaHQuZm9yRWFjaCgoY2VsbCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoJ2hpZ2hsaWdodCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbGFzdERyYWdnZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdERyYWdnZWQgPSBnZXRMYXN0U2hpcFNpemVFbGVtZW50cyhoaWdobGlnaHRlZENlbGxzLCBzaGlwU2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBcdGNvbnNvbGUubG9nKCdzaGlwIGlzIG9uIHRoZSBlZGdlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGhhbmRsZURyYWdMZWF2ZSgpIHtcbiAgICAgICAgICAgIGhpZ2hsaWdodGVkQ2VsbHMuZm9yRWFjaCgoaGlnaGxpZ2h0ZWRDZWxsKSA9PiB7XG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0ZWRDZWxsLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZ2hsaWdodCcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBoaWdobGlnaHRlZENlbGxzID0gW107XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gaGFuZGxlRHJvcChlKSB7XG4gICAgICAgICAgICBoaWdobGlnaHRlZENlbGxzLmZvckVhY2goKGhpZ2hsaWdodGVkQ2VsbCkgPT4ge1xuICAgICAgICAgICAgICAgIGhpZ2hsaWdodGVkQ2VsbC5jbGFzc0xpc3QucmVtb3ZlKCdoaWdobGlnaHQnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3QgbGFzdCA9IGdldExhc3RTaGlwU2l6ZUVsZW1lbnRzKGhpZ2hsaWdodGVkQ2VsbHMsIHNoaXBTaXplKTtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgICAgICAgaWYgKHRhcmdldC5jbG9zZXN0KCcuYm9hcmQnKS5pZCA9PT0gJ2ZpcnN0Qm9hcmQnKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNoaXBPYmogJiYgbGFzdERyYWdnZWQgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpcnN0R2FtZWJvYXJkLmNhbkJlUGxhY2VkKHNoaXBPYmouc2l6ZSwgbGFzdFswXS5kYXRhc2V0LmNvbCwgbGFzdFswXS5kYXRhc2V0LnJvdywgb3JpZW50YXRpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaXJzdEdhbWVib2FyZC5wbGFjZVNoaXAoc2hpcE9iaiwgbGFzdFswXS5kYXRhc2V0LmNvbCwgbGFzdFswXS5kYXRhc2V0LnJvdywgb3JpZW50YXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RHYW1lYm9hcmQucmVzZXJ2ZVNwYWNlKGZpcnN0R2FtZWJvYXJkLCBsYXN0WzBdLmRhdGFzZXQuY29sLCBsYXN0WzBdLmRhdGFzZXQucm93KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0R2FtZWJvYXJkLnBsYWNlU2hpcChzaGlwT2JqLCBsYXN0RHJhZ2dlZFswXS5kYXRhc2V0LmNvbCwgbGFzdERyYWdnZWRbMF0uZGF0YXNldC5yb3csIG9yaWVudGF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0R2FtZWJvYXJkLnJlc2VydmVTcGFjZShmaXJzdEdhbWVib2FyZCwgbGFzdERyYWdnZWRbMF0uZGF0YXNldC5jb2wsIGxhc3REcmFnZ2VkWzBdLmRhdGFzZXQucm93KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0YXJnZXQuY2xvc2VzdCgnLmJvYXJkJykuaWQgPT09ICdzZWNvbmRCb2FyZCcpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2hpcE9iaiAmJiBsYXN0RHJhZ2dlZCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2Vjb25kR2FtZWJvYXJkLmNhbkJlUGxhY2VkKHNoaXBPYmouc2l6ZSwgbGFzdFswXS5kYXRhc2V0LmNvbCwgbGFzdFswXS5kYXRhc2V0LnJvdywgb3JpZW50YXRpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmRHYW1lYm9hcmQucGxhY2VTaGlwKHNoaXBPYmosIGxhc3RbMF0uZGF0YXNldC5jb2wsIGxhc3RbMF0uZGF0YXNldC5yb3csIG9yaWVudGF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZEdhbWVib2FyZC5yZXNlcnZlU3BhY2Uoc2Vjb25kR2FtZWJvYXJkLCBsYXN0WzBdLmRhdGFzZXQuY29sLCBsYXN0WzBdLmRhdGFzZXQucm93KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZEdhbWVib2FyZC5wbGFjZVNoaXAoc2hpcE9iaiwgbGFzdERyYWdnZWRbMF0uZGF0YXNldC5jb2wsIGxhc3REcmFnZ2VkWzBdLmRhdGFzZXQucm93LCBvcmllbnRhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmRHYW1lYm9hcmQucmVzZXJ2ZVNwYWNlKHNlY29uZEdhbWVib2FyZCwgbGFzdERyYWdnZWRbMF0uZGF0YXNldC5jb2wsIGxhc3REcmFnZ2VkWzBdLmRhdGFzZXQucm93KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpcnN0R2FtZWJvYXJkLnJlbW92ZVJlc2VydmVkU3BhY2UoZmlyc3RHYW1lYm9hcmQpO1xuICAgICAgICAgICAgc2Vjb25kR2FtZWJvYXJkLnJlbW92ZVJlc2VydmVkU3BhY2Uoc2Vjb25kR2FtZWJvYXJkKTtcbiAgICAgICAgICAgIGZpcnN0R2FtZWJvYXJkLnNoaXBzUGxhY2VkLmZvckVhY2goKHNoaXApID0+IHtcbiAgICAgICAgICAgICAgICBmaXJzdEdhbWVib2FyZC5yZXNlcnZlU3BhY2UoZmlyc3RHYW1lYm9hcmQsIHNoaXAuY29sLCBzaGlwLnJvdyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHNlY29uZEdhbWVib2FyZC5zaGlwc1BsYWNlZC5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgICAgICAgICAgICAgc2Vjb25kR2FtZWJvYXJkLnJlc2VydmVTcGFjZShzZWNvbmRHYW1lYm9hcmQsIHNoaXAuY29sLCBzaGlwLnJvdyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJlZnJlc2hCb2FyZChmaXJzdEdhbWVib2FyZCk7XG4gICAgICAgICAgICByZWZyZXNoQm9hcmQoc2Vjb25kR2FtZWJvYXJkKTtcbiAgICAgICAgICAgIGNyZWF0ZVNoaXBPdmVybGF5KCdmaXJzdCcsIGZpcnN0R2FtZWJvYXJkLnNoaXBzUGxhY2VkKTtcbiAgICAgICAgICAgIGNyZWF0ZVNoaXBPdmVybGF5KCdzZWNvbmQnLCBzZWNvbmRHYW1lYm9hcmQuc2hpcHNQbGFjZWQpO1xuICAgICAgICAgICAgZHJhZ0FuZERyb3AoZmlyc3RHYW1lYm9hcmQsIHNlY29uZEdhbWVib2FyZCwgY29udHJvbGxlci5odW1hblNoaXBzKTtcbiAgICAgICAgICAgIGNhbkJlU3RhcnRlZCgpO1xuICAgICAgICAgICAgc2V0U3RhcnRNZXNzYWdlKCk7XG4gICAgICAgICAgICBsYXN0RHJhZ2dlZCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gaGFuZGxlRHJhZ0VuZChlKSB7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICAgICAgICAgIHRhcmdldC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnO1xuICAgICAgICAgICAgdGhpcy5jbGFzc0xpc3QucmVtb3ZlKCdkcmFnZ2luZycpO1xuICAgICAgICAgICAgaWYgKGhpZ2hsaWdodGVkQ2VsbHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRhcmdldC5jbG9zZXN0KCcuYm9hcmQnKS5pZCA9PT0gJ2ZpcnN0Qm9hcmQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsYXN0RHJhZ2dlZCAmJiBmaXJzdEdhbWVib2FyZC5jYW5CZVBsYWNlZChzaGlwT2JqLnNpemUsIGxhc3REcmFnZ2VkWzBdLmRhdGFzZXQuY29sLCBsYXN0RHJhZ2dlZFswXS5kYXRhc2V0LnJvdywgb3JpZW50YXRpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaXJzdEdhbWVib2FyZC5wbGFjZVNoaXAoc2hpcE9iaiwgbGFzdERyYWdnZWRbMF0uZGF0YXNldC5jb2wsIGxhc3REcmFnZ2VkWzBdLmRhdGFzZXQucm93LCBvcmllbnRhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaXJzdEdhbWVib2FyZC5yZXNlcnZlU3BhY2UoZmlyc3RHYW1lYm9hcmQsIGxhc3REcmFnZ2VkWzBdLmRhdGFzZXQuY29sLCBsYXN0RHJhZ2dlZFswXS5kYXRhc2V0LnJvdyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWZyZXNoQm9hcmQoZmlyc3RHYW1lYm9hcmQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVmcmVzaEJvYXJkKHNlY29uZEdhbWVib2FyZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVTaGlwT3ZlcmxheSgnZmlyc3QnLCBmaXJzdEdhbWVib2FyZC5zaGlwc1BsYWNlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVTaGlwT3ZlcmxheSgnc2Vjb25kJywgc2Vjb25kR2FtZWJvYXJkLnNoaXBzUGxhY2VkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyYWdBbmREcm9wKGZpcnN0R2FtZWJvYXJkLCBzZWNvbmRHYW1lYm9hcmQsIGNvbnRyb2xsZXIuaHVtYW5TaGlwcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodGFyZ2V0LmNsb3Nlc3QoJy5ib2FyZCcpLmlkID09PSAnc2Vjb25kQm9hcmQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsYXN0RHJhZ2dlZCAmJiBzZWNvbmRHYW1lYm9hcmQuY2FuQmVQbGFjZWQoc2hpcE9iai5zaXplLCBsYXN0RHJhZ2dlZFswXS5kYXRhc2V0LmNvbCwgbGFzdERyYWdnZWRbMF0uZGF0YXNldC5yb3csIG9yaWVudGF0aW9uKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Vjb25kR2FtZWJvYXJkLnBsYWNlU2hpcChzaGlwT2JqLCBsYXN0RHJhZ2dlZFswXS5kYXRhc2V0LmNvbCwgbGFzdERyYWdnZWRbMF0uZGF0YXNldC5yb3csIG9yaWVudGF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZEdhbWVib2FyZC5yZXNlcnZlU3BhY2Uoc2Vjb25kR2FtZWJvYXJkLCBsYXN0RHJhZ2dlZFswXS5kYXRhc2V0LmNvbCwgbGFzdERyYWdnZWRbMF0uZGF0YXNldC5yb3cpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVmcmVzaEJvYXJkKGZpcnN0R2FtZWJvYXJkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2hCb2FyZChzZWNvbmRHYW1lYm9hcmQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlU2hpcE92ZXJsYXkoJ2ZpcnN0JywgZmlyc3RHYW1lYm9hcmQuc2hpcHNQbGFjZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlU2hpcE92ZXJsYXkoJ3NlY29uZCcsIHNlY29uZEdhbWVib2FyZC5zaGlwc1BsYWNlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkcmFnQW5kRHJvcChmaXJzdEdhbWVib2FyZCwgc2Vjb25kR2FtZWJvYXJkLCBjb250cm9sbGVyLmh1bWFuU2hpcHMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGlzVmFsaWRQbGFjZW1lbnQodG9IaWdobGlnaHQpIHtcbiAgICAgICAgICAgIHJldHVybiAodG9IaWdobGlnaHQuZXZlcnkoKGNlbGwpID0+IGNlbGwuY2xhc3NMaXN0LmNvbnRhaW5zKCdlbXB0eScpKSAmJlxuICAgICAgICAgICAgICAgICh0b0hpZ2hsaWdodC5ldmVyeSgoY2VsbCkgPT4gY2VsbC5kYXRhc2V0LmNvbCA9PT0gdG9IaWdobGlnaHRbMF0uZGF0YXNldC5jb2wpIHx8XG4gICAgICAgICAgICAgICAgICAgIHRvSGlnaGxpZ2h0LmV2ZXJ5KChjZWxsKSA9PiBjZWxsLmRhdGFzZXQucm93ID09PSB0b0hpZ2hsaWdodFswXS5kYXRhc2V0LnJvdykpICYmXG4gICAgICAgICAgICAgICAgdG9IaWdobGlnaHQubGVuZ3RoID09PSBzaGlwU2l6ZSAmJlxuICAgICAgICAgICAgICAgIHRvSGlnaGxpZ2h0LmV2ZXJ5KChjZWxsKSA9PiBjZWxsLmRhdGFzZXQuY29sID49ICdBJyAmJiBjZWxsLmRhdGFzZXQuY29sIDw9ICdKJykgJiZcbiAgICAgICAgICAgICAgICB0b0hpZ2hsaWdodC5ldmVyeSgoY2VsbCkgPT4gTnVtYmVyKGNlbGwuZGF0YXNldC5yb3cpID49IDEgJiYgTnVtYmVyKGNlbGwuZGF0YXNldC5yb3cpIDw9IDEwKSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gZ2V0TGFzdFNoaXBTaXplRWxlbWVudHMoaGlnaGxpZ2h0ZWRDZWxscywgc2hpcFNpemUpIHtcbiAgICAgICAgICAgIHJldHVybiBoaWdobGlnaHRlZENlbGxzLnNsaWNlKE1hdGgubWluKGhpZ2hsaWdodGVkQ2VsbHMubGVuZ3RoIC0gc2hpcFNpemUsIDApKTtcbiAgICAgICAgfVxuICAgICAgICBmaXJzdEJvYXJkQ2VsbHMuZm9yRWFjaCgoY2VsbCwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNlbGwuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLCBoYW5kbGVEcmFnT3ZlcihpbmRleCkpO1xuICAgICAgICAgICAgY2VsbC5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCBoYW5kbGVEcmFnTGVhdmUpO1xuICAgICAgICAgICAgY2VsbC5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgaGFuZGxlRHJvcCk7XG4gICAgICAgIH0pO1xuICAgICAgICBzZWNvbmRCb2FyZENlbGxzLmZvckVhY2goKGNlbGwsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdvdmVyJywgaGFuZGxlRHJhZ092ZXIoaW5kZXgpKTtcbiAgICAgICAgICAgIGNlbGwuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2xlYXZlJywgaGFuZGxlRHJhZ0xlYXZlKTtcbiAgICAgICAgICAgIGNlbGwuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIGhhbmRsZURyb3ApO1xuICAgICAgICB9KTtcbiAgICAgICAgZnVuY3Rpb24gaGFuZGxlUm90YXRlKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgICAgICAgbGV0IGdhbWVib2FyZDtcbiAgICAgICAgICAgIGlmICh0YXJnZXQuY2xvc2VzdCgnLmJvYXJkJykuaWQgPT09ICdmaXJzdEJvYXJkJykge1xuICAgICAgICAgICAgICAgIGdhbWVib2FyZCA9IGZpcnN0R2FtZWJvYXJkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRhcmdldC5jbG9zZXN0KCcuYm9hcmQnKS5pZCA9PT0gJ3NlY29uZEJvYXJkJykge1xuICAgICAgICAgICAgICAgIGdhbWVib2FyZCA9IHNlY29uZEdhbWVib2FyZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNoaXBOYW1lID0gdGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1uYW1lJyk7XG4gICAgICAgICAgICBzaGlwU2l6ZSA9IE51bWJlcih0YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLXNpemUnKSk7XG4gICAgICAgICAgICBzaGlwT2JqID0gc2hpcE5hbWVUb09ialtzaGlwTmFtZV07XG4gICAgICAgICAgICBjb25zdCB0ZW1wU2hpcCA9IHNoaXBPYmo7XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50ID0gZ2FtZWJvYXJkLnNoaXBzUGxhY2VkLmZpbHRlcigoc2hpcCkgPT4gc2hpcC50YWtlbkJ5Lm5hbWUudG9Mb3dlckNhc2UoKSA9PT0gc2hpcE5hbWUpO1xuICAgICAgICAgICAgZ2FtZWJvYXJkLnJlbW92ZVNoaXAoc2hpcE9iaiwgZ2FtZWJvYXJkKTtcbiAgICAgICAgICAgIGdhbWVib2FyZC5yZW1vdmVSZXNlcnZlZFNwYWNlKGdhbWVib2FyZCk7XG4gICAgICAgICAgICBnYW1lYm9hcmQuc2hpcHNQbGFjZWQuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgICAgICAgICAgICAgIGdhbWVib2FyZC5yZXNlcnZlU3BhY2UoZ2FtZWJvYXJkLCBzaGlwLmNvbCwgc2hpcC5yb3cpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0ZW1wU2hpcC5yb3RhdGUoKTtcbiAgICAgICAgICAgIG9yaWVudGF0aW9uID0gdGVtcFNoaXAuaXNWZXJ0aWNhbCA/ICd2ZXJ0aWNhbCcgOiAnaG9yaXpvbnRhbCc7XG4gICAgICAgICAgICBpZiAoZ2FtZWJvYXJkLmNhbkJlUGxhY2VkKHRlbXBTaGlwLnNpemUsIGN1cnJlbnRbMF0uY29sLCBjdXJyZW50WzBdLnJvdywgb3JpZW50YXRpb24pKSB7XG4gICAgICAgICAgICAgICAgZ2FtZWJvYXJkLnBsYWNlU2hpcCh0ZW1wU2hpcCwgY3VycmVudFswXS5jb2wsIGN1cnJlbnRbMF0ucm93LCBvcmllbnRhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0ZW1wU2hpcC5yb3RhdGUoKTtcbiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbiA9IHRlbXBTaGlwLmlzVmVydGljYWwgPyAndmVydGljYWwnIDogJ2hvcml6b250YWwnO1xuICAgICAgICAgICAgICAgIGdhbWVib2FyZC5wbGFjZVNoaXAodGVtcFNoaXAsIGN1cnJlbnRbMF0uY29sLCBjdXJyZW50WzBdLnJvdywgb3JpZW50YXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2FtZWJvYXJkLnNoaXBzUGxhY2VkLmZvckVhY2goKHNoaXApID0+IHtcbiAgICAgICAgICAgICAgICBnYW1lYm9hcmQucmVzZXJ2ZVNwYWNlKGdhbWVib2FyZCwgc2hpcC5jb2wsIHNoaXAucm93KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmVmcmVzaEJvYXJkKGdhbWVib2FyZCk7XG4gICAgICAgICAgICBjcmVhdGVTaGlwT3ZlcmxheSgnZmlyc3QnLCBmaXJzdEdhbWVib2FyZC5zaGlwc1BsYWNlZCk7XG4gICAgICAgICAgICBjcmVhdGVTaGlwT3ZlcmxheSgnc2Vjb25kJywgc2Vjb25kR2FtZWJvYXJkLnNoaXBzUGxhY2VkKTtcbiAgICAgICAgICAgIGRyYWdBbmREcm9wKGZpcnN0R2FtZWJvYXJkLCBzZWNvbmRHYW1lYm9hcmQsIGNvbnRyb2xsZXIuaHVtYW5TaGlwcyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gYmxvY2tSaWdodENsaWNrKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcFZjQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBmaWxsQ2VsbHMoJ2ZpcnN0Jyk7XG4gICAgICAgIGhhbmRsZUdhbWVNb2RlKHBWY0J0biwgY1ZjQnRuKTtcbiAgICAgICAgY29uc3Qgc2Vjb25kID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NlY29uZEJvYXJkJyk7XG4gICAgICAgIHNlY29uZC5jbGFzc0xpc3QucmVtb3ZlKCdzdGFydCcpO1xuICAgICAgICB1bkZpbGxDZWxscygnZmlyc3QnKTtcbiAgICAgICAgc3RhcnRCdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICBwVmNCdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0pO1xuICAgIGNWY0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgZmlsbENlbGxzKCdmaXJzdCcpO1xuICAgICAgICBmaWxsQ2VsbHMoJ3NlY29uZCcpO1xuICAgICAgICBoYW5kbGVHYW1lTW9kZShjVmNCdG4sIHBWY0J0bik7XG4gICAgICAgIGNvbnN0IHNlY29uZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzZWNvbmRCb2FyZCcpO1xuICAgICAgICBzZWNvbmQuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpO1xuICAgICAgICBzZWNvbmQuY2xhc3NMaXN0LmFkZCgnc3RhcnQnKTtcbiAgICAgICAgUHJvbWlzZS5hbGwoW3VuRmlsbENlbGxzKCdmaXJzdCcpLCB1bkZpbGxDZWxscygnc2Vjb25kJyldKTtcbiAgICAgICAgc3RhcnRCdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICByYW5kb21CdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICBjVmNCdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0pO1xuICAgIG5ld0dhbWVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgZmlsbENlbGxzKCdmaXJzdCcpO1xuICAgICAgICBpZiAoY1ZjQnRuLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSkge1xuICAgICAgICAgICAgZmlsbENlbGxzKCdzZWNvbmQnKTtcbiAgICAgICAgICAgIHN0YXJ0QnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHJhbmRvbUJ0bi5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgICAgICBjVmNCdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHVpLnJlbW92ZUJvYXJkUG9pbnRlcigpO1xuICAgICAgICB5aWVsZCBoYW5kbGVOZXdHYW1lKCk7XG4gICAgICAgIGNvbnN0IHNlY29uZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzZWNvbmRCb2FyZCcpO1xuICAgICAgICBzZWNvbmQuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpO1xuICAgICAgICBpZiAocFZjQnRuLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSkge1xuICAgICAgICAgICAgc2Vjb25kLmNsYXNzTGlzdC5yZW1vdmUoJ3N0YXJ0Jyk7XG4gICAgICAgICAgICB1bkZpbGxDZWxscygnZmlyc3QnKTtcbiAgICAgICAgICAgIHN0YXJ0QnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHBWY0J0bi5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNWY0J0bi5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpIHtcbiAgICAgICAgICAgIHNlY29uZC5jbGFzc0xpc3QuYWRkKCdzdGFydCcpO1xuICAgICAgICAgICAgcmFuZG9tQnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIFByb21pc2UuYWxsKFt1bkZpbGxDZWxscygnZmlyc3QnKSwgdW5GaWxsQ2VsbHMoJ3NlY29uZCcpXSk7XG4gICAgICAgICAgICBzdGFydEJ0bi5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgICAgICByYW5kb21CdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgY1ZjQnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH0pKTtcbiAgICBzdGFydEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgY29udHJvbGxlci5zdGFydCgpO1xuICAgICAgICBjb25zdCBmaXJzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNmaXJzdEJvYXJkJyk7XG4gICAgICAgIGZpcnN0LmNsYXNzTGlzdC5hZGQoJ2hpZGUnKTtcbiAgICAgICAgY29uc3Qgc2Vjb25kID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NlY29uZEJvYXJkJyk7XG4gICAgICAgIHNlY29uZC5jbGFzc0xpc3QuYWRkKCdoaWRlJyk7XG4gICAgICAgIHNlY29uZC5jbGFzc0xpc3QuYWRkKCdzdGFydCcpO1xuICAgICAgICB1bkZpbGxDZWxscygnc2Vjb25kJyk7XG4gICAgICAgIHN0YXJ0QnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgcmFuZG9tQnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9KTtcbiAgICByYW5kb21CdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGNvbnRyb2xsZXIuY29tcHV0ZXJHYW1lYm9hcmQuY2xlYXJCb2FyZCgpO1xuICAgICAgICByZWZyZXNoQm9hcmQoY29udHJvbGxlci5jb21wdXRlckdhbWVib2FyZCk7XG4gICAgICAgIGNvbnRyb2xsZXIucmFuZG9taXplU2hpcHNQbGFjZW1lbnQoJ2ZpcnN0JywgY29udHJvbGxlci5odW1hbkdhbWVib2FyZCk7XG4gICAgICAgIGRyYWdBbmREcm9wKGNvbnRyb2xsZXIuaHVtYW5HYW1lYm9hcmQsIGNvbnRyb2xsZXIuY29tcHV0ZXJHYW1lYm9hcmQsIGNvbnRyb2xsZXIuaHVtYW5TaGlwcyk7XG4gICAgICAgIGNhbkJlU3RhcnRlZCgpO1xuICAgICAgICBzZXRTdGFydE1lc3NhZ2UoKTtcbiAgICAgICAgZmlsbENlbGxzKCdzZWNvbmQnKTtcbiAgICB9KTtcbiAgICBsZXQgc3BlZWRWYWx1ZSA9IDEwMDA7XG4gICAgc3BlZWRzLmZvckVhY2goKHNwZWVkKSA9PiB7XG4gICAgICAgIHNwZWVkLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IGlucHV0ID0gc3BlZWQ7XG4gICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCkge1xuICAgICAgICAgICAgICAgIHNwZWVkVmFsdWUgPSBOdW1iZXIoaW5wdXQudmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICBjb25zdCBnZXRTcGVlZFZhbHVlID0gKCkgPT4ge1xuICAgICAgICByZXR1cm4gc3BlZWRWYWx1ZTtcbiAgICB9O1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBzZXRJbml0TWVzc2FnZSk7XG4gICAgY29uc3QgZmlsbENlbGxzID0gKGlucHV0KSA9PiB7XG4gICAgICAgIGxldCBib2FyZDtcbiAgICAgICAgaWYgKGlucHV0ID09PSAnZmlyc3QnKSB7XG4gICAgICAgICAgICBib2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNmaXJzdEJvYXJkJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaW5wdXQgPT09ICdzZWNvbmQnKSB7XG4gICAgICAgICAgICBib2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzZWNvbmRCb2FyZCcpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNlbGxzID0gYm9hcmQucXVlcnlTZWxlY3RvckFsbCgnLmNlbGwnKTtcbiAgICAgICAgY2VsbHMuZm9yRWFjaCgoY2VsbCkgPT4ge1xuICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKCdmaWxsZWQnKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBjb25zdCB1bkZpbGxDZWxscyA9IChpbnB1dCkgPT4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgIHdhaXRpbmcodHJ1ZSk7XG4gICAgICAgIGxldCBib2FyZDtcbiAgICAgICAgaWYgKGlucHV0ID09PSAnZmlyc3QnKSB7XG4gICAgICAgICAgICBib2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNmaXJzdEJvYXJkJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaW5wdXQgPT09ICdzZWNvbmQnKSB7XG4gICAgICAgICAgICBib2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzZWNvbmRCb2FyZCcpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNlbGxzID0gYm9hcmQucXVlcnlTZWxlY3RvckFsbCgnLmNlbGwnKTtcbiAgICAgICAgY2VsbHMuZm9yRWFjaCgoY2VsbCkgPT4ge1xuICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKCdmaWxsZWQnKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHlpZWxkIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgICBjZWxscy5mb3JFYWNoKChjZWxsLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5yZW1vdmUoJ2ZpbGxlZCcpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggPT09IGNlbGxzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIChnZXRTcGVlZFZhbHVlKCkgLyAxMjApICogaW5kZXgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICB3YWl0aW5nKGZhbHNlKTtcbiAgICB9KTtcbiAgICByZXR1cm4ge1xuICAgICAgICByZW5kZXJCb2FyZCxcbiAgICAgICAgcmVmcmVzaEJvYXJkLFxuICAgICAgICBoYW5kbGVVc2VySW5wdXQsXG4gICAgICAgIHBWY0J0bixcbiAgICAgICAgY1ZjQnRuLFxuICAgICAgICB3YWl0aW5nLFxuICAgICAgICBzZXRCb2FyZFBvaW50ZXIsXG4gICAgICAgIHJlbW92ZUJvYXJkUG9pbnRlcixcbiAgICAgICAgY3JlYXRlU2hpcE92ZXJsYXksXG4gICAgICAgIGRyYWdBbmREcm9wLFxuICAgICAgICBjYW5CZVN0YXJ0ZWQsXG4gICAgICAgIHNldEluaXRNZXNzYWdlLFxuICAgICAgICBzZXRUdXJuTWVzc2FnZVB2QyxcbiAgICAgICAgc2V0VHVybk1lc3NhZ2VDdkMsXG4gICAgICAgIHNldEdhbWVPdmVyTWVzc2FnZVB2QyxcbiAgICAgICAgc2V0R2FtZU92ZXJNZXNzYWdlQ3ZDLFxuICAgICAgICBzZXRSZXN0YXJ0TWVzc2FnZSxcbiAgICAgICAgZ2V0U3BlZWRWYWx1ZSxcbiAgICAgICAgdW5GaWxsQ2VsbHMsXG4gICAgfTtcbn0pKCk7XG5leHBvcnQgZGVmYXVsdCB1aTtcbiIsInZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IGdhbWVib2FyZEZhY3RvcnkgZnJvbSAnLi9nYW1lYm9hcmQnO1xuaW1wb3J0IHNoaXBGYWN0b3J5IGZyb20gJy4vc2hpcCc7XG5pbXBvcnQgcGxheWVyRmFjdG9yeSBmcm9tICcuL3BsYXllcic7XG5pbXBvcnQgdWkgZnJvbSAnLi91aSc7XG5jb25zdCBjb250cm9sbGVyID0gKCgpID0+IHtcbiAgICBjb25zdCBodW1hbkdhbWVib2FyZCA9IGdhbWVib2FyZEZhY3RvcnkoKTtcbiAgICBjb25zdCBjb21wdXRlckdhbWVib2FyZCA9IGdhbWVib2FyZEZhY3RvcnkoKTtcbiAgICBjb25zdCBodW1hbiA9IHBsYXllckZhY3RvcnkoKTtcbiAgICBjb25zdCBjb21wdXRlciA9IHBsYXllckZhY3RvcnkoKTtcbiAgICBsZXQgaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICBsZXQgaHVtYW5DYXJyaWVyID0gc2hpcEZhY3RvcnkoJ0NhcnJpZXInKTtcbiAgICBsZXQgaHVtYW5CYXR0bGVzaGlwID0gc2hpcEZhY3RvcnkoJ0JhdHRsZXNoaXAnKTtcbiAgICBsZXQgaHVtYW5EZXN0cm95ZXIgPSBzaGlwRmFjdG9yeSgnRGVzdHJveWVyJyk7XG4gICAgbGV0IGh1bWFuU3VibWFyaW5lID0gc2hpcEZhY3RvcnkoJ1N1Ym1hcmluZScpO1xuICAgIGxldCBodW1hblBhdHJvbGJvYXQgPSBzaGlwRmFjdG9yeSgnUGF0cm9sQm9hdCcpO1xuICAgIGNvbnN0IGh1bWFuU2hpcHMgPSBbaHVtYW5DYXJyaWVyLCBodW1hbkJhdHRsZXNoaXAsIGh1bWFuRGVzdHJveWVyLCBodW1hblN1Ym1hcmluZSwgaHVtYW5QYXRyb2xib2F0XTtcbiAgICBjb25zdCBwb3B1bGF0ZVNoaXBzID0gKCkgPT4ge1xuICAgICAgICBjb21wdXRlckdhbWVib2FyZC5wbGFjZVNoaXAoaHVtYW5DYXJyaWVyLCAnQScsICcxJywgJ2hvcml6b250YWwnKTtcbiAgICAgICAgY29tcHV0ZXJHYW1lYm9hcmQucGxhY2VTaGlwKGh1bWFuQmF0dGxlc2hpcCwgJ0EnLCAnMycsICdob3Jpem9udGFsJyk7XG4gICAgICAgIGNvbXB1dGVyR2FtZWJvYXJkLnBsYWNlU2hpcChodW1hbkRlc3Ryb3llciwgJ0EnLCAnNScsICdob3Jpem9udGFsJyk7XG4gICAgICAgIGNvbXB1dGVyR2FtZWJvYXJkLnBsYWNlU2hpcChodW1hblN1Ym1hcmluZSwgJ0EnLCAnNycsICdob3Jpem9udGFsJyk7XG4gICAgICAgIGNvbXB1dGVyR2FtZWJvYXJkLnBsYWNlU2hpcChodW1hblBhdHJvbGJvYXQsICdBJywgJzknLCAnaG9yaXpvbnRhbCcpO1xuICAgICAgICBjb21wdXRlckdhbWVib2FyZC5yZXNlcnZlU3BhY2UoY29tcHV0ZXJHYW1lYm9hcmQsICdBJywgJzEnKTtcbiAgICAgICAgY29tcHV0ZXJHYW1lYm9hcmQucmVzZXJ2ZVNwYWNlKGNvbXB1dGVyR2FtZWJvYXJkLCAnQScsICczJyk7XG4gICAgICAgIGNvbXB1dGVyR2FtZWJvYXJkLnJlc2VydmVTcGFjZShjb21wdXRlckdhbWVib2FyZCwgJ0EnLCAnNScpO1xuICAgICAgICBjb21wdXRlckdhbWVib2FyZC5yZXNlcnZlU3BhY2UoY29tcHV0ZXJHYW1lYm9hcmQsICdBJywgJzcnKTtcbiAgICAgICAgY29tcHV0ZXJHYW1lYm9hcmQucmVzZXJ2ZVNwYWNlKGNvbXB1dGVyR2FtZWJvYXJkLCAnQScsICc5Jyk7XG4gICAgfTtcbiAgICBjb25zdCBpc0dhbWVPdmVyID0gKCkgPT4ge1xuICAgICAgICBpZiAoY29tcHV0ZXJHYW1lYm9hcmQuYWxsU3Vuayhjb21wdXRlckdhbWVib2FyZCkpIHtcbiAgICAgICAgICAgIHVpLnJlbW92ZUJvYXJkUG9pbnRlcigpO1xuICAgICAgICAgICAgaWYgKHVpLnBWY0J0bi5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpIHtcbiAgICAgICAgICAgICAgICB1aS5zZXRHYW1lT3Zlck1lc3NhZ2VQdkMoJ3BsYXllcicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHVpLmNWY0J0bi5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpIHtcbiAgICAgICAgICAgICAgICB1aS5zZXRHYW1lT3Zlck1lc3NhZ2VDdkMoJ3BsYXllcicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ0FsbCBjb21wdXRlciBzaGlwcyBhcmUgc3Vuay4gSHVtYW4gcGxheWVyIHdvbiEnKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChodW1hbkdhbWVib2FyZC5hbGxTdW5rKGh1bWFuR2FtZWJvYXJkKSkge1xuICAgICAgICAgICAgdWkucmVtb3ZlQm9hcmRQb2ludGVyKCk7XG4gICAgICAgICAgICBpZiAodWkucFZjQnRuLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSkge1xuICAgICAgICAgICAgICAgIHVpLnNldEdhbWVPdmVyTWVzc2FnZVB2QygnY29tcHV0ZXInKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh1aS5jVmNCdG4uY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpKSB7XG4gICAgICAgICAgICAgICAgdWkuc2V0R2FtZU92ZXJNZXNzYWdlQ3ZDKCdjb21wdXRlcicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ0FsbCBodW1hbiBzaGlwcyBhcmUgc3Vuay4gQ29tcHV0ZXIgcGxheWVyIHdvbiEnKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIGNvbnN0IGNvbXB1dGVyQUkgPSAoZ2FtZWJvYXJkKSA9PiB7XG4gICAgICAgIGxldCBwbGF5ZXI7XG4gICAgICAgIGlmIChnYW1lYm9hcmQgPT09IGh1bWFuR2FtZWJvYXJkKSB7XG4gICAgICAgICAgICBwbGF5ZXIgPSBjb21wdXRlcjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChnYW1lYm9hcmQgPT09IGNvbXB1dGVyR2FtZWJvYXJkKSB7XG4gICAgICAgICAgICBwbGF5ZXIgPSBodW1hbjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZ2FtZWJvYXJkLmhpdEJ1dE5vdFN1bmsoZ2FtZWJvYXJkKSkge1xuICAgICAgICAgICAgaWYgKHBsYXllci5nZXRQcmV2SGl0KCkgIT09IG51bGwgJiZcbiAgICAgICAgICAgICAgICBwbGF5ZXIuZ2V0TGFzdEhpdCgpICE9PSBudWxsICYmXG4gICAgICAgICAgICAgICAgZ2FtZWJvYXJkLmdldENlbGwocGxheWVyLmdldExhc3RIaXQoKS5jb2wsIHBsYXllci5nZXRMYXN0SGl0KCkucm93KS50YWtlbkJ5LmhpdENvdW50ID49IDIgJiZcbiAgICAgICAgICAgICAgICBnYW1lYm9hcmQuZ2V0Q2VsbChwbGF5ZXIuZ2V0TGFzdEhpdCgpLmNvbCwgcGxheWVyLmdldExhc3RIaXQoKS5yb3cpLnRha2VuQnkuaGl0Q291bnQgPD0gNCkge1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdGSU5JU0g6ID49IDIgdHJhZmllbmlhIHcgc3RhdGVrJywgcGxheWVyLmdldFByZXZIaXQoKSk7XG4gICAgICAgICAgICAgICAgcGxheWVyLmZpbmlzaGluZ0F0dGFjayhnYW1lYm9hcmQsIHBsYXllci5nZXRMYXN0SGl0KCkuY29sLCBwbGF5ZXIuZ2V0TGFzdEhpdCgpLnJvdywgcGxheWVyLmdldFByZXZIaXQoKSk7XG4gICAgICAgICAgICAgICAgZ2FtZWJvYXJkLnNpbmtTaGlwKGdhbWVib2FyZCwgcGxheWVyLmdldExhc3RIaXQoKS5jb2wsIHBsYXllci5nZXRMYXN0SGl0KCkucm93KTtcbiAgICAgICAgICAgICAgICBpZiAoaXNHYW1lT3ZlcigpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChnYW1lYm9hcmQuZ2V0Q2VsbChwbGF5ZXIuZ2V0TGFzdEhpdCgpLmNvbCwgcGxheWVyLmdldExhc3RIaXQoKS5yb3cpLnRha2VuQnkuaGl0Q291bnQgPT09IDEpIHtcbiAgICAgICAgICAgICAgICBwbGF5ZXIuZm9sbG93dXBBdHRhY2soZ2FtZWJvYXJkLCBwbGF5ZXIuZ2V0TGFzdEhpdCgpLmNvbCwgcGxheWVyLmdldExhc3RIaXQoKS5yb3cpO1xuICAgICAgICAgICAgICAgIGdhbWVib2FyZC5zaW5rU2hpcChnYW1lYm9hcmQsIHBsYXllci5nZXRMYXN0SGl0KCkuY29sLCBwbGF5ZXIuZ2V0TGFzdEhpdCgpLnJvdyk7XG4gICAgICAgICAgICAgICAgaWYgKGlzR2FtZU92ZXIoKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgeyBjb2wsIHJvdyB9ID0gcGxheWVyLnJhbmRvbUF0dGFjayhnYW1lYm9hcmQpO1xuICAgICAgICAgICAgaWYgKGdhbWVib2FyZC5nZXRDZWxsKGNvbCwgcm93KS5zdGF0dXMgPT09ICdoaXQnKSB7XG4gICAgICAgICAgICAgICAgcGxheWVyLnNldFByZXZIaXQocGxheWVyLmdldExhc3RIaXQoKSk7XG4gICAgICAgICAgICAgICAgcGxheWVyLnNldExhc3RIaXQoeyBjb2wsIHJvdyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIHJvdykuc3RhdHVzID09PSAnaGl0JyAmJiBnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIHJvdykudGFrZW5CeS5pc1N1bmsoKSkge1xuICAgICAgICAgICAgICAgIGdhbWVib2FyZC5zaW5rU2hpcChnYW1lYm9hcmQsIGNvbCwgcm93KTtcbiAgICAgICAgICAgICAgICBwbGF5ZXIuc2V0UHJldkhpdChudWxsKTtcbiAgICAgICAgICAgICAgICBwbGF5ZXIuc2V0TGFzdEhpdChudWxsKTtcbiAgICAgICAgICAgICAgICBpZiAoaXNHYW1lT3ZlcigpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IHBsYXllclZzQ29tcHV0ZXJNb2RlID0gKCkgPT4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgIGxldCBpc1BsYXllclR1cm4gPSB0cnVlO1xuICAgICAgICB3aGlsZSAoIWlzR2FtZU92ZXIoKSAmJiAhaXNTdG9wcGVkKSB7XG4gICAgICAgICAgICBpZiAoaXNQbGF5ZXJUdXJuKSB7XG4gICAgICAgICAgICAgICAgdWkuc2V0VHVybk1lc3NhZ2VQdkMoaXNQbGF5ZXJUdXJuKTtcbiAgICAgICAgICAgICAgICB1aS5zZXRCb2FyZFBvaW50ZXIoJ3BsYXllcicpO1xuICAgICAgICAgICAgICAgIHVpLndhaXRpbmcoZmFsc2UpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgY29sLCByb3cgfSA9IHlpZWxkIHVpLmhhbmRsZVVzZXJJbnB1dCgpO1xuICAgICAgICAgICAgICAgIGh1bWFuLmF0dGFjayhjb21wdXRlckdhbWVib2FyZCwgY29sLCByb3cpO1xuICAgICAgICAgICAgICAgIGNvbXB1dGVyR2FtZWJvYXJkLnNpbmtTaGlwKGNvbXB1dGVyR2FtZWJvYXJkLCBjb2wsIHJvdyk7XG4gICAgICAgICAgICAgICAgdWkucmVmcmVzaEJvYXJkKGNvbXB1dGVyR2FtZWJvYXJkKTtcbiAgICAgICAgICAgICAgICBpc1BsYXllclR1cm4gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpc0dhbWVPdmVyKCkgfHwgaXNTdG9wcGVkKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWlzUGxheWVyVHVybikge1xuICAgICAgICAgICAgICAgIHVpLnNldFR1cm5NZXNzYWdlUHZDKGlzUGxheWVyVHVybik7XG4gICAgICAgICAgICAgICAgdWkuc2V0Qm9hcmRQb2ludGVyKCdjb21wdXRlcicpO1xuICAgICAgICAgICAgICAgIHVpLndhaXRpbmcodHJ1ZSk7XG4gICAgICAgICAgICAgICAgeWllbGQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgdWkuZ2V0U3BlZWRWYWx1ZSgpKSk7XG4gICAgICAgICAgICAgICAgaWYgKCF1aS5wVmNCdG4uY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpIHx8IGlzU3RvcHBlZCkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29tcHV0ZXJBSShodW1hbkdhbWVib2FyZCk7XG4gICAgICAgICAgICAgICAgdWkucmVmcmVzaEJvYXJkKGh1bWFuR2FtZWJvYXJkKTtcbiAgICAgICAgICAgICAgICBpc1BsYXllclR1cm4gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlzU3RvcHBlZCA9IGZhbHNlO1xuICAgICAgICB1aS53YWl0aW5nKGZhbHNlKTtcbiAgICB9KTtcbiAgICBjb25zdCBjb21wdXRlclZzQ29tcHV0ZXJNb2RlID0gKCkgPT4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgIHVpLnJlbW92ZUJvYXJkUG9pbnRlcigpO1xuICAgICAgICBsZXQgaXNQbGF5ZXJUdXJuID0gdHJ1ZTtcbiAgICAgICAgd2hpbGUgKCFpc0dhbWVPdmVyKCkgJiYgIWlzU3RvcHBlZCkge1xuICAgICAgICAgICAgdWkud2FpdGluZyh0cnVlKTtcbiAgICAgICAgICAgIGlmIChpc1BsYXllclR1cm4pIHtcbiAgICAgICAgICAgICAgICB1aS5zZXRUdXJuTWVzc2FnZUN2Qyhpc1BsYXllclR1cm4pO1xuICAgICAgICAgICAgICAgIHlpZWxkIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIHVpLmdldFNwZWVkVmFsdWUoKSkpO1xuICAgICAgICAgICAgICAgIGlmICghdWkuY1ZjQnRuLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSB8fCBpc1N0b3BwZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbXB1dGVyQUkoaHVtYW5HYW1lYm9hcmQpO1xuICAgICAgICAgICAgICAgIHVpLnJlZnJlc2hCb2FyZChodW1hbkdhbWVib2FyZCk7XG4gICAgICAgICAgICAgICAgaXNQbGF5ZXJUdXJuID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXNHYW1lT3ZlcigpIHx8IGlzU3RvcHBlZCkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFpc1BsYXllclR1cm4pIHtcbiAgICAgICAgICAgICAgICB1aS5zZXRUdXJuTWVzc2FnZUN2Qyhpc1BsYXllclR1cm4pO1xuICAgICAgICAgICAgICAgIHlpZWxkIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIHVpLmdldFNwZWVkVmFsdWUoKSkpO1xuICAgICAgICAgICAgICAgIGlmICghdWkuY1ZjQnRuLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSB8fCBpc1N0b3BwZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbXB1dGVyQUkoY29tcHV0ZXJHYW1lYm9hcmQpO1xuICAgICAgICAgICAgICAgIHVpLnJlZnJlc2hCb2FyZChjb21wdXRlckdhbWVib2FyZCk7XG4gICAgICAgICAgICAgICAgaXNQbGF5ZXJUdXJuID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpc1N0b3BwZWQgPSBmYWxzZTtcbiAgICAgICAgdWkud2FpdGluZyhmYWxzZSk7XG4gICAgfSk7XG4gICAgY29uc3QgcmFuZG9tUGxhY2VtZW50ID0gKGdhbWVib2FyZCkgPT4ge1xuICAgICAgICBsZXQgYWxsU2hpcHM7XG4gICAgICAgIGlmIChnYW1lYm9hcmQgPT09IGh1bWFuR2FtZWJvYXJkKSB7XG4gICAgICAgICAgICBodW1hbkNhcnJpZXIgPSBzaGlwRmFjdG9yeSgnQ2FycmllcicpO1xuICAgICAgICAgICAgaHVtYW5CYXR0bGVzaGlwID0gc2hpcEZhY3RvcnkoJ0JhdHRsZXNoaXAnKTtcbiAgICAgICAgICAgIGh1bWFuRGVzdHJveWVyID0gc2hpcEZhY3RvcnkoJ0Rlc3Ryb3llcicpO1xuICAgICAgICAgICAgaHVtYW5TdWJtYXJpbmUgPSBzaGlwRmFjdG9yeSgnU3VibWFyaW5lJyk7XG4gICAgICAgICAgICBodW1hblBhdHJvbGJvYXQgPSBzaGlwRmFjdG9yeSgnUGF0cm9sQm9hdCcpO1xuICAgICAgICAgICAgYWxsU2hpcHMgPSBbaHVtYW5DYXJyaWVyLCBodW1hbkJhdHRsZXNoaXAsIGh1bWFuRGVzdHJveWVyLCBodW1hblN1Ym1hcmluZSwgaHVtYW5QYXRyb2xib2F0XTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChnYW1lYm9hcmQgPT09IGNvbXB1dGVyR2FtZWJvYXJkKSB7XG4gICAgICAgICAgICBjb25zdCBjb21wdXRlckNhcnJpZXIgPSBzaGlwRmFjdG9yeSgnQ2FycmllcicpO1xuICAgICAgICAgICAgY29uc3QgY29tcHV0ZXJCYXR0bGVzaGlwID0gc2hpcEZhY3RvcnkoJ0JhdHRsZXNoaXAnKTtcbiAgICAgICAgICAgIGNvbnN0IGNvbXB1dGVyRGVzdHJveWVyID0gc2hpcEZhY3RvcnkoJ0Rlc3Ryb3llcicpO1xuICAgICAgICAgICAgY29uc3QgY29tcHV0ZXJTdWJtYXJpbmUgPSBzaGlwRmFjdG9yeSgnU3VibWFyaW5lJyk7XG4gICAgICAgICAgICBjb25zdCBjb21wdXRlclBhdHJvbGJvYXQgPSBzaGlwRmFjdG9yeSgnUGF0cm9sQm9hdCcpO1xuICAgICAgICAgICAgYWxsU2hpcHMgPSBbY29tcHV0ZXJDYXJyaWVyLCBjb21wdXRlckJhdHRsZXNoaXAsIGNvbXB1dGVyRGVzdHJveWVyLCBjb21wdXRlclN1Ym1hcmluZSwgY29tcHV0ZXJQYXRyb2xib2F0XTtcbiAgICAgICAgfVxuICAgICAgICBjb250cm9sbGVyLmh1bWFuU2hpcHMubGVuZ3RoID0gMDtcbiAgICAgICAgY29uc3QgY29scyA9IFsnQScsICdCJywgJ0MnLCAnRCcsICdFJywgJ0YnLCAnRycsICdIJywgJ0knLCAnSiddO1xuICAgICAgICBjb25zdCByYW5kb21Db2wgPSAoKSA9PiBjb2xzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNvbHMubGVuZ3RoKV07XG4gICAgICAgIGNvbnN0IHJhbmRvbVJvdyA9ICgpID0+IE1hdGguY2VpbChNYXRoLnJhbmRvbSgpICogMTApLnRvU3RyaW5nKCk7XG4gICAgICAgIGNvbnN0IHJhbmRvbU9yaWVudGF0aW9uID0gKCkgPT4gKE1hdGgucmFuZG9tKCkgPiAwLjUgPyAnaG9yaXpvbnRhbCcgOiAndmVydGljYWwnKTtcbiAgICAgICAgYWxsU2hpcHMuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgICAgICAgICAgbGV0IGNvbCA9IHJhbmRvbUNvbCgpO1xuICAgICAgICAgICAgbGV0IHJvdyA9IHJhbmRvbVJvdygpO1xuICAgICAgICAgICAgbGV0IG9yaWVudGF0aW9uID0gcmFuZG9tT3JpZW50YXRpb24oKTtcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSBnYW1lYm9hcmQuY2FuQmVQbGFjZWQoc2hpcC5zaXplLCBjb2wsIHJvdywgb3JpZW50YXRpb24pO1xuICAgICAgICAgICAgd2hpbGUgKCFyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBjb2wgPSByYW5kb21Db2woKTtcbiAgICAgICAgICAgICAgICByb3cgPSByYW5kb21Sb3coKTtcbiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbiA9IHJhbmRvbU9yaWVudGF0aW9uKCk7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gZ2FtZWJvYXJkLmNhbkJlUGxhY2VkKHNoaXAuc2l6ZSwgY29sLCByb3csIG9yaWVudGF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBnYW1lYm9hcmQucGxhY2VTaGlwKHNoaXAsIGNvbCwgcm93LCBvcmllbnRhdGlvbik7XG4gICAgICAgICAgICAgICAgZ2FtZWJvYXJkLnJlc2VydmVTcGFjZShnYW1lYm9hcmQsIGNvbCwgcm93KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnRyb2xsZXIuaHVtYW5TaGlwcy5wdXNoKHNoaXApO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIGNvbnN0IHJhbmRvbWl6ZVNoaXBzUGxhY2VtZW50ID0gKGdhbWVib2FyZE5hbWUsIGdhbWVib2FyZCkgPT4ge1xuICAgICAgICBnYW1lYm9hcmQuY2xlYXJCb2FyZCgpO1xuICAgICAgICByYW5kb21QbGFjZW1lbnQoZ2FtZWJvYXJkKTtcbiAgICAgICAgdWkucmVmcmVzaEJvYXJkKGdhbWVib2FyZCk7XG4gICAgICAgIGlmIChnYW1lYm9hcmROYW1lID09PSAnZmlyc3QnKSB7XG4gICAgICAgICAgICB1aS5jcmVhdGVTaGlwT3ZlcmxheSgnZmlyc3QnLCBnYW1lYm9hcmQuc2hpcHNQbGFjZWQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCByZXNldE9yaWVudGF0aW9uID0gKCkgPT4ge1xuICAgICAgICBodW1hblNoaXBzLmZvckVhY2goKHNoaXApID0+IHtcbiAgICAgICAgICAgIGlmIChzaGlwLmlzVmVydGljYWwgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICBzaGlwLmlzVmVydGljYWwgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBjb25zdCBwaWNrR2FtZU1vZGUgPSAoKSA9PiB7XG4gICAgICAgIGlmICh1aS5jVmNCdG4uY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpKSB7XG4gICAgICAgICAgICByYW5kb21pemVTaGlwc1BsYWNlbWVudCgnZmlyc3QnLCBodW1hbkdhbWVib2FyZCk7XG4gICAgICAgICAgICByYW5kb21pemVTaGlwc1BsYWNlbWVudCgnc2Vjb25kJywgY29tcHV0ZXJHYW1lYm9hcmQpO1xuICAgICAgICAgICAgaXNTdG9wcGVkID0gZmFsc2U7XG4gICAgICAgICAgICBjb21wdXRlclZzQ29tcHV0ZXJNb2RlKCk7XG4gICAgICAgICAgICB1aS5yZWZyZXNoQm9hcmQoaHVtYW5HYW1lYm9hcmQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBzdGFydCA9ICgpID0+IHtcbiAgICAgICAgdWkucmVmcmVzaEJvYXJkKGh1bWFuR2FtZWJvYXJkKTtcbiAgICAgICAgcmFuZG9taXplU2hpcHNQbGFjZW1lbnQoJ3NlY29uZCcsIGNvbXB1dGVyR2FtZWJvYXJkKTtcbiAgICAgICAgaXNTdG9wcGVkID0gZmFsc2U7XG4gICAgICAgIHBsYXllclZzQ29tcHV0ZXJNb2RlKCk7XG4gICAgfTtcbiAgICBjb25zdCByZXN0YXJ0ID0gKCkgPT4ge1xuICAgICAgICBpc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICBodW1hbi5zZXRQcmV2SGl0KG51bGwpO1xuICAgICAgICBodW1hbi5zZXRMYXN0SGl0KG51bGwpO1xuICAgICAgICBjb21wdXRlci5zZXRQcmV2SGl0KG51bGwpO1xuICAgICAgICBjb21wdXRlci5zZXRMYXN0SGl0KG51bGwpO1xuICAgICAgICBodW1hbkdhbWVib2FyZC5jbGVhckJvYXJkKCk7XG4gICAgICAgIGNvbXB1dGVyR2FtZWJvYXJkLmNsZWFyQm9hcmQoKTtcbiAgICAgICAgcG9wdWxhdGVTaGlwcygpO1xuICAgICAgICB1aS5yZWZyZXNoQm9hcmQoaHVtYW5HYW1lYm9hcmQpO1xuICAgICAgICB1aS5yZWZyZXNoQm9hcmQoY29tcHV0ZXJHYW1lYm9hcmQpO1xuICAgICAgICB1aS5jcmVhdGVTaGlwT3ZlcmxheSgnc2Vjb25kJywgY29tcHV0ZXJHYW1lYm9hcmQuc2hpcHNQbGFjZWQpO1xuICAgICAgICB1aS5kcmFnQW5kRHJvcChodW1hbkdhbWVib2FyZCwgY29tcHV0ZXJHYW1lYm9hcmQsIGh1bWFuU2hpcHMpO1xuICAgICAgICB1aS5jYW5CZVN0YXJ0ZWQoKTtcbiAgICAgICAgcGlja0dhbWVNb2RlKCk7XG4gICAgICAgIHJlc2V0T3JpZW50YXRpb24oKTtcbiAgICB9O1xuICAgIGNvbnN0IG5ld0dhbWUgPSAoKSA9PiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgeWllbGQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgdWkuZ2V0U3BlZWRWYWx1ZSgpKSk7XG4gICAgICAgIGlzU3RvcHBlZCA9IGZhbHNlO1xuICAgICAgICByZXN0YXJ0KCk7XG4gICAgfSk7XG4gICAgY29uc3QgaW5pdCA9ICgpID0+IHtcbiAgICAgICAgdWkuc2V0SW5pdE1lc3NhZ2UoKTtcbiAgICAgICAgdWkucmVuZGVyQm9hcmQoaHVtYW5HYW1lYm9hcmQpO1xuICAgICAgICB1aS5yZW5kZXJCb2FyZChjb21wdXRlckdhbWVib2FyZCk7XG4gICAgICAgIHBvcHVsYXRlU2hpcHMoKTtcbiAgICAgICAgdWkucmVmcmVzaEJvYXJkKGNvbXB1dGVyR2FtZWJvYXJkKTtcbiAgICAgICAgdWkuY3JlYXRlU2hpcE92ZXJsYXkoJ3NlY29uZCcsIGNvbXB1dGVyR2FtZWJvYXJkLnNoaXBzUGxhY2VkKTtcbiAgICAgICAgdWkuZHJhZ0FuZERyb3AoaHVtYW5HYW1lYm9hcmQsIGNvbXB1dGVyR2FtZWJvYXJkLCBodW1hblNoaXBzKTtcbiAgICAgICAgdWkuY2FuQmVTdGFydGVkKCk7XG4gICAgICAgIHBpY2tHYW1lTW9kZSgpO1xuICAgICAgICB1aS51bkZpbGxDZWxscygnZmlyc3QnKTtcbiAgICAgICAgdWkucFZjQnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9O1xuICAgIHJldHVybiB7IGluaXQsIGh1bWFuR2FtZWJvYXJkLCBjb21wdXRlckdhbWVib2FyZCwgcmVzdGFydCwgbmV3R2FtZSwgc3RhcnQsIHJhbmRvbWl6ZVNoaXBzUGxhY2VtZW50LCBodW1hblNoaXBzIH07XG59KSgpO1xuZXhwb3J0IGRlZmF1bHQgY29udHJvbGxlcjtcbiIsImltcG9ydCAnbm9ybWFsaXplLmNzcyc7XG5pbXBvcnQgJy4vc3R5bGUvc3R5bGUuY3NzJztcbmltcG9ydCBjb250cm9sbGVyIGZyb20gJy4vbW9kdWxlcy9jb250cm9sbGVyJztcbmNvbnRyb2xsZXIuaW5pdCgpO1xuIl0sIm5hbWVzIjpbImNvbHMiLCJyb3dzIiwiYXJyYXkiLCJzaGlwc1BsYWNlZCIsImdldENlbGwiLCJjb2wiLCJyb3ciLCJjb2xJbmRleCIsImluZGV4T2YiLCJyb3dJbmRleCIsInNldENlbGwiLCJuZXdTdGF0dXMiLCJuZXdUYWtlbkJ5Iiwic3RhdHVzIiwidGFrZW5CeSIsImkiLCJqIiwiZ2VuZXJhdGVBcnJheSIsImNsZWFyQm9hcmQiLCJ1bmRlZmluZWQiLCJsZW5ndGgiLCJyZW1vdmVTaGlwIiwic2hpcCIsImdhbWVib2FyZCIsImZsYXQiLCJmb3JFYWNoIiwiY2VsbCIsImJvYXJkSWQiLCJuYW1lIiwic3BsaWNlIiwiaHVtYW5HYW1lYm9hcmQiLCJjb21wdXRlckdhbWVib2FyZCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwiZ2V0QXR0cmlidXRlIiwidG9Mb3dlckNhc2UiLCJyZW1vdmUiLCJhZGQiLCJyZW1vdmVBdHRyaWJ1dGUiLCJwbGFjZVNoaXAiLCJvcmllbnRhdGlvbiIsImlzVmVydGljYWwiLCJpc0hvcml6b250YWwiLCJjZWxscyIsInN0YXJ0Iiwic2hpcENlbGxzIiwic2l6ZSIsImN1cnJlbnRDb2wiLCJjdXJyZW50Um93IiwicHVzaCIsInJlY2VpdmVBdHRhY2siLCJoaXQiLCJyZWNlaXZlQXJvdW5kIiwicmVzZXJ2ZVNwYWNlIiwiZmlsdGVyIiwiYyIsImRpcmVjdGlvbiIsIm5ld0NvbCIsIlN0cmluZyIsImZyb21DaGFyQ29kZSIsImNoYXJDb2RlQXQiLCJuZXdSb3ciLCJOdW1iZXIiLCJ0b1N0cmluZyIsImhpdEJ1dE5vdFN1bmsiLCJzb21lIiwiaXNTdW5rIiwic2lua1NoaXAiLCJhbGxTdW5rIiwidGFrZW5CeUNlbGxzIiwiZXZlcnkiLCJjYW5CZVBsYWNlZCIsImFyZUVtcHR5IiwiaXRlbSIsInJlbW92ZVJlc2VydmVkU3BhY2UiLCJoaXRDb3VudCIsInJvdGF0ZSIsInRoaXMiLCJwcmV2SGl0IiwibGFzdEhpdCIsInJhbmdlIiwiZ29SaWdodCIsImdvRG93biIsImZpbmlzaGluZ0F0dGFjayIsInNldFByZXZIaXQiLCJzZXRMYXN0SGl0IiwibmV3UHJldkhpdCIsIm5ld0xhc3RIaXQiLCJhdHRhY2siLCJyZXN1bHQiLCJyYW5kb21BdHRhY2siLCJyYW5kb21Db2wiLCJyYW5kb21Sb3ciLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJjZWlsIiwiZm9sbG93dXBBdHRhY2siLCJ2YWxpZERpcmVjdGlvbnMiLCJyYW5kb21EaXJlY3Rpb24iLCJnZXRQcmV2SGl0IiwiZ2V0TGFzdEhpdCIsIl9fYXdhaXRlciIsInRoaXNBcmciLCJfYXJndW1lbnRzIiwiUCIsImdlbmVyYXRvciIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZnVsZmlsbGVkIiwidmFsdWUiLCJzdGVwIiwibmV4dCIsImUiLCJyZWplY3RlZCIsImRvbmUiLCJ0aGVuIiwiYXBwbHkiLCJ1aSIsInN0YXR1c0JveCIsInF1ZXJ5U2VsZWN0b3IiLCJib2FyZHMiLCJwVmNCdG4iLCJuZXdHYW1lQnRuIiwiY1ZjQnRuIiwic3RhcnRCdG4iLCJyYW5kb21CdG4iLCJhbGxCdG5zIiwic3BlZWRzIiwiZ2V0RWxlbWVudHNCeU5hbWUiLCJyZW5kZXJDZWxscyIsImJvYXJkIiwiZWxlbWVudCIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJjcmVhdGVDZWxsIiwiYXBwZW5kIiwicmVmcmVzaEJvYXJkIiwiaW5uZXJIVE1MIiwiZ2V0VXNlcklucHV0IiwidGFyZ2V0IiwiaGFuZGxlR2FtZU1vZGUiLCJzZWxlY3RlZEVsZW1lbnQiLCJkZXNlbGVjdGVkRWxlbWVudCIsImZpbGxDZWxscyIsIndhaXRpbmciLCJidG4iLCJkaXNhYmxlZCIsInNldFRpbWVvdXQiLCJnZXRTcGVlZFZhbHVlIiwiY2FuQmVTdGFydGVkIiwic2V0SW5pdE1lc3NhZ2UiLCJyZXN0YXJ0Iiwic2V0UmVzdGFydE1lc3NhZ2UiLCJib29sIiwiZG9jdW1lbnRFbGVtZW50IiwidG9nZ2xlIiwiY3JlYXRlU2hpcE92ZXJsYXkiLCJnYW1lYm9hcmROYW1lIiwic2hpcHMiLCJmaXJzdENlbGwiLCJzaGlwRWxlbWVudCIsInNoaXBOYW1lIiwic2hpcFNpemUiLCJzZXRTaGlwU3R5bGUiLCJodG1sRWxlbWVudCIsInJvb3RGb250U2l6ZSIsInBhcnNlRmxvYXQiLCJ3aW5kb3ciLCJnZXRDb21wdXRlZFN0eWxlIiwiZ2V0UHJvcGVydHlWYWx1ZSIsInN0eWxlIiwid2lkdGgiLCJjZWxsU2l6ZSIsImhlaWdodCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImFkZEV2ZW50TGlzdGVuZXIiLCJhcHBlbmRDaGlsZCIsInRleHRDb250ZW50IiwibWF0Y2hNZWRpYSIsIm1hdGNoZXMiLCJzZXRTdGFydE1lc3NhZ2UiLCJkcmFnQW5kRHJvcCIsImZpcnN0R2FtZWJvYXJkIiwic2Vjb25kR2FtZWJvYXJkIiwic2hpcE9iaiIsImdyYWJQb2ludFgiLCJncmFiUG9pbnRZIiwiaGlnaGxpZ2h0ZWRDZWxscyIsInNoaXBOYW1lVG9PYmoiLCJjYXJyaWVyIiwiYmF0dGxlc2hpcCIsImRlc3Ryb3llciIsInN1Ym1hcmluZSIsInBhdHJvbGJvYXQiLCJmaXJzdEJvYXJkRWxlbWVudCIsInNlY29uZEJvYXJkRWxlbWVudCIsImZpcnN0Qm9hcmRDZWxscyIsInNlY29uZEJvYXJkQ2VsbHMiLCJub25TaGlwQ2VsbHMiLCJkcmFnZ2FibGUiLCJoYW5kbGVNb3VzZWRvd24iLCJoYW5kbGVNb3VzZXVwIiwiaGFuZGxlRHJhZ1N0YXJ0IiwiaGFuZGxlRHJhZ0VuZCIsImhhbmRsZVJvdGF0ZSIsImJsb2NrUmlnaHRDbGljayIsImxhc3REcmFnZ2VkIiwidGFyZ2V0U2hpcE5hbWUiLCJ1cGRhdGVkU2hpcHNQbGFjZWRGaXJzdCIsInVwZGF0ZWRTaGlwc1BsYWNlZFRlbXAiLCJodW1hblNoaXBzIiwidmlzaWJpbGl0eSIsIm9mZnNldFgiLCJvZmZzZXRZIiwiY2xvc2VzdCIsImlkIiwiaGFuZGxlRHJhZ092ZXIiLCJpbmRleCIsInByZXZlbnREZWZhdWx0Iiwic3RhcnRDZWxsIiwib2Zmc2V0SGVpZ2h0Iiwib2Zmc2V0V2lkdGgiLCJ0b0hpZ2hsaWdodCIsImNlbGxJbmRleCIsImlzVmFsaWRQbGFjZW1lbnQiLCJnZXRMYXN0U2hpcFNpemVFbGVtZW50cyIsImhhbmRsZURyYWdMZWF2ZSIsImhpZ2hsaWdodGVkQ2VsbCIsImhhbmRsZURyb3AiLCJsYXN0IiwiZGF0YXNldCIsInNsaWNlIiwibWluIiwidGVtcFNoaXAiLCJjdXJyZW50IiwidW5GaWxsQ2VsbHMiLCJzZWNvbmQiLCJhbGwiLCJyZW1vdmVCb2FyZFBvaW50ZXIiLCJuZXdHYW1lIiwicmFuZG9taXplU2hpcHNQbGFjZW1lbnQiLCJzcGVlZFZhbHVlIiwic3BlZWQiLCJpbnB1dCIsImNoZWNrZWQiLCJyZW5kZXJCb2FyZCIsImhhbmRsZVVzZXJJbnB1dCIsInVzZXJJbnB1dCIsIm9uY2UiLCJzZXRCb2FyZFBvaW50ZXIiLCJ3aGljaCIsInNldFR1cm5NZXNzYWdlUHZDIiwiaXNQbGF5ZXJUdXJuIiwic2V0VHVybk1lc3NhZ2VDdkMiLCJzZXRHYW1lT3Zlck1lc3NhZ2VQdkMiLCJ3aG8iLCJzZXRHYW1lT3Zlck1lc3NhZ2VDdkMiLCJjb250cm9sbGVyIiwiaHVtYW4iLCJwbGF5ZXIiLCJjb21wdXRlciIsImlzU3RvcHBlZCIsImh1bWFuQ2FycmllciIsImh1bWFuQmF0dGxlc2hpcCIsImh1bWFuRGVzdHJveWVyIiwiaHVtYW5TdWJtYXJpbmUiLCJodW1hblBhdHJvbGJvYXQiLCJwb3B1bGF0ZVNoaXBzIiwiaXNHYW1lT3ZlciIsImNvbXB1dGVyQUkiLCJhbGxTaGlwcyIsInJhbmRvbU9yaWVudGF0aW9uIiwicmFuZG9tUGxhY2VtZW50IiwicGlja0dhbWVNb2RlIiwiaW5pdCJdLCJzb3VyY2VSb290IjoiIn0=