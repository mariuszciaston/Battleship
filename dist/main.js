(()=>{"use strict";const e=()=>{const e=["A","B","C","D","E","F","G","H","I","J"],t=["1","2","3","4","5","6","7","8","9","10"],a=[],o=[],r=(o,r)=>{const s=e.indexOf(o),l=t.indexOf(r);return-1===s||-1===l?null:a[l][s]},s=(o,r,s,l)=>{const i=e.indexOf(o),n=t.indexOf(r);return-1===i||-1===n?null:(a[n][i].status=s,l&&(a[n][i].takenBy=l),a[n][i])};return(()=>{for(let o=0;o<10;o+=1){a[o]=[];for(let r=0;r<10;r+=1)a[o][r]={col:e[r],row:t[o],status:"empty",takenBy:null}}})(),{clearBoard:()=>{for(let e=0;e<10;e+=1)for(let t=0;t<10;t+=1)a[e][t].status="empty",a[e][t].takenBy=void 0;o.length=0},getCell:r,setCell:s,removeShip:(e,t)=>{t.array.flat().forEach((a=>{let r;"taken"===a.status&&a.takenBy.name===e.name&&(a.status="empty",a.takenBy=null),o.forEach((e=>{null===e.takenBy&&o.splice(o.indexOf(e),1)})),t===n.humanGameboard?r="firstBoard":t===n.computerGameboard&&(r="secondBoard");document.querySelectorAll(`#${r} .cell`).forEach((t=>{t.classList.contains("taken")&&t.getAttribute("data-shipName")===e.name.toLowerCase()&&(t.classList.remove("taken"),t.classList.add("empty"),t.removeAttribute("data-shipName"))}))}))},placeShip:(a,l,i,n)=>{a.isVertical="horizontal"!==n;const c="horizontal"===n,d=c?e:t,u=d.indexOf(c?l:i);let h=[];if(u<0||u+a.size>d.length)return!1;for(let e=0;e<a.size;e+=1){const t=c?d[u+e]:l,o=c?i:d[u+e];if("empty"!==r(t,o).status)return!1;s(t,o,"taken",a),h.push(r(t,o))}return o.push(h[0]),!0},receiveAttack:(e,t)=>{const a=r(e,t);return"taken"===a.status?(a.takenBy.hit(),s(e,t,"hit"),a.status):"empty"===a.status||"reserved"===a.status?(s(e,t,"miss"),a.status):null},receiveAround:(e,t)=>{const a=r(e,t);return"empty"===a.status?(s(e,t,"reserved"),a.status):null},reserveSpace:(e,t,a)=>{const o=e.getCell(t,a);if(o&&o.takenBy){e.array.flat().filter((e=>e.takenBy&&e.takenBy.name===o.takenBy.name)).forEach((t=>{[{col:0,row:-1},{col:0,row:1},{col:-1,row:0},{col:1,row:0},{col:-1,row:-1},{col:-1,row:1},{col:1,row:-1},{col:1,row:1}].forEach((a=>{const o=String.fromCharCode(t.col.charCodeAt(0)+a.col),r=(Number(t.row)+a.row).toString();e.getCell(o,r)&&e.receiveAround(o,r)}))}))}},hitButNotSunk:e=>e.array.flat().some((e=>"hit"===e.status&&!1===e.takenBy.isSunk())),sinkShip:(e,t,a)=>{const o=e.getCell(t,a);if(o&&o.takenBy&&o.takenBy.isSunk()){e.array.flat().filter((e=>e.takenBy&&e.takenBy.name===o.takenBy.name)).forEach((t=>{[{col:0,row:-1},{col:0,row:1},{col:-1,row:0},{col:1,row:0},{col:-1,row:-1},{col:-1,row:1},{col:1,row:-1},{col:1,row:1}].forEach((a=>{const o=String.fromCharCode(t.col.charCodeAt(0)+a.col),r=(Number(t.row)+a.row).toString();e.getCell(o,r)&&e.receiveAttack(o,r)}))}))}},allSunk:e=>{let t=e.array.flat().filter((e=>e.takenBy));return!!(t.length>0&&t.every((e=>e.takenBy.isSunk())))},array:a,canBePlaced:(a,o,s,l)=>{const i="horizontal"===l,n=i?e:t,c=n.indexOf(i?o:s);if(c<0||c+a>n.length)return!1;const d=[];for(let e=0;e<a;e+=1){const t=i?n[c+e]:o,a=i?s:n[c+e];d.push("empty"===r(t,a).status)}return d.every((e=>!0===e))},shipsPlaced:o,removeReservedSpace:e=>{e.array.flat().forEach((e=>{"reserved"===e.status&&s(e.col,e.row,"empty")}))}}},t=e=>{let t;return"Carrier"===e&&(t=5),"Battleship"===e&&(t=4),"Destroyer"===e&&(t=3),"Submarine"===e&&(t=3),"PatrolBoat"===e&&(t=2),{name:e,size:t,hitCount:0,isVertical:!1,rotate(){this.isVertical=!this.isVertical},hit(){this.hitCount+=1},isSunk(){return this.hitCount===t}}},a=()=>{const e=["A","B","C","D","E","F","G","H","I","J"];let t=null,a=null;let o=1,r=!0,s=!0;const l=(e,t,c,d)=>{if(console.log("start finishingAttack prevHit",d),console.log("start finishingAttack lastHit",{col:t,row:c}),d.row===c)if(r){o=1,console.log("goRight");let s=String.fromCharCode(t.charCodeAt(0)+o);for(;e.getCell(s,c)&&"hit"===e.getCell(s,c).status;)o+=1,s=String.fromCharCode(t.charCodeAt(0)+o);e.getCell(s,c)&&"hit"!==e.getCell(s,c).status&&"miss"!==e.getCell(s,c).status?(e.receiveAttack(s,c),"hit"===e.getCell(s,c).status&&(i(a),n({col:s,row:c})),console.log("prevHit",d),console.log("lastHit",a),console.log("range",o),console.log("---------------"),o+=1):(o=1,r=!1,l(e,s,c,d))}else{o=1,console.log("goLeft");let s=String.fromCharCode(t.charCodeAt(0)-o);for(;e.getCell(s,c)&&"hit"===e.getCell(s,c).status;)o+=1,s=String.fromCharCode(t.charCodeAt(0)-o);e.getCell(s,c)&&"hit"!==e.getCell(s,c).status&&"miss"!==e.getCell(s,c).status?(e.receiveAttack(s,c),"hit"===e.getCell(s,c).status&&(i(a),n({col:s,row:c})),console.log("prevHit",d),console.log("lastHit",a),console.log("range",o),console.log("---------------"),o+=1):(o=1,r=!0,l(e,s,c,d))}else if(d.col===t)if(s){o=1,console.log("goDown");let r=(Number(c)+o).toString();for(;e.getCell(t,r)&&"hit"===e.getCell(t,r).status;)o+=1,r=(Number(c)+o).toString();e.getCell(t,r)&&"hit"!==e.getCell(t,r).status&&"miss"!==e.getCell(t,r).status?(e.receiveAttack(t,r),"hit"===e.getCell(t,r).status&&(i(a),n({col:t,row:r})),console.log("prevHit",d),console.log("lastHit",a),console.log("range",o),console.log("---------------"),o+=1):(o=1,s=!1,l(e,t,r,d))}else{o=1,console.log("goUp");let r=(Number(c)-o).toString();for(;e.getCell(t,r)&&"hit"===e.getCell(t,r).status;)o+=1,r=(Number(c)-o).toString();e.getCell(t,r)&&"hit"!==e.getCell(t,r).status&&"miss"!==e.getCell(t,r).status?(e.receiveAttack(t,r),"hit"===e.getCell(t,r).status&&(i(a),n({col:t,row:r})),console.log("prevHit",d),console.log("lastHit",a),console.log("range",o),console.log("---------------"),o+=1):(o=1,s=!0,l(e,t,r,d))}},i=e=>{t=e},n=e=>{a=e};return{attack:(e,t,o)=>{if("hit"!==e.getCell(t,o).status&&"miss"!==e.getCell(t,o).status){let r=e.receiveAttack(t,o);return"hit"===r&&(i(a),n({col:t,row:o})),r}return"already shot"},randomAttack:r=>{let s,l;do{s=e[Math.floor(Math.random()*e.length)],l=Math.ceil(10*Math.random()).toString()}while("hit"===r.getCell(s,l).status||"miss"===r.getCell(s,l).status);if("hit"!==r.getCell(s,l).status&&"miss"!==r.getCell(s,l).status){const e=r.receiveAttack(s,l);return"hit"===r.getCell(s,l).status&&(i(a),n({col:s,row:l}),console.log("---------------"),console.log("randomAttack prevHit",t),console.log("randomAttack lastHit",a),console.log("randomAttack range",o)),{result:e,col:s,row:l}}return{result:"already shot",col:s,row:l}},followupAttack:(e,r,s)=>{const l=[{col:0,row:-1},{col:0,row:1},{col:-1,row:0},{col:1,row:0}].filter((t=>{const a=String.fromCharCode(r.charCodeAt(0)+t.col),o=(Number(s)+t.row).toString(),l=e.getCell(a,o);return!(!l||"miss"===l.status||"hit"===l.status)}));if(l.length>0){const c=l[Math.floor(Math.random()*l.length)],d=String.fromCharCode(r.charCodeAt(0)+c.col),u=(Number(s)+c.row).toString();e.receiveAttack(d,u),o=1,"hit"===e.getCell(d,u).status&&(i(a),n({col:d,row:u}),console.log("---------------"),console.log("followupAttack prevHit",t),console.log("followupAttack lastHit",a),console.log("followupAttack range",o))}else console.log("Nie ma dostępnych kierunków do ataku")},finishingAttack:l,prevHit:t,lastHit:a,getPrevHit:()=>t,getLastHit:()=>a,setPrevHit:i,setLastHit:n}};var o=function(e,t,a,o){return new(a||(a=Promise))((function(r,s){function l(e){try{n(o.next(e))}catch(e){s(e)}}function i(e){try{n(o.throw(e))}catch(e){s(e)}}function n(e){var t;e.done?r(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,i)}n((o=o.apply(e,t||[])).next())}))};const r=(()=>{const e=document.querySelector("#boards"),t=document.querySelector("#playerVsComputer"),a=document.querySelector("#newGame"),r=document.querySelector("#computerVsComputer"),s=document.querySelector("#start"),l=document.querySelector("#randomPlacement"),i=[t,a,r,s,l],c=(e,t)=>{e.array.forEach((e=>{e.forEach((e=>{const a=(e=>{const t=document.createElement("div");return t.classList.add("cell"),t.classList.add(e.status),t.setAttribute("data-col",e.col),t.setAttribute("data-row",e.row),e.takenBy&&t.setAttribute("data-shipName",e.takenBy.name.toLowerCase()),t})(e);t.append(a)}))}))},d=e=>{let t;e===n.humanGameboard?t="firstBoard":e===n.computerGameboard&&(t="secondBoard");const a=document.querySelector(`#${t}`);a.innerHTML="",c(e,a)},u=e=>{if(!e.target.classList.contains("hit")&&!e.target.classList.contains("miss")){return{col:e.target.getAttribute("data-col"),row:e.target.getAttribute("data-row")}}},h=(e,a)=>{a.classList.remove("selected"),e.classList.contains("selected")||(e.classList.add("selected"),e===t&&o(void 0,void 0,void 0,(function*(){m(!0),i.forEach((e=>e.disabled=!0)),t.textContent="Restarting...",yield new Promise((e=>setTimeout(e,1e3))),t.textContent="Player vs Computer",i.forEach((e=>e.disabled=!1)),m(!1)})),e===r&&o(void 0,void 0,void 0,(function*(){m(!0),i.forEach((e=>e.disabled=!0)),r.textContent="Starting...",yield new Promise((e=>setTimeout(e,1e3))),r.textContent="Computer vs Computer",i.forEach((e=>e.disabled=!1)),m(!1),s.disabled=!0,l.disabled=!0})),n.restart())},m=e=>{document.documentElement.classList.toggle("wait",e)},f=(e,t)=>{t.forEach((t=>{const a=document.createElement("div"),o=t.takenBy.name.toLowerCase(),r=t.takenBy.size,s=t.takenBy.isVertical;a.classList.add("ship",o),a.setAttribute("data-size",`${r}`),a.setAttribute("data-name",`${o}`),a.setAttribute("draggable","true"),a.classList.add("draggable");const l=()=>{s?s&&(a.style.width=n/16+"rem",a.style.height=r*(n/16)+"rem"):(a.style.width=r*(n/16)+"rem",a.style.height=n/16+"rem")};let i,n=document.querySelector(".board .cell").getBoundingClientRect().width;l(),window.addEventListener("resize",(function(){n=document.querySelector(".board .cell").getBoundingClientRect().width,l()})),"first"===e?i="firstBoard":"second"===e&&(i="secondBoard");document.querySelector(`#${i} .cell[data-col="${t.col}"][data-row="${t.row}"]`).appendChild(a)}))},g=()=>{5===n.humanGameboard.shipsPlaced.length&&0===n.computerGameboard.shipsPlaced.length?s.disabled=!1:s.disabled=!0},p=(e,t,a)=>{let r,s,l,i,c=0,u=0,h=[];const m={carrier:a[0],battleship:a[1],destroyer:a[2],submarine:a[3],patrolboat:a[4]},v=document.querySelector("#firstBoard"),w=document.querySelector("#secondBoard"),S=v.querySelectorAll(".cell"),y=w.querySelectorAll(".cell"),B=[];for(let e of S)e.classList.contains("taken")||B.push(e);for(let e of y)e.classList.contains("taken")||B.push(e);document.querySelectorAll(".draggable").forEach((e=>{e.addEventListener("mousedown",k),e.addEventListener("mouseup",L),e.addEventListener("dragstart",b),e.addEventListener("dragend",H),e.addEventListener("contextmenu",G),B.forEach((e=>{e.addEventListener("contextmenu",V)}))}));let C=null;function k(a){e.removeReservedSpace(e),t.removeReservedSpace(t);const o=a.target.getAttribute("data-name");let r=e.shipsPlaced.filter((e=>o!==e.takenBy.name.toLowerCase())),s=t.shipsPlaced.filter((e=>o!==e.takenBy.name.toLowerCase()));r.forEach((t=>{e.reserveSpace(e,t.col,t.row)})),s.forEach((e=>{t.reserveSpace(t,e.col,e.row)})),d(e),d(t),f("first",e.shipsPlaced),f("second",t.shipsPlaced),p(e,t,n.humanShips)}function L(){e.shipsPlaced.forEach((t=>{e.reserveSpace(e,t.col,t.row)})),t.shipsPlaced.forEach((e=>{t.reserveSpace(t,e.col,e.row)})),d(e),d(t),f("first",e.shipsPlaced),f("second",t.shipsPlaced),p(e,t,n.humanShips)}function b(a){return o(this,void 0,void 0,(function*(){yield new Promise((e=>setTimeout(e,0)));const o=a.target;o.style.visibility="hidden",this.classList.add("dragging"),r=o.getAttribute("data-name"),s=Number(o.getAttribute("data-size")),c=a.offsetX,u=a.offsetY,l=m[r],i=l.isVertical?"vertical":"horizontal","firstBoard"===o.closest(".board").id&&e.removeShip(l,e),"secondBoard"===o.closest(".board").id&&t.removeShip(l,t)}))}function A(e){return function(t){const a=t.target;if("firstBoard"===a.closest(".board").id&&(t.preventDefault(),l)){let t=e-(l.isVertical?10*Math.floor(u/this.offsetHeight):Math.floor(c/this.offsetWidth));const a=[];for(let e=0;e<s;e++){let o=l.isVertical?t+10*e:t+e;S[o]&&(a.push(S[o]),h.push(S[o]))}z(a)&&(a.forEach((e=>{e.classList.add("highlight")})),C||(C=q(h,s)))}if("secondBoard"===a.closest(".board").id&&(t.preventDefault(),l)){let t=e-(l.isVertical?10*Math.floor(u/this.offsetHeight):Math.floor(c/this.offsetWidth));const a=[];for(let e=0;e<s;e++){let o=l.isVertical?t+10*e:t+e;y[o]&&(a.push(y[o]),h.push(y[o]))}z(a)&&(a.forEach((e=>{e.classList.add("highlight")})),C||(C=q(h,s)))}}}function P(){h.forEach((e=>{e.classList.remove("highlight")})),h=[]}function E(a){h.forEach((e=>{e.classList.remove("highlight")}));const o=q(h,s),r=a.target;"firstBoard"===r.closest(".board").id&&l&&null!==C&&(e.canBePlaced(l.size,o[0].dataset.col,o[0].dataset.row,i)?(e.placeShip(l,o[0].dataset.col,o[0].dataset.row,i),e.reserveSpace(e,o[0].dataset.col,o[0].dataset.row)):(e.placeShip(l,C[0].dataset.col,C[0].dataset.row,i),e.reserveSpace(e,C[0].dataset.col,C[0].dataset.row))),"secondBoard"===r.closest(".board").id&&l&&null!==C&&(t.canBePlaced(l.size,o[0].dataset.col,o[0].dataset.row,i)?(t.placeShip(l,o[0].dataset.col,o[0].dataset.row,i),t.reserveSpace(t,o[0].dataset.col,o[0].dataset.row)):(t.placeShip(l,C[0].dataset.col,C[0].dataset.row,i),t.reserveSpace(t,C[0].dataset.col,C[0].dataset.row))),e.removeReservedSpace(e),t.removeReservedSpace(t),e.shipsPlaced.forEach((t=>{e.reserveSpace(e,t.col,t.row)})),t.shipsPlaced.forEach((e=>{t.reserveSpace(t,e.col,e.row)})),d(e),d(t),f("first",e.shipsPlaced),f("second",t.shipsPlaced),p(e,t,n.humanShips),g(),C=null}function H(a){const o=a.target;o.style.visibility="visible",this.classList.remove("dragging"),0===h.length&&("firstBoard"===o.closest(".board").id?C&&e.canBePlaced(l.size,C[0].dataset.col,C[0].dataset.row,i)&&(e.placeShip(l,C[0].dataset.col,C[0].dataset.row,i),e.reserveSpace(e,C[0].dataset.col,C[0].dataset.row),d(e),d(t),f("first",e.shipsPlaced),f("second",t.shipsPlaced),p(e,t,n.humanShips)):"secondBoard"===o.closest(".board").id&&C&&t.canBePlaced(l.size,C[0].dataset.col,C[0].dataset.row,i)&&(t.placeShip(l,C[0].dataset.col,C[0].dataset.row,i),t.reserveSpace(t,C[0].dataset.col,C[0].dataset.row),d(e),d(t),f("first",e.shipsPlaced),f("second",t.shipsPlaced),p(e,t,n.humanShips)))}function z(e){return e.every((e=>e.classList.contains("empty")))&&(e.every((t=>t.dataset.col===e[0].dataset.col))||e.every((t=>t.dataset.row===e[0].dataset.row)))&&e.length===s&&e.every((e=>e.dataset.col>="A"&&e.dataset.col<="J"))&&e.every((e=>Number(e.dataset.row)>=1&&Number(e.dataset.row)<=10))}function q(e,t){return e.slice(Math.min(e.length-t,0))}function G(a){a.preventDefault();const o=a.target;let c;"firstBoard"===o.closest(".board").id&&(c=e),"secondBoard"===o.closest(".board").id&&(c=t),r=o.getAttribute("data-name"),s=Number(o.getAttribute("data-size")),l=m[r];const u=l,h=c.shipsPlaced.filter((e=>e.takenBy.name.toLowerCase()===r));c.removeShip(l,c),c.removeReservedSpace(c),c.shipsPlaced.forEach((e=>{c.reserveSpace(c,e.col,e.row)})),u.rotate(),i=u.isVertical?"vertical":"horizontal",c.canBePlaced(u.size,h[0].col,h[0].row,i)||(u.rotate(),i=u.isVertical?"vertical":"horizontal"),c.placeShip(u,h[0].col,h[0].row,i),c.shipsPlaced.forEach((e=>{c.reserveSpace(c,e.col,e.row)})),d(c),f("first",e.shipsPlaced),f("second",t.shipsPlaced),p(e,t,n.humanShips)}function V(e){e.preventDefault()}S.forEach(((e,t)=>{e.addEventListener("dragover",A(t)),e.addEventListener("dragleave",P),e.addEventListener("drop",E)})),y.forEach(((e,t)=>{e.addEventListener("dragover",A(t)),e.addEventListener("dragleave",P),e.addEventListener("drop",E)}))};return t.addEventListener("click",(()=>{h(t,r);document.querySelector("#secondBoard").classList.remove("start")})),r.addEventListener("click",(()=>{h(r,t);const e=document.querySelector("#secondBoard");e.classList.remove("hide"),e.classList.add("start")})),a.addEventListener("click",(()=>o(void 0,void 0,void 0,(function*(){yield o(void 0,void 0,void 0,(function*(){m(!0),i.forEach((e=>e.disabled=!0)),a.textContent="Restarting...",yield n.newGame(),a.textContent="New Game",i.forEach((e=>e.disabled=!1)),m(!1),g()}));const e=document.querySelector("#secondBoard");e.classList.remove("hide"),t.classList.contains("selected")&&e.classList.remove("start"),r.classList.contains("selected")&&(e.classList.add("start"),l.disabled=!0)})))),s.addEventListener("click",(()=>{n.start();document.querySelector("#firstBoard").classList.add("hide");const e=document.querySelector("#secondBoard");e.classList.add("hide"),e.classList.add("start"),s.disabled=!0,l.disabled=!0})),l.addEventListener("click",(()=>{n.computerGameboard.clearBoard(),d(n.computerGameboard),n.randomizeShipsPlacement("first",n.humanGameboard),p(n.humanGameboard,n.computerGameboard,n.humanShips),g()})),{renderBoard:t=>{const a=document.createElement("div");a.classList.add("board"),t===n.humanGameboard?a.id="firstBoard":t===n.computerGameboard&&(a.id="secondBoard"),c(t,a),e.append(a)},refreshBoard:d,handleUserInput:()=>o(void 0,void 0,void 0,(function*(){const e=document.querySelectorAll("#secondBoard .cell");let t;do{t=yield new Promise((t=>{e.forEach((e=>{e.classList.contains("hit")||e.classList.contains("miss")||e.addEventListener("click",(e=>{t(u(e))}),{once:!0})}))}))}while(!t);return{col:t.col.toString(),row:t.row.toString()}})),pVcBtn:t,cVcBtn:r,waiting:m,setBoardPointer:e=>{const t=document.querySelector("#secondBoard");"player"===e?t.classList.add("boardOutline"):"computer"===e&&t.classList.remove("boardOutline")},removeBoardPointer:()=>{document.querySelector("#secondBoard").classList.remove("boardOutline")},createShipOverlay:f,dragAndDrop:p,canBeStarted:g}})(),s=r;var l=function(e,t,a,o){return new(a||(a=Promise))((function(r,s){function l(e){try{n(o.next(e))}catch(e){s(e)}}function i(e){try{n(o.throw(e))}catch(e){s(e)}}function n(e){var t;e.done?r(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,i)}n((o=o.apply(e,t||[])).next())}))};const i=(()=>{const o=e(),r=e(),n=a(),c=a();let d=!0,u=t("Carrier"),h=t("Battleship"),m=t("Destroyer"),f=t("Submarine"),g=t("PatrolBoat");const p=[u,h,m,f,g],v=()=>{r.placeShip(u,"A","1","horizontal"),r.placeShip(h,"A","3","horizontal"),r.placeShip(m,"A","5","horizontal"),r.placeShip(f,"A","7","horizontal"),r.placeShip(g,"A","9","horizontal"),r.reserveSpace(r,"A","1"),r.reserveSpace(r,"A","3"),r.reserveSpace(r,"A","5"),r.reserveSpace(r,"A","7"),r.reserveSpace(r,"A","9")},w=()=>(r.allSunk(r)||!!o.allSunk(o))&&(s.removeBoardPointer(),!0),S=e=>{let t;if(e===o?t=c:e===r&&(t=n),e.hitButNotSunk(e)){if(null!==t.getPrevHit()&&null!==t.getLastHit()&&e.getCell(t.getLastHit().col,t.getLastHit().row).takenBy.hitCount>=2&&e.getCell(t.getLastHit().col,t.getLastHit().row).takenBy.hitCount<=4){if(t.finishingAttack(e,t.getLastHit().col,t.getLastHit().row,t.getPrevHit()),e.sinkShip(e,t.getLastHit().col,t.getLastHit().row),w())return}else if(1===e.getCell(t.getLastHit().col,t.getLastHit().row).takenBy.hitCount&&(t.followupAttack(e,t.getLastHit().col,t.getLastHit().row),e.sinkShip(e,t.getLastHit().col,t.getLastHit().row),w()))return}else{const{col:a,row:o}=t.randomAttack(e);if("hit"===e.getCell(a,o).status&&(t.setPrevHit(t.getLastHit()),t.setLastHit({col:a,row:o})),"hit"===e.getCell(a,o).status&&e.getCell(a,o).takenBy.isSunk()&&(e.sinkShip(e,a,o),t.setPrevHit(null),t.setLastHit(null),w()))return}},y=(e,a)=>{a.clearBoard(),(e=>{let a;e===o?(u=t("Carrier"),h=t("Battleship"),m=t("Destroyer"),f=t("Submarine"),g=t("PatrolBoat"),a=[u,h,m,f,g]):e===r&&(a=[t("Carrier"),t("Battleship"),t("Destroyer"),t("Submarine"),t("PatrolBoat")]);i.humanShips.length=0;const s=["A","B","C","D","E","F","G","H","I","J"],l=()=>s[Math.floor(Math.random()*s.length)],n=()=>Math.ceil(10*Math.random()).toString(),c=()=>Math.random()>.5?"horizontal":"vertical";a.forEach((t=>{let a=l(),o=n(),r=c(),s=e.canBePlaced(t.size,a,o,r);for(;!s;)a=l(),o=n(),r=c(),s=e.canBePlaced(t.size,a,o,r);s&&(e.placeShip(t,a,o,r),e.reserveSpace(e,a,o)),i.humanShips.push(t)}))})(a),s.refreshBoard(a),"first"===e&&s.createShipOverlay("first",a.shipsPlaced)},B=()=>{s.cVcBtn.classList.contains("selected")&&(y("first",o),y("second",r),d=!1,l(void 0,void 0,void 0,(function*(){s.removeBoardPointer();let e=!0;for(;!w()&&!d;){if(s.waiting(!0),e){if(yield new Promise((e=>setTimeout(e,1e3))),!s.cVcBtn.classList.contains("selected")||d)break;S(o),s.refreshBoard(o),e=!1}if(w()||d)break;if(!e){if(yield new Promise((e=>setTimeout(e,1e3))),!s.cVcBtn.classList.contains("selected")||d)break;S(r),s.refreshBoard(r),e=!0}}d=!1,s.waiting(!1)})),s.refreshBoard(o))},C=()=>{d=!0,n.setPrevHit(null),n.setLastHit(null),c.setPrevHit(null),c.setLastHit(null),o.clearBoard(),r.clearBoard(),v(),s.refreshBoard(o),s.refreshBoard(r),s.createShipOverlay("second",r.shipsPlaced),s.dragAndDrop(o,r,p),s.canBeStarted(),B()};return{init:()=>{s.renderBoard(o),s.renderBoard(r),v(),s.refreshBoard(r),s.createShipOverlay("second",r.shipsPlaced),s.dragAndDrop(o,r,p),s.canBeStarted(),B()},humanGameboard:o,computerGameboard:r,restart:C,newGame:()=>l(void 0,void 0,void 0,(function*(){d=!0,yield new Promise((e=>setTimeout(e,1e3))),d=!1,C()})),start:()=>{s.refreshBoard(o),y("second",r),d=!1,l(void 0,void 0,void 0,(function*(){let e=!0;for(;!w()&&!d;){if(e){s.setBoardPointer("player"),s.waiting(!1);const{col:t,row:a}=yield s.handleUserInput();n.attack(r,t,a),r.sinkShip(r,t,a),s.refreshBoard(r),e=!1}if(w()||d)break;if(!e){if(s.setBoardPointer("computer"),s.waiting(!0),yield new Promise((e=>setTimeout(e,1e3))),!s.pVcBtn.classList.contains("selected")||d)break;S(o),s.refreshBoard(o),e=!0}}d=!1,s.waiting(!1)}))},randomizeShipsPlacement:y,humanShips:p}})(),n=i;n.init()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQUdxSSxhQUFhNUcsR0FDaEI4TixHQUFlLENBQ25CLENBQ0EsR0FBSU4sS0FBZ0JQLEVBQ2hCLE1BRUosSUFBS2EsRUFBYyxDQUlmLEdBSEEsRUFBR3BCLGdCQUFnQixZQUNuQixFQUFHdkYsU0FBUSxTQUNMLElBQUluQyxTQUFTQyxHQUFZc0MsV0FBV3RDLEVBQVMsUUFDOUMsRUFBR2MsT0FBTzVGLFVBQVVDLFNBQVMsYUFBZTZNLEVBQzdDLE1BRUpRLEVBQVcxTixHQUNYLEVBQUc2RyxhQUFhN0csR0FDaEIrTixHQUFlLENBQ25CLENBQ0osQ0FDQWIsR0FBWSxFQUNaLEVBQUc5RixTQUFRLEVBQ2YsR0E2RjBCLEVBa0NpRGtGLDBCQUF5QjNCLGFBQ3ZHLEVBOU9rQixHQStPbkIsSUN6UEEsRUFBV3FELE0iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL21vZHVsZXMvZ2FtZWJvYXJkLnRzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvbW9kdWxlcy9zaGlwLnRzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvbW9kdWxlcy9wbGF5ZXIudHMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9tb2R1bGVzL3VpLnRzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvbW9kdWxlcy9jb250cm9sbGVyLnRzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNvbnRyb2xsZXIgZnJvbSAnLi9jb250cm9sbGVyJztcbmNvbnN0IGdhbWVib2FyZEZhY3RvcnkgPSAoKSA9PiB7XG4gICAgY29uc3QgY29scyA9IFsnQScsICdCJywgJ0MnLCAnRCcsICdFJywgJ0YnLCAnRycsICdIJywgJ0knLCAnSiddO1xuICAgIGNvbnN0IHJvd3MgPSBbJzEnLCAnMicsICczJywgJzQnLCAnNScsICc2JywgJzcnLCAnOCcsICc5JywgJzEwJ107XG4gICAgY29uc3QgYXJyYXkgPSBbXTtcbiAgICBjb25zdCBzaGlwc1BsYWNlZCA9IFtdO1xuICAgIGNvbnN0IGdlbmVyYXRlQXJyYXkgPSAoKSA9PiB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkgKz0gMSkge1xuICAgICAgICAgICAgYXJyYXlbaV0gPSBbXTtcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTA7IGogKz0gMSkge1xuICAgICAgICAgICAgICAgIGFycmF5W2ldW2pdID0geyBjb2w6IGNvbHNbal0sIHJvdzogcm93c1tpXSwgc3RhdHVzOiAnZW1wdHknLCB0YWtlbkJ5OiBudWxsIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IGNsZWFyQm9hcmQgPSAoKSA9PiB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkgKz0gMSkge1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAxMDsgaiArPSAxKSB7XG4gICAgICAgICAgICAgICAgYXJyYXlbaV1bal0uc3RhdHVzID0gJ2VtcHR5JztcbiAgICAgICAgICAgICAgICBhcnJheVtpXVtqXS50YWtlbkJ5ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHNoaXBzUGxhY2VkLmxlbmd0aCA9IDA7XG4gICAgfTtcbiAgICBjb25zdCBnZXRDZWxsID0gKGNvbCwgcm93KSA9PiB7XG4gICAgICAgIGNvbnN0IGNvbEluZGV4ID0gY29scy5pbmRleE9mKGNvbCk7XG4gICAgICAgIGNvbnN0IHJvd0luZGV4ID0gcm93cy5pbmRleE9mKHJvdyk7XG4gICAgICAgIGlmIChjb2xJbmRleCA9PT0gLTEgfHwgcm93SW5kZXggPT09IC0xKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXJyYXlbcm93SW5kZXhdW2NvbEluZGV4XTtcbiAgICB9O1xuICAgIGNvbnN0IHNldENlbGwgPSAoY29sLCByb3csIG5ld1N0YXR1cywgbmV3VGFrZW5CeSkgPT4ge1xuICAgICAgICBjb25zdCBjb2xJbmRleCA9IGNvbHMuaW5kZXhPZihjb2wpO1xuICAgICAgICBjb25zdCByb3dJbmRleCA9IHJvd3MuaW5kZXhPZihyb3cpO1xuICAgICAgICBpZiAoY29sSW5kZXggPT09IC0xIHx8IHJvd0luZGV4ID09PSAtMSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgYXJyYXlbcm93SW5kZXhdW2NvbEluZGV4XS5zdGF0dXMgPSBuZXdTdGF0dXM7XG4gICAgICAgIGlmIChuZXdUYWtlbkJ5KSB7XG4gICAgICAgICAgICBhcnJheVtyb3dJbmRleF1bY29sSW5kZXhdLnRha2VuQnkgPSBuZXdUYWtlbkJ5O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcnJheVtyb3dJbmRleF1bY29sSW5kZXhdO1xuICAgIH07XG4gICAgY29uc3QgcmVtb3ZlU2hpcCA9IChzaGlwLCBnYW1lYm9hcmQpID0+IHtcbiAgICAgICAgY29uc3QgZ2FtZWJvYXJkQ2VsbHMgPSBnYW1lYm9hcmQuYXJyYXkuZmxhdCgpO1xuICAgICAgICBnYW1lYm9hcmRDZWxscy5mb3JFYWNoKChjZWxsKSA9PiB7XG4gICAgICAgICAgICBpZiAoY2VsbC5zdGF0dXMgPT09ICd0YWtlbicgJiYgY2VsbC50YWtlbkJ5Lm5hbWUgPT09IHNoaXAubmFtZSkge1xuICAgICAgICAgICAgICAgIGNlbGwuc3RhdHVzID0gJ2VtcHR5JztcbiAgICAgICAgICAgICAgICBjZWxsLnRha2VuQnkgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2hpcHNQbGFjZWQuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChzaGlwLnRha2VuQnkgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgc2hpcHNQbGFjZWQuc3BsaWNlKHNoaXBzUGxhY2VkLmluZGV4T2Yoc2hpcCksIDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbGV0IGJvYXJkSWQ7XG4gICAgICAgICAgICBpZiAoZ2FtZWJvYXJkID09PSBjb250cm9sbGVyLmh1bWFuR2FtZWJvYXJkKSB7XG4gICAgICAgICAgICAgICAgYm9hcmRJZCA9ICdmaXJzdEJvYXJkJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGdhbWVib2FyZCA9PT0gY29udHJvbGxlci5jb21wdXRlckdhbWVib2FyZCkge1xuICAgICAgICAgICAgICAgIGJvYXJkSWQgPSAnc2Vjb25kQm9hcmQnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgY2VsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGAjJHtib2FyZElkfSAuY2VsbGApO1xuICAgICAgICAgICAgY2VsbHMuZm9yRWFjaCgoY2VsbCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChjZWxsLmNsYXNzTGlzdC5jb250YWlucygndGFrZW4nKSAmJiBjZWxsLmdldEF0dHJpYnV0ZSgnZGF0YS1zaGlwTmFtZScpID09PSBzaGlwLm5hbWUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5yZW1vdmUoJ3Rha2VuJyk7XG4gICAgICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnZW1wdHknKTtcbiAgICAgICAgICAgICAgICAgICAgY2VsbC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtc2hpcE5hbWUnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBjb25zdCBwbGFjZVNoaXAgPSAoc2hpcCwgY29sLCByb3csIG9yaWVudGF0aW9uKSA9PiB7XG4gICAgICAgIGlmIChvcmllbnRhdGlvbiA9PT0gJ2hvcml6b250YWwnKSB7XG4gICAgICAgICAgICBzaGlwLmlzVmVydGljYWwgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNoaXAuaXNWZXJ0aWNhbCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaXNIb3Jpem9udGFsID0gb3JpZW50YXRpb24gPT09ICdob3Jpem9udGFsJztcbiAgICAgICAgY29uc3QgY2VsbHMgPSBpc0hvcml6b250YWwgPyBjb2xzIDogcm93cztcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBjZWxscy5pbmRleE9mKGlzSG9yaXpvbnRhbCA/IGNvbCA6IHJvdyk7XG4gICAgICAgIGxldCBzaGlwQ2VsbHMgPSBbXTtcbiAgICAgICAgaWYgKHN0YXJ0IDwgMCB8fCBzdGFydCArIHNoaXAuc2l6ZSA+IGNlbGxzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5zaXplOyBpICs9IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRDb2wgPSBpc0hvcml6b250YWwgPyBjZWxsc1tzdGFydCArIGldIDogY29sO1xuICAgICAgICAgICAgY29uc3QgY3VycmVudFJvdyA9IGlzSG9yaXpvbnRhbCA/IHJvdyA6IGNlbGxzW3N0YXJ0ICsgaV07XG4gICAgICAgICAgICBpZiAoZ2V0Q2VsbChjdXJyZW50Q29sLCBjdXJyZW50Um93KS5zdGF0dXMgIT09ICdlbXB0eScpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZXRDZWxsKGN1cnJlbnRDb2wsIGN1cnJlbnRSb3csICd0YWtlbicsIHNoaXApO1xuICAgICAgICAgICAgc2hpcENlbGxzLnB1c2goZ2V0Q2VsbChjdXJyZW50Q29sLCBjdXJyZW50Um93KSk7XG4gICAgICAgIH1cbiAgICAgICAgc2hpcHNQbGFjZWQucHVzaChzaGlwQ2VsbHNbMF0pO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIGNvbnN0IGNhbkJlUGxhY2VkID0gKHNpemUsIGNvbCwgcm93LCBvcmllbnRhdGlvbikgPT4ge1xuICAgICAgICBjb25zdCBpc0hvcml6b250YWwgPSBvcmllbnRhdGlvbiA9PT0gJ2hvcml6b250YWwnO1xuICAgICAgICBjb25zdCBjZWxscyA9IGlzSG9yaXpvbnRhbCA/IGNvbHMgOiByb3dzO1xuICAgICAgICBjb25zdCBzdGFydCA9IGNlbGxzLmluZGV4T2YoaXNIb3Jpem9udGFsID8gY29sIDogcm93KTtcbiAgICAgICAgaWYgKHN0YXJ0IDwgMCB8fCBzdGFydCArIHNpemUgPiBjZWxscy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBhcmVFbXB0eSA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpemU7IGkgKz0gMSkge1xuICAgICAgICAgICAgY29uc3QgY3VycmVudENvbCA9IGlzSG9yaXpvbnRhbCA/IGNlbGxzW3N0YXJ0ICsgaV0gOiBjb2w7XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50Um93ID0gaXNIb3Jpem9udGFsID8gcm93IDogY2VsbHNbc3RhcnQgKyBpXTtcbiAgICAgICAgICAgIGFyZUVtcHR5LnB1c2goZ2V0Q2VsbChjdXJyZW50Q29sLCBjdXJyZW50Um93KS5zdGF0dXMgPT09ICdlbXB0eScpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcmVFbXB0eS5ldmVyeSgoaXRlbSkgPT4gaXRlbSA9PT0gdHJ1ZSk7XG4gICAgfTtcbiAgICBjb25zdCByZWNlaXZlQXR0YWNrID0gKGNvbCwgcm93KSA9PiB7XG4gICAgICAgIGNvbnN0IGNlbGwgPSBnZXRDZWxsKGNvbCwgcm93KTtcbiAgICAgICAgaWYgKGNlbGwuc3RhdHVzID09PSAndGFrZW4nKSB7XG4gICAgICAgICAgICBjZWxsLnRha2VuQnkuaGl0KCk7XG4gICAgICAgICAgICBzZXRDZWxsKGNvbCwgcm93LCAnaGl0Jyk7XG4gICAgICAgICAgICByZXR1cm4gY2VsbC5zdGF0dXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNlbGwuc3RhdHVzID09PSAnZW1wdHknIHx8IGNlbGwuc3RhdHVzID09PSAncmVzZXJ2ZWQnKSB7XG4gICAgICAgICAgICBzZXRDZWxsKGNvbCwgcm93LCAnbWlzcycpO1xuICAgICAgICAgICAgcmV0dXJuIGNlbGwuc3RhdHVzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgY29uc3QgcmVjZWl2ZUFyb3VuZCA9IChjb2wsIHJvdykgPT4ge1xuICAgICAgICBjb25zdCBjZWxsID0gZ2V0Q2VsbChjb2wsIHJvdyk7XG4gICAgICAgIGlmIChjZWxsLnN0YXR1cyA9PT0gJ2VtcHR5Jykge1xuICAgICAgICAgICAgc2V0Q2VsbChjb2wsIHJvdywgJ3Jlc2VydmVkJyk7XG4gICAgICAgICAgICByZXR1cm4gY2VsbC5zdGF0dXM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBjb25zdCByZXNlcnZlU3BhY2UgPSAoZ2FtZWJvYXJkLCBjb2wsIHJvdykgPT4ge1xuICAgICAgICBjb25zdCBjZWxsID0gZ2FtZWJvYXJkLmdldENlbGwoY29sLCByb3cpO1xuICAgICAgICBpZiAoY2VsbCAmJiBjZWxsLnRha2VuQnkpIHtcbiAgICAgICAgICAgIGNvbnN0IHNoaXBDZWxscyA9IGdhbWVib2FyZC5hcnJheS5mbGF0KCkuZmlsdGVyKChjKSA9PiBjLnRha2VuQnkgJiYgYy50YWtlbkJ5Lm5hbWUgPT09IGNlbGwudGFrZW5CeS5uYW1lKTtcbiAgICAgICAgICAgIHNoaXBDZWxscy5mb3JFYWNoKChjZWxsKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGlyZWN0aW9ucyA9IFtcbiAgICAgICAgICAgICAgICAgICAgeyBjb2w6IDAsIHJvdzogLTEgfSxcbiAgICAgICAgICAgICAgICAgICAgeyBjb2w6IDAsIHJvdzogMSB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogLTEsIHJvdzogMCB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogMSwgcm93OiAwIH0sXG4gICAgICAgICAgICAgICAgICAgIHsgY29sOiAtMSwgcm93OiAtMSB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogLTEsIHJvdzogMSB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogMSwgcm93OiAtMSB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogMSwgcm93OiAxIH0sXG4gICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb25zLmZvckVhY2goKGRpcmVjdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdDb2wgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNlbGwuY29sLmNoYXJDb2RlQXQoMCkgKyBkaXJlY3Rpb24uY29sKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3Um93ID0gKE51bWJlcihjZWxsLnJvdykgKyBkaXJlY3Rpb24ucm93KS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCBuZXdSb3cpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnYW1lYm9hcmQucmVjZWl2ZUFyb3VuZChuZXdDb2wsIG5ld1Jvdyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCByZW1vdmVSZXNlcnZlZFNwYWNlID0gKGdhbWVib2FyZCkgPT4ge1xuICAgICAgICBjb25zdCBnYW1lYm9hcmRDZWxscyA9IGdhbWVib2FyZC5hcnJheS5mbGF0KCk7XG4gICAgICAgIGdhbWVib2FyZENlbGxzLmZvckVhY2goKGNlbGwpID0+IHtcbiAgICAgICAgICAgIGlmIChjZWxsLnN0YXR1cyA9PT0gJ3Jlc2VydmVkJykge1xuICAgICAgICAgICAgICAgIHNldENlbGwoY2VsbC5jb2wsIGNlbGwucm93LCAnZW1wdHknKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBjb25zdCBzaW5rU2hpcCA9IChnYW1lYm9hcmQsIGNvbCwgcm93KSA9PiB7XG4gICAgICAgIGNvbnN0IGNlbGwgPSBnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIHJvdyk7XG4gICAgICAgIGlmIChjZWxsICYmIGNlbGwudGFrZW5CeSAmJiBjZWxsLnRha2VuQnkuaXNTdW5rKCkpIHtcbiAgICAgICAgICAgIGNvbnN0IHNoaXBDZWxscyA9IGdhbWVib2FyZC5hcnJheS5mbGF0KCkuZmlsdGVyKChjKSA9PiBjLnRha2VuQnkgJiYgYy50YWtlbkJ5Lm5hbWUgPT09IGNlbGwudGFrZW5CeS5uYW1lKTtcbiAgICAgICAgICAgIHNoaXBDZWxscy5mb3JFYWNoKChjZWxsKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGlyZWN0aW9ucyA9IFtcbiAgICAgICAgICAgICAgICAgICAgeyBjb2w6IDAsIHJvdzogLTEgfSxcbiAgICAgICAgICAgICAgICAgICAgeyBjb2w6IDAsIHJvdzogMSB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogLTEsIHJvdzogMCB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogMSwgcm93OiAwIH0sXG4gICAgICAgICAgICAgICAgICAgIHsgY29sOiAtMSwgcm93OiAtMSB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogLTEsIHJvdzogMSB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogMSwgcm93OiAtMSB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogMSwgcm93OiAxIH0sXG4gICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb25zLmZvckVhY2goKGRpcmVjdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdDb2wgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNlbGwuY29sLmNoYXJDb2RlQXQoMCkgKyBkaXJlY3Rpb24uY29sKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3Um93ID0gKE51bWJlcihjZWxsLnJvdykgKyBkaXJlY3Rpb24ucm93KS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCBuZXdSb3cpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnYW1lYm9hcmQucmVjZWl2ZUF0dGFjayhuZXdDb2wsIG5ld1Jvdyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBoaXRCdXROb3RTdW5rID0gKGdhbWVib2FyZCkgPT4ge1xuICAgICAgICBjb25zdCBnYW1lYm9hcmRDZWxscyA9IGdhbWVib2FyZC5hcnJheS5mbGF0KCk7XG4gICAgICAgIHJldHVybiBnYW1lYm9hcmRDZWxscy5zb21lKChjZWxsKSA9PiB7XG4gICAgICAgICAgICBpZiAoY2VsbC5zdGF0dXMgPT09ICdoaXQnICYmIGNlbGwudGFrZW5CeS5pc1N1bmsoKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBjb25zdCBhbGxTdW5rID0gKGdhbWVib2FyZCkgPT4ge1xuICAgICAgICBjb25zdCBnYW1lYm9hcmRDZWxscyA9IGdhbWVib2FyZC5hcnJheS5mbGF0KCk7XG4gICAgICAgIGxldCB0YWtlbkJ5Q2VsbHMgPSBnYW1lYm9hcmRDZWxscy5maWx0ZXIoKGNlbGwpID0+IGNlbGwudGFrZW5CeSk7XG4gICAgICAgIGlmICh0YWtlbkJ5Q2VsbHMubGVuZ3RoID4gMCAmJiB0YWtlbkJ5Q2VsbHMuZXZlcnkoKGNlbGwpID0+IGNlbGwudGFrZW5CeS5pc1N1bmsoKSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBnZW5lcmF0ZUFycmF5KCk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY2xlYXJCb2FyZCxcbiAgICAgICAgZ2V0Q2VsbCxcbiAgICAgICAgc2V0Q2VsbCxcbiAgICAgICAgcmVtb3ZlU2hpcCxcbiAgICAgICAgcGxhY2VTaGlwLFxuICAgICAgICByZWNlaXZlQXR0YWNrLFxuICAgICAgICByZWNlaXZlQXJvdW5kLFxuICAgICAgICByZXNlcnZlU3BhY2UsXG4gICAgICAgIGhpdEJ1dE5vdFN1bmssXG4gICAgICAgIHNpbmtTaGlwLFxuICAgICAgICBhbGxTdW5rLFxuICAgICAgICBhcnJheSxcbiAgICAgICAgY2FuQmVQbGFjZWQsXG4gICAgICAgIHNoaXBzUGxhY2VkLFxuICAgICAgICByZW1vdmVSZXNlcnZlZFNwYWNlLFxuICAgIH07XG59O1xuZXhwb3J0IGRlZmF1bHQgZ2FtZWJvYXJkRmFjdG9yeTtcbiIsImNvbnN0IHNoaXBGYWN0b3J5ID0gKG5hbWUpID0+IHtcbiAgICBsZXQgc2l6ZTtcbiAgICBpZiAobmFtZSA9PT0gJ0NhcnJpZXInKSB7XG4gICAgICAgIHNpemUgPSA1O1xuICAgIH1cbiAgICBpZiAobmFtZSA9PT0gJ0JhdHRsZXNoaXAnKSB7XG4gICAgICAgIHNpemUgPSA0O1xuICAgIH1cbiAgICBpZiAobmFtZSA9PT0gJ0Rlc3Ryb3llcicpIHtcbiAgICAgICAgc2l6ZSA9IDM7XG4gICAgfVxuICAgIGlmIChuYW1lID09PSAnU3VibWFyaW5lJykge1xuICAgICAgICBzaXplID0gMztcbiAgICB9XG4gICAgaWYgKG5hbWUgPT09ICdQYXRyb2xCb2F0Jykge1xuICAgICAgICBzaXplID0gMjtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgc2l6ZSxcbiAgICAgICAgaGl0Q291bnQ6IDAsXG4gICAgICAgIGlzVmVydGljYWw6IGZhbHNlLFxuICAgICAgICByb3RhdGUoKSB7XG4gICAgICAgICAgICB0aGlzLmlzVmVydGljYWwgPSAhdGhpcy5pc1ZlcnRpY2FsO1xuICAgICAgICB9LFxuICAgICAgICBoaXQoKSB7XG4gICAgICAgICAgICB0aGlzLmhpdENvdW50ICs9IDE7XG4gICAgICAgIH0sXG4gICAgICAgIGlzU3VuaygpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmhpdENvdW50ID09PSBzaXplO1xuICAgICAgICB9LFxuICAgIH07XG59O1xuZXhwb3J0IGRlZmF1bHQgc2hpcEZhY3Rvcnk7XG4iLCJjb25zdCBwbGF5ZXJGYWN0b3J5ID0gKCkgPT4ge1xuICAgIGNvbnN0IGNvbHMgPSBbJ0EnLCAnQicsICdDJywgJ0QnLCAnRScsICdGJywgJ0cnLCAnSCcsICdJJywgJ0onXTtcbiAgICBsZXQgcHJldkhpdCA9IG51bGw7XG4gICAgbGV0IGxhc3RIaXQgPSBudWxsO1xuICAgIGNvbnN0IGF0dGFjayA9IChnYW1lYm9hcmQsIGNvbCwgcm93KSA9PiB7XG4gICAgICAgIGlmIChnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIHJvdykuc3RhdHVzICE9PSAnaGl0JyAmJiBnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIHJvdykuc3RhdHVzICE9PSAnbWlzcycpIHtcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSBnYW1lYm9hcmQucmVjZWl2ZUF0dGFjayhjb2wsIHJvdyk7XG4gICAgICAgICAgICBpZiAocmVzdWx0ID09PSAnaGl0Jykge1xuICAgICAgICAgICAgICAgIHNldFByZXZIaXQobGFzdEhpdCk7XG4gICAgICAgICAgICAgICAgc2V0TGFzdEhpdCh7IGNvbDogY29sLCByb3c6IHJvdyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICdhbHJlYWR5IHNob3QnO1xuICAgIH07XG4gICAgY29uc3QgcmFuZG9tQXR0YWNrID0gKGdhbWVib2FyZCkgPT4ge1xuICAgICAgICBsZXQgcmFuZG9tQ29sO1xuICAgICAgICBsZXQgcmFuZG9tUm93O1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICByYW5kb21Db2wgPSBjb2xzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNvbHMubGVuZ3RoKV07XG4gICAgICAgICAgICByYW5kb21Sb3cgPSBNYXRoLmNlaWwoTWF0aC5yYW5kb20oKSAqIDEwKS50b1N0cmluZygpO1xuICAgICAgICB9IHdoaWxlIChnYW1lYm9hcmQuZ2V0Q2VsbChyYW5kb21Db2wsIHJhbmRvbVJvdykuc3RhdHVzID09PSAnaGl0JyB8fCBnYW1lYm9hcmQuZ2V0Q2VsbChyYW5kb21Db2wsIHJhbmRvbVJvdykuc3RhdHVzID09PSAnbWlzcycpO1xuICAgICAgICBpZiAoZ2FtZWJvYXJkLmdldENlbGwocmFuZG9tQ29sLCByYW5kb21Sb3cpLnN0YXR1cyAhPT0gJ2hpdCcgJiYgZ2FtZWJvYXJkLmdldENlbGwocmFuZG9tQ29sLCByYW5kb21Sb3cpLnN0YXR1cyAhPT0gJ21pc3MnKSB7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBnYW1lYm9hcmQucmVjZWl2ZUF0dGFjayhyYW5kb21Db2wsIHJhbmRvbVJvdyk7XG4gICAgICAgICAgICBpZiAoZ2FtZWJvYXJkLmdldENlbGwocmFuZG9tQ29sLCByYW5kb21Sb3cpLnN0YXR1cyA9PT0gJ2hpdCcpIHtcbiAgICAgICAgICAgICAgICBzZXRQcmV2SGl0KGxhc3RIaXQpO1xuICAgICAgICAgICAgICAgIHNldExhc3RIaXQoeyBjb2w6IHJhbmRvbUNvbCwgcm93OiByYW5kb21Sb3cgfSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJy0tLS0tLS0tLS0tLS0tLScpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyYW5kb21BdHRhY2sgcHJldkhpdCcsIHByZXZIaXQpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyYW5kb21BdHRhY2sgbGFzdEhpdCcsIGxhc3RIaXQpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyYW5kb21BdHRhY2sgcmFuZ2UnLCByYW5nZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4geyByZXN1bHQsIGNvbDogcmFuZG9tQ29sLCByb3c6IHJhbmRvbVJvdyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHJlc3VsdDogJ2FscmVhZHkgc2hvdCcsIGNvbDogcmFuZG9tQ29sLCByb3c6IHJhbmRvbVJvdyB9O1xuICAgIH07XG4gICAgY29uc3QgZm9sbG93dXBBdHRhY2sgPSAoZ2FtZWJvYXJkLCBjb2wsIHJvdykgPT4ge1xuICAgICAgICBjb25zdCBkaXJlY3Rpb25zID0gW1xuICAgICAgICAgICAgeyBjb2w6IDAsIHJvdzogLTEgfSxcbiAgICAgICAgICAgIHsgY29sOiAwLCByb3c6IDEgfSxcbiAgICAgICAgICAgIHsgY29sOiAtMSwgcm93OiAwIH0sXG4gICAgICAgICAgICB7IGNvbDogMSwgcm93OiAwIH0sXG4gICAgICAgIF07XG4gICAgICAgIGNvbnN0IHZhbGlkRGlyZWN0aW9ucyA9IGRpcmVjdGlvbnMuZmlsdGVyKChkaXJlY3Rpb24pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5ld0NvbCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoY29sLmNoYXJDb2RlQXQoMCkgKyBkaXJlY3Rpb24uY29sKTtcbiAgICAgICAgICAgIGNvbnN0IG5ld1JvdyA9IChOdW1iZXIocm93KSArIGRpcmVjdGlvbi5yb3cpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICBjb25zdCBjZWxsID0gZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCBuZXdSb3cpO1xuICAgICAgICAgICAgaWYgKGNlbGwgJiYgY2VsbC5zdGF0dXMgIT09ICdtaXNzJyAmJiBjZWxsLnN0YXR1cyAhPT0gJ2hpdCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh2YWxpZERpcmVjdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3QgcmFuZG9tRGlyZWN0aW9uID0gdmFsaWREaXJlY3Rpb25zW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHZhbGlkRGlyZWN0aW9ucy5sZW5ndGgpXTtcbiAgICAgICAgICAgIGNvbnN0IG5ld0NvbCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoY29sLmNoYXJDb2RlQXQoMCkgKyByYW5kb21EaXJlY3Rpb24uY29sKTtcbiAgICAgICAgICAgIGNvbnN0IG5ld1JvdyA9IChOdW1iZXIocm93KSArIHJhbmRvbURpcmVjdGlvbi5yb3cpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICBnYW1lYm9hcmQucmVjZWl2ZUF0dGFjayhuZXdDb2wsIG5ld1Jvdyk7XG4gICAgICAgICAgICByYW5nZSA9IDE7XG4gICAgICAgICAgICBpZiAoZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCBuZXdSb3cpLnN0YXR1cyA9PT0gJ2hpdCcpIHtcbiAgICAgICAgICAgICAgICBzZXRQcmV2SGl0KGxhc3RIaXQpO1xuICAgICAgICAgICAgICAgIHNldExhc3RIaXQoeyBjb2w6IG5ld0NvbCwgcm93OiBuZXdSb3cgfSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJy0tLS0tLS0tLS0tLS0tLScpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdmb2xsb3d1cEF0dGFjayBwcmV2SGl0JywgcHJldkhpdCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2ZvbGxvd3VwQXR0YWNrIGxhc3RIaXQnLCBsYXN0SGl0KTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZm9sbG93dXBBdHRhY2sgcmFuZ2UnLCByYW5nZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnTmllIG1hIGRvc3TEmXBueWNoIGtpZXJ1bmvDs3cgZG8gYXRha3UnKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgbGV0IHJhbmdlID0gMTtcbiAgICBsZXQgZ29SaWdodCA9IHRydWU7XG4gICAgbGV0IGdvRG93biA9IHRydWU7XG4gICAgY29uc3QgZmluaXNoaW5nQXR0YWNrID0gKGdhbWVib2FyZCwgY29sLCByb3csIHByZXZIaXQpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ3N0YXJ0IGZpbmlzaGluZ0F0dGFjayBwcmV2SGl0JywgcHJldkhpdCk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdzdGFydCBmaW5pc2hpbmdBdHRhY2sgbGFzdEhpdCcsIHsgY29sLCByb3cgfSk7XG4gICAgICAgIGlmIChwcmV2SGl0LnJvdyA9PT0gcm93KSB7XG4gICAgICAgICAgICAvLyBob3Jpem9udGFsIHNoaXAgY2FzZVxuICAgICAgICAgICAgaWYgKGdvUmlnaHQpIHtcbiAgICAgICAgICAgICAgICByYW5nZSA9IDE7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2dvUmlnaHQnKTtcbiAgICAgICAgICAgICAgICBsZXQgbmV3Q29sID0gU3RyaW5nLmZyb21DaGFyQ29kZShjb2wuY2hhckNvZGVBdCgwKSArIHJhbmdlKTtcbiAgICAgICAgICAgICAgICB3aGlsZSAoZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCByb3cpICYmIGdhbWVib2FyZC5nZXRDZWxsKG5ld0NvbCwgcm93KS5zdGF0dXMgPT09ICdoaXQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NvbCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoY29sLmNoYXJDb2RlQXQoMCkgKyByYW5nZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChnYW1lYm9hcmQuZ2V0Q2VsbChuZXdDb2wsIHJvdykgJiYgZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCByb3cpLnN0YXR1cyAhPT0gJ2hpdCcgJiYgZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCByb3cpLnN0YXR1cyAhPT0gJ21pc3MnKSB7XG4gICAgICAgICAgICAgICAgICAgIGdhbWVib2FyZC5yZWNlaXZlQXR0YWNrKG5ld0NvbCwgcm93KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdhbWVib2FyZC5nZXRDZWxsKG5ld0NvbCwgcm93KS5zdGF0dXMgPT09ICdoaXQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRQcmV2SGl0KGxhc3RIaXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0TGFzdEhpdCh7IGNvbDogbmV3Q29sLCByb3c6IHJvdyB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncHJldkhpdCcsIHByZXZIaXQpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbGFzdEhpdCcsIGxhc3RIaXQpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncmFuZ2UnLCByYW5nZSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCctLS0tLS0tLS0tLS0tLS0nKTtcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2UgKz0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlID0gMTtcbiAgICAgICAgICAgICAgICAgICAgZ29SaWdodCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBmaW5pc2hpbmdBdHRhY2soZ2FtZWJvYXJkLCBuZXdDb2wsIHJvdywgcHJldkhpdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmFuZ2UgPSAxO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdnb0xlZnQnKTtcbiAgICAgICAgICAgICAgICBsZXQgbmV3Q29sID0gU3RyaW5nLmZyb21DaGFyQ29kZShjb2wuY2hhckNvZGVBdCgwKSAtIHJhbmdlKTtcbiAgICAgICAgICAgICAgICB3aGlsZSAoZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCByb3cpICYmIGdhbWVib2FyZC5nZXRDZWxsKG5ld0NvbCwgcm93KS5zdGF0dXMgPT09ICdoaXQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NvbCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoY29sLmNoYXJDb2RlQXQoMCkgLSByYW5nZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChnYW1lYm9hcmQuZ2V0Q2VsbChuZXdDb2wsIHJvdykgJiYgZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCByb3cpLnN0YXR1cyAhPT0gJ2hpdCcgJiYgZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCByb3cpLnN0YXR1cyAhPT0gJ21pc3MnKSB7XG4gICAgICAgICAgICAgICAgICAgIGdhbWVib2FyZC5yZWNlaXZlQXR0YWNrKG5ld0NvbCwgcm93KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdhbWVib2FyZC5nZXRDZWxsKG5ld0NvbCwgcm93KS5zdGF0dXMgPT09ICdoaXQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRQcmV2SGl0KGxhc3RIaXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0TGFzdEhpdCh7IGNvbDogbmV3Q29sLCByb3c6IHJvdyB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncHJldkhpdCcsIHByZXZIaXQpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbGFzdEhpdCcsIGxhc3RIaXQpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncmFuZ2UnLCByYW5nZSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCctLS0tLS0tLS0tLS0tLS0nKTtcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2UgKz0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlID0gMTtcbiAgICAgICAgICAgICAgICAgICAgZ29SaWdodCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGZpbmlzaGluZ0F0dGFjayhnYW1lYm9hcmQsIG5ld0NvbCwgcm93LCBwcmV2SGl0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocHJldkhpdC5jb2wgPT09IGNvbCkge1xuICAgICAgICAgICAgLy8gdmVydGljYWwgc2hpcCBjYXNlXG4gICAgICAgICAgICBpZiAoZ29Eb3duKSB7XG4gICAgICAgICAgICAgICAgcmFuZ2UgPSAxO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdnb0Rvd24nKTtcbiAgICAgICAgICAgICAgICBsZXQgbmV3Um93ID0gKE51bWJlcihyb3cpICsgcmFuZ2UpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGdhbWVib2FyZC5nZXRDZWxsKGNvbCwgbmV3Um93KSAmJiBnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIG5ld1Jvdykuc3RhdHVzID09PSAnaGl0Jykge1xuICAgICAgICAgICAgICAgICAgICByYW5nZSArPSAxO1xuICAgICAgICAgICAgICAgICAgICBuZXdSb3cgPSAoTnVtYmVyKHJvdykgKyByYW5nZSkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGdhbWVib2FyZC5nZXRDZWxsKGNvbCwgbmV3Um93KSAmJiBnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIG5ld1Jvdykuc3RhdHVzICE9PSAnaGl0JyAmJiBnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIG5ld1Jvdykuc3RhdHVzICE9PSAnbWlzcycpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2FtZWJvYXJkLnJlY2VpdmVBdHRhY2soY29sLCBuZXdSb3cpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ2FtZWJvYXJkLmdldENlbGwoY29sLCBuZXdSb3cpLnN0YXR1cyA9PT0gJ2hpdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFByZXZIaXQobGFzdEhpdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRMYXN0SGl0KHsgY29sOiBjb2wsIHJvdzogbmV3Um93IH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdwcmV2SGl0JywgcHJldkhpdCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdsYXN0SGl0JywgbGFzdEhpdCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyYW5nZScsIHJhbmdlKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJy0tLS0tLS0tLS0tLS0tLScpO1xuICAgICAgICAgICAgICAgICAgICByYW5nZSArPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2UgPSAxO1xuICAgICAgICAgICAgICAgICAgICBnb0Rvd24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgZmluaXNoaW5nQXR0YWNrKGdhbWVib2FyZCwgY29sLCBuZXdSb3csIHByZXZIaXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJhbmdlID0gMTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZ29VcCcpO1xuICAgICAgICAgICAgICAgIGxldCBuZXdSb3cgPSAoTnVtYmVyKHJvdykgLSByYW5nZSkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB3aGlsZSAoZ2FtZWJvYXJkLmdldENlbGwoY29sLCBuZXdSb3cpICYmIGdhbWVib2FyZC5nZXRDZWxsKGNvbCwgbmV3Um93KS5zdGF0dXMgPT09ICdoaXQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIG5ld1JvdyA9IChOdW1iZXIocm93KSAtIHJhbmdlKS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZ2FtZWJvYXJkLmdldENlbGwoY29sLCBuZXdSb3cpICYmIGdhbWVib2FyZC5nZXRDZWxsKGNvbCwgbmV3Um93KS5zdGF0dXMgIT09ICdoaXQnICYmIGdhbWVib2FyZC5nZXRDZWxsKGNvbCwgbmV3Um93KS5zdGF0dXMgIT09ICdtaXNzJykge1xuICAgICAgICAgICAgICAgICAgICBnYW1lYm9hcmQucmVjZWl2ZUF0dGFjayhjb2wsIG5ld1Jvdyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIG5ld1Jvdykuc3RhdHVzID09PSAnaGl0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0UHJldkhpdChsYXN0SGl0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldExhc3RIaXQoeyBjb2w6IGNvbCwgcm93OiBuZXdSb3cgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3ByZXZIaXQnLCBwcmV2SGl0KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2xhc3RIaXQnLCBsYXN0SGl0KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JhbmdlJywgcmFuZ2UpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLS0tJyk7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlICs9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByYW5nZSA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGdvRG93biA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGZpbmlzaGluZ0F0dGFjayhnYW1lYm9hcmQsIGNvbCwgbmV3Um93LCBwcmV2SGl0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IGdldFByZXZIaXQgPSAoKSA9PiB7XG4gICAgICAgIHJldHVybiBwcmV2SGl0O1xuICAgIH07XG4gICAgY29uc3QgZ2V0TGFzdEhpdCA9ICgpID0+IHtcbiAgICAgICAgcmV0dXJuIGxhc3RIaXQ7XG4gICAgfTtcbiAgICBjb25zdCBzZXRQcmV2SGl0ID0gKG5ld1ByZXZIaXQpID0+IHtcbiAgICAgICAgcHJldkhpdCA9IG5ld1ByZXZIaXQ7XG4gICAgfTtcbiAgICBjb25zdCBzZXRMYXN0SGl0ID0gKG5ld0xhc3RIaXQpID0+IHtcbiAgICAgICAgbGFzdEhpdCA9IG5ld0xhc3RIaXQ7XG4gICAgfTtcbiAgICByZXR1cm4geyBhdHRhY2ssIHJhbmRvbUF0dGFjaywgZm9sbG93dXBBdHRhY2ssIGZpbmlzaGluZ0F0dGFjaywgcHJldkhpdCwgbGFzdEhpdCwgZ2V0UHJldkhpdCwgZ2V0TGFzdEhpdCwgc2V0UHJldkhpdCwgc2V0TGFzdEhpdCB9O1xufTtcbmV4cG9ydCBkZWZhdWx0IHBsYXllckZhY3Rvcnk7XG4iLCJ2YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCBjb250cm9sbGVyIGZyb20gJy4vY29udHJvbGxlcic7XG5jb25zdCB1aSA9ICgoKSA9PiB7XG4gICAgY29uc3QgYm9hcmRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2JvYXJkcycpO1xuICAgIGNvbnN0IHBWY0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwbGF5ZXJWc0NvbXB1dGVyJyk7XG4gICAgY29uc3QgbmV3R2FtZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNuZXdHYW1lJyk7XG4gICAgY29uc3QgY1ZjQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2NvbXB1dGVyVnNDb21wdXRlcicpO1xuICAgIGNvbnN0IHN0YXJ0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3N0YXJ0Jyk7XG4gICAgY29uc3QgcmFuZG9tQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3JhbmRvbVBsYWNlbWVudCcpO1xuICAgIGNvbnN0IGFsbEJ0bnMgPSBbcFZjQnRuLCBuZXdHYW1lQnRuLCBjVmNCdG4sIHN0YXJ0QnRuLCByYW5kb21CdG5dO1xuICAgIGNvbnN0IGNyZWF0ZUNlbGwgPSAoY2VsbCkgPT4ge1xuICAgICAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnY2VsbCcpO1xuICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoY2VsbC5zdGF0dXMpO1xuICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1jb2wnLCBjZWxsLmNvbCk7XG4gICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXJvdycsIGNlbGwucm93KTtcbiAgICAgICAgaWYgKGNlbGwudGFrZW5CeSkge1xuICAgICAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtc2hpcE5hbWUnLCBjZWxsLnRha2VuQnkubmFtZS50b0xvd2VyQ2FzZSgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICB9O1xuICAgIGNvbnN0IHJlbmRlckNlbGxzID0gKGdhbWVib2FyZCwgYm9hcmQpID0+IHtcbiAgICAgICAgZ2FtZWJvYXJkLmFycmF5LmZvckVhY2goKHJvdykgPT4ge1xuICAgICAgICAgICAgcm93LmZvckVhY2goKGNvbCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNlbGwgPSBjcmVhdGVDZWxsKGNvbCk7XG4gICAgICAgICAgICAgICAgYm9hcmQuYXBwZW5kKGNlbGwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgY29uc3QgcmVuZGVyQm9hcmQgPSAoZ2FtZWJvYXJkKSA9PiB7XG4gICAgICAgIGNvbnN0IGJvYXJkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGJvYXJkLmNsYXNzTGlzdC5hZGQoJ2JvYXJkJyk7XG4gICAgICAgIGlmIChnYW1lYm9hcmQgPT09IGNvbnRyb2xsZXIuaHVtYW5HYW1lYm9hcmQpIHtcbiAgICAgICAgICAgIGJvYXJkLmlkID0gJ2ZpcnN0Qm9hcmQnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGdhbWVib2FyZCA9PT0gY29udHJvbGxlci5jb21wdXRlckdhbWVib2FyZCkge1xuICAgICAgICAgICAgYm9hcmQuaWQgPSAnc2Vjb25kQm9hcmQnO1xuICAgICAgICB9XG4gICAgICAgIHJlbmRlckNlbGxzKGdhbWVib2FyZCwgYm9hcmQpO1xuICAgICAgICBib2FyZHMuYXBwZW5kKGJvYXJkKTtcbiAgICB9O1xuICAgIGNvbnN0IHJlZnJlc2hCb2FyZCA9IChnYW1lYm9hcmQpID0+IHtcbiAgICAgICAgbGV0IGJvYXJkSWQ7XG4gICAgICAgIGlmIChnYW1lYm9hcmQgPT09IGNvbnRyb2xsZXIuaHVtYW5HYW1lYm9hcmQpIHtcbiAgICAgICAgICAgIGJvYXJkSWQgPSAnZmlyc3RCb2FyZCc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZ2FtZWJvYXJkID09PSBjb250cm9sbGVyLmNvbXB1dGVyR2FtZWJvYXJkKSB7XG4gICAgICAgICAgICBib2FyZElkID0gJ3NlY29uZEJvYXJkJztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBib2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2JvYXJkSWR9YCk7XG4gICAgICAgIGJvYXJkLmlubmVySFRNTCA9ICcnO1xuICAgICAgICByZW5kZXJDZWxscyhnYW1lYm9hcmQsIGJvYXJkKTtcbiAgICB9O1xuICAgIGNvbnN0IGdldFVzZXJJbnB1dCA9IChlKSA9PiB7XG4gICAgICAgIGlmICghZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdoaXQnKSAmJiAhZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtaXNzJykpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbCA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1jb2wnKTtcbiAgICAgICAgICAgIGNvbnN0IHJvdyA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1yb3cnKTtcbiAgICAgICAgICAgIHJldHVybiB7IGNvbCwgcm93IH07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IGhhbmRsZVVzZXJJbnB1dCA9ICgpID0+IF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICBjb25zdCBjZWxscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNzZWNvbmRCb2FyZCAuY2VsbCcpO1xuICAgICAgICBsZXQgdXNlcklucHV0O1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICB1c2VySW5wdXQgPSB5aWVsZCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgICAgICAgICAgIGNlbGxzLmZvckVhY2goKGNlbGwpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjZWxsLmNsYXNzTGlzdC5jb250YWlucygnaGl0JykgJiYgIWNlbGwuY2xhc3NMaXN0LmNvbnRhaW5zKCdtaXNzJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlbGwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZ2V0VXNlcklucHV0KGUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHsgb25jZTogdHJ1ZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gd2hpbGUgKCF1c2VySW5wdXQpO1xuICAgICAgICBjb25zdCBjb2wgPSB1c2VySW5wdXQuY29sLnRvU3RyaW5nKCk7XG4gICAgICAgIGNvbnN0IHJvdyA9IHVzZXJJbnB1dC5yb3cudG9TdHJpbmcoKTtcbiAgICAgICAgcmV0dXJuIHsgY29sLCByb3cgfTtcbiAgICB9KTtcbiAgICBjb25zdCBoYW5kbGVQdkMgPSAoKSA9PiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgd2FpdGluZyh0cnVlKTtcbiAgICAgICAgYWxsQnRucy5mb3JFYWNoKChidG4pID0+IChidG4uZGlzYWJsZWQgPSB0cnVlKSk7XG4gICAgICAgIHBWY0J0bi50ZXh0Q29udGVudCA9ICdSZXN0YXJ0aW5nLi4uJztcbiAgICAgICAgeWllbGQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwMCkpO1xuICAgICAgICBwVmNCdG4udGV4dENvbnRlbnQgPSAnUGxheWVyIHZzIENvbXB1dGVyJztcbiAgICAgICAgYWxsQnRucy5mb3JFYWNoKChidG4pID0+IChidG4uZGlzYWJsZWQgPSBmYWxzZSkpO1xuICAgICAgICB3YWl0aW5nKGZhbHNlKTtcbiAgICB9KTtcbiAgICBjb25zdCBoYW5kbGVOZXdHYW1lID0gKCkgPT4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgIHdhaXRpbmcodHJ1ZSk7XG4gICAgICAgIGFsbEJ0bnMuZm9yRWFjaCgoYnRuKSA9PiAoYnRuLmRpc2FibGVkID0gdHJ1ZSkpO1xuICAgICAgICBuZXdHYW1lQnRuLnRleHRDb250ZW50ID0gJ1Jlc3RhcnRpbmcuLi4nO1xuICAgICAgICB5aWVsZCBjb250cm9sbGVyLm5ld0dhbWUoKTtcbiAgICAgICAgbmV3R2FtZUJ0bi50ZXh0Q29udGVudCA9ICdOZXcgR2FtZSc7XG4gICAgICAgIGFsbEJ0bnMuZm9yRWFjaCgoYnRuKSA9PiAoYnRuLmRpc2FibGVkID0gZmFsc2UpKTtcbiAgICAgICAgd2FpdGluZyhmYWxzZSk7XG4gICAgICAgIGNhbkJlU3RhcnRlZCgpO1xuICAgIH0pO1xuICAgIGNvbnN0IGhhbmRsZUN2QyA9ICgpID0+IF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICB3YWl0aW5nKHRydWUpO1xuICAgICAgICBhbGxCdG5zLmZvckVhY2goKGJ0bikgPT4gKGJ0bi5kaXNhYmxlZCA9IHRydWUpKTtcbiAgICAgICAgY1ZjQnRuLnRleHRDb250ZW50ID0gJ1N0YXJ0aW5nLi4uJztcbiAgICAgICAgeWllbGQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwMCkpO1xuICAgICAgICBjVmNCdG4udGV4dENvbnRlbnQgPSAnQ29tcHV0ZXIgdnMgQ29tcHV0ZXInO1xuICAgICAgICBhbGxCdG5zLmZvckVhY2goKGJ0bikgPT4gKGJ0bi5kaXNhYmxlZCA9IGZhbHNlKSk7XG4gICAgICAgIHdhaXRpbmcoZmFsc2UpO1xuICAgICAgICBzdGFydEJ0bi5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgIHJhbmRvbUJ0bi5kaXNhYmxlZCA9IHRydWU7XG4gICAgfSk7XG4gICAgY29uc3QgaGFuZGxlR2FtZU1vZGUgPSAoc2VsZWN0ZWRFbGVtZW50LCBkZXNlbGVjdGVkRWxlbWVudCkgPT4ge1xuICAgICAgICBkZXNlbGVjdGVkRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpO1xuICAgICAgICBpZiAoIXNlbGVjdGVkRWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpIHtcbiAgICAgICAgICAgIHNlbGVjdGVkRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpO1xuICAgICAgICAgICAgaWYgKHNlbGVjdGVkRWxlbWVudCA9PT0gcFZjQnRuKSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlUHZDKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2VsZWN0ZWRFbGVtZW50ID09PSBjVmNCdG4pIHtcbiAgICAgICAgICAgICAgICBoYW5kbGVDdkMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnRyb2xsZXIucmVzdGFydCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCB3YWl0aW5nID0gKGJvb2wpID0+IHtcbiAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC50b2dnbGUoJ3dhaXQnLCBib29sKTtcbiAgICB9O1xuICAgIGNvbnN0IHNldEJvYXJkUG9pbnRlciA9ICh3aGljaCkgPT4ge1xuICAgICAgICBjb25zdCBzZWNvbmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc2Vjb25kQm9hcmQnKTtcbiAgICAgICAgaWYgKHdoaWNoID09PSAncGxheWVyJykge1xuICAgICAgICAgICAgc2Vjb25kLmNsYXNzTGlzdC5hZGQoJ2JvYXJkT3V0bGluZScpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHdoaWNoID09PSAnY29tcHV0ZXInKSB7XG4gICAgICAgICAgICBzZWNvbmQuY2xhc3NMaXN0LnJlbW92ZSgnYm9hcmRPdXRsaW5lJyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IHJlbW92ZUJvYXJkUG9pbnRlciA9ICgpID0+IHtcbiAgICAgICAgY29uc3Qgc2Vjb25kID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NlY29uZEJvYXJkJyk7XG4gICAgICAgIHNlY29uZC5jbGFzc0xpc3QucmVtb3ZlKCdib2FyZE91dGxpbmUnKTtcbiAgICB9O1xuICAgIGNvbnN0IGNyZWF0ZVNoaXBPdmVybGF5ID0gKGdhbWVib2FyZE5hbWUsIHNoaXBzKSA9PiB7XG4gICAgICAgIHNoaXBzLmZvckVhY2goKGZpcnN0Q2VsbCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc2hpcEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGNvbnN0IHNoaXBOYW1lID0gZmlyc3RDZWxsLnRha2VuQnkubmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgY29uc3Qgc2hpcFNpemUgPSBmaXJzdENlbGwudGFrZW5CeS5zaXplO1xuICAgICAgICAgICAgY29uc3QgaXNWZXJ0aWNhbCA9IGZpcnN0Q2VsbC50YWtlbkJ5LmlzVmVydGljYWw7XG4gICAgICAgICAgICBzaGlwRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdzaGlwJywgc2hpcE5hbWUpO1xuICAgICAgICAgICAgc2hpcEVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXNpemUnLCBgJHtzaGlwU2l6ZX1gKTtcbiAgICAgICAgICAgIHNoaXBFbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1uYW1lJywgYCR7c2hpcE5hbWV9YCk7XG4gICAgICAgICAgICBzaGlwRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RyYWdnYWJsZScsICd0cnVlJyk7XG4gICAgICAgICAgICBzaGlwRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdkcmFnZ2FibGUnKTtcbiAgICAgICAgICAgIGNvbnN0IHNldFNoaXBTdHlsZSA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIWlzVmVydGljYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgc2hpcEVsZW1lbnQuc3R5bGUud2lkdGggPSBzaGlwU2l6ZSAqIChjZWxsU2l6ZSAvIDE2KSArICdyZW0nO1xuICAgICAgICAgICAgICAgICAgICBzaGlwRWxlbWVudC5zdHlsZS5oZWlnaHQgPSBjZWxsU2l6ZSAvIDE2ICsgJ3JlbSc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGlzVmVydGljYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgc2hpcEVsZW1lbnQuc3R5bGUud2lkdGggPSBjZWxsU2l6ZSAvIDE2ICsgJ3JlbSc7XG4gICAgICAgICAgICAgICAgICAgIHNoaXBFbGVtZW50LnN0eWxlLmhlaWdodCA9IHNoaXBTaXplICogKGNlbGxTaXplIC8gMTYpICsgJ3JlbSc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGxldCBjZWxsU2l6ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ib2FyZCAuY2VsbCcpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoO1xuICAgICAgICAgICAgc2V0U2hpcFN0eWxlKCk7XG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNlbGxTaXplID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJvYXJkIC5jZWxsJykuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGg7XG4gICAgICAgICAgICAgICAgc2V0U2hpcFN0eWxlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGxldCBib2FyZDtcbiAgICAgICAgICAgIGlmIChnYW1lYm9hcmROYW1lID09PSAnZmlyc3QnKSB7XG4gICAgICAgICAgICAgICAgYm9hcmQgPSAnZmlyc3RCb2FyZCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChnYW1lYm9hcmROYW1lID09PSAnc2Vjb25kJykge1xuICAgICAgICAgICAgICAgIGJvYXJkID0gJ3NlY29uZEJvYXJkJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGZpcnN0Q2VsbEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtib2FyZH0gLmNlbGxbZGF0YS1jb2w9XCIke2ZpcnN0Q2VsbC5jb2x9XCJdW2RhdGEtcm93PVwiJHtmaXJzdENlbGwucm93fVwiXWApO1xuICAgICAgICAgICAgZmlyc3RDZWxsRWxlbWVudC5hcHBlbmRDaGlsZChzaGlwRWxlbWVudCk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgY29uc3QgY2FuQmVTdGFydGVkID0gKCkgPT4ge1xuICAgICAgICBpZiAoY29udHJvbGxlci5odW1hbkdhbWVib2FyZC5zaGlwc1BsYWNlZC5sZW5ndGggPT09IDUgJiYgY29udHJvbGxlci5jb21wdXRlckdhbWVib2FyZC5zaGlwc1BsYWNlZC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHN0YXJ0QnRuLmRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzdGFydEJ0bi5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IGRyYWdBbmREcm9wID0gKGZpcnN0R2FtZWJvYXJkLCBzZWNvbmRHYW1lYm9hcmQsIHNoaXBzKSA9PiB7XG4gICAgICAgIGxldCBzaGlwTmFtZTtcbiAgICAgICAgbGV0IHNoaXBTaXplO1xuICAgICAgICBsZXQgZ3JhYlBvaW50WCA9IDA7XG4gICAgICAgIGxldCBncmFiUG9pbnRZID0gMDtcbiAgICAgICAgbGV0IHNoaXBPYmo7XG4gICAgICAgIGxldCBvcmllbnRhdGlvbjtcbiAgICAgICAgbGV0IGhpZ2hsaWdodGVkQ2VsbHMgPSBbXTtcbiAgICAgICAgY29uc3Qgc2hpcE5hbWVUb09iaiA9IHtcbiAgICAgICAgICAgIGNhcnJpZXI6IHNoaXBzWzBdLFxuICAgICAgICAgICAgYmF0dGxlc2hpcDogc2hpcHNbMV0sXG4gICAgICAgICAgICBkZXN0cm95ZXI6IHNoaXBzWzJdLFxuICAgICAgICAgICAgc3VibWFyaW5lOiBzaGlwc1szXSxcbiAgICAgICAgICAgIHBhdHJvbGJvYXQ6IHNoaXBzWzRdLFxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBmaXJzdEJvYXJkRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNmaXJzdEJvYXJkJyk7XG4gICAgICAgIGNvbnN0IHNlY29uZEJvYXJkRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzZWNvbmRCb2FyZCcpO1xuICAgICAgICBjb25zdCBmaXJzdEJvYXJkQ2VsbHMgPSBmaXJzdEJvYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2VsbCcpO1xuICAgICAgICBjb25zdCBzZWNvbmRCb2FyZENlbGxzID0gc2Vjb25kQm9hcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jZWxsJyk7XG4gICAgICAgIGNvbnN0IG5vblNoaXBDZWxscyA9IFtdO1xuICAgICAgICBmb3IgKGxldCBjZWxsIG9mIGZpcnN0Qm9hcmRDZWxscykge1xuICAgICAgICAgICAgaWYgKCFjZWxsLmNsYXNzTGlzdC5jb250YWlucygndGFrZW4nKSkge1xuICAgICAgICAgICAgICAgIG5vblNoaXBDZWxscy5wdXNoKGNlbGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGNlbGwgb2Ygc2Vjb25kQm9hcmRDZWxscykge1xuICAgICAgICAgICAgaWYgKCFjZWxsLmNsYXNzTGlzdC5jb250YWlucygndGFrZW4nKSkge1xuICAgICAgICAgICAgICAgIG5vblNoaXBDZWxscy5wdXNoKGNlbGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRyYWdnYWJsZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZHJhZ2dhYmxlJyk7XG4gICAgICAgIGRyYWdnYWJsZXMuZm9yRWFjaCgoZHJhZ2dhYmxlKSA9PiB7XG4gICAgICAgICAgICBkcmFnZ2FibGUuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgaGFuZGxlTW91c2Vkb3duKTtcbiAgICAgICAgICAgIGRyYWdnYWJsZS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgaGFuZGxlTW91c2V1cCk7XG4gICAgICAgICAgICBkcmFnZ2FibGUuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ3N0YXJ0JywgaGFuZGxlRHJhZ1N0YXJ0KTtcbiAgICAgICAgICAgIGRyYWdnYWJsZS5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW5kJywgaGFuZGxlRHJhZ0VuZCk7XG4gICAgICAgICAgICBkcmFnZ2FibGUuYWRkRXZlbnRMaXN0ZW5lcignY29udGV4dG1lbnUnLCBoYW5kbGVSb3RhdGUpO1xuICAgICAgICAgICAgbm9uU2hpcENlbGxzLmZvckVhY2goKGNlbGwpID0+IHtcbiAgICAgICAgICAgICAgICBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2NvbnRleHRtZW51JywgYmxvY2tSaWdodENsaWNrKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgbGV0IGxhc3REcmFnZ2VkID0gbnVsbDtcbiAgICAgICAgZnVuY3Rpb24gaGFuZGxlTW91c2Vkb3duKGUpIHtcbiAgICAgICAgICAgIGZpcnN0R2FtZWJvYXJkLnJlbW92ZVJlc2VydmVkU3BhY2UoZmlyc3RHYW1lYm9hcmQpO1xuICAgICAgICAgICAgc2Vjb25kR2FtZWJvYXJkLnJlbW92ZVJlc2VydmVkU3BhY2Uoc2Vjb25kR2FtZWJvYXJkKTtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldFNoaXBOYW1lID0gZS50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLW5hbWUnKTtcbiAgICAgICAgICAgIGxldCB1cGRhdGVkU2hpcHNQbGFjZWRGaXJzdCA9IGZpcnN0R2FtZWJvYXJkLnNoaXBzUGxhY2VkLmZpbHRlcigoc2hpcCkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRTaGlwTmFtZSAhPT0gc2hpcC50YWtlbkJ5Lm5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbGV0IHVwZGF0ZWRTaGlwc1BsYWNlZFRlbXAgPSBzZWNvbmRHYW1lYm9hcmQuc2hpcHNQbGFjZWQuZmlsdGVyKChzaGlwKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldFNoaXBOYW1lICE9PSBzaGlwLnRha2VuQnkubmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB1cGRhdGVkU2hpcHNQbGFjZWRGaXJzdC5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgICAgICAgICAgICAgZmlyc3RHYW1lYm9hcmQucmVzZXJ2ZVNwYWNlKGZpcnN0R2FtZWJvYXJkLCBzaGlwLmNvbCwgc2hpcC5yb3cpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB1cGRhdGVkU2hpcHNQbGFjZWRUZW1wLmZvckVhY2goKHNoaXApID0+IHtcbiAgICAgICAgICAgICAgICBzZWNvbmRHYW1lYm9hcmQucmVzZXJ2ZVNwYWNlKHNlY29uZEdhbWVib2FyZCwgc2hpcC5jb2wsIHNoaXAucm93KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmVmcmVzaEJvYXJkKGZpcnN0R2FtZWJvYXJkKTtcbiAgICAgICAgICAgIHJlZnJlc2hCb2FyZChzZWNvbmRHYW1lYm9hcmQpO1xuICAgICAgICAgICAgY3JlYXRlU2hpcE92ZXJsYXkoJ2ZpcnN0JywgZmlyc3RHYW1lYm9hcmQuc2hpcHNQbGFjZWQpO1xuICAgICAgICAgICAgY3JlYXRlU2hpcE92ZXJsYXkoJ3NlY29uZCcsIHNlY29uZEdhbWVib2FyZC5zaGlwc1BsYWNlZCk7XG4gICAgICAgICAgICBkcmFnQW5kRHJvcChmaXJzdEdhbWVib2FyZCwgc2Vjb25kR2FtZWJvYXJkLCBjb250cm9sbGVyLmh1bWFuU2hpcHMpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGhhbmRsZU1vdXNldXAoKSB7XG4gICAgICAgICAgICBmaXJzdEdhbWVib2FyZC5zaGlwc1BsYWNlZC5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgICAgICAgICAgICAgZmlyc3RHYW1lYm9hcmQucmVzZXJ2ZVNwYWNlKGZpcnN0R2FtZWJvYXJkLCBzaGlwLmNvbCwgc2hpcC5yb3cpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzZWNvbmRHYW1lYm9hcmQuc2hpcHNQbGFjZWQuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgICAgICAgICAgICAgIHNlY29uZEdhbWVib2FyZC5yZXNlcnZlU3BhY2Uoc2Vjb25kR2FtZWJvYXJkLCBzaGlwLmNvbCwgc2hpcC5yb3cpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZWZyZXNoQm9hcmQoZmlyc3RHYW1lYm9hcmQpO1xuICAgICAgICAgICAgcmVmcmVzaEJvYXJkKHNlY29uZEdhbWVib2FyZCk7XG4gICAgICAgICAgICBjcmVhdGVTaGlwT3ZlcmxheSgnZmlyc3QnLCBmaXJzdEdhbWVib2FyZC5zaGlwc1BsYWNlZCk7XG4gICAgICAgICAgICBjcmVhdGVTaGlwT3ZlcmxheSgnc2Vjb25kJywgc2Vjb25kR2FtZWJvYXJkLnNoaXBzUGxhY2VkKTtcbiAgICAgICAgICAgIGRyYWdBbmREcm9wKGZpcnN0R2FtZWJvYXJkLCBzZWNvbmRHYW1lYm9hcmQsIGNvbnRyb2xsZXIuaHVtYW5TaGlwcyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gaGFuZGxlRHJhZ1N0YXJ0KGUpIHtcbiAgICAgICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICAgICAgeWllbGQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMCkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgICAgICAgICAgIHRhcmdldC5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XG4gICAgICAgICAgICAgICAgdGhpcy5jbGFzc0xpc3QuYWRkKCdkcmFnZ2luZycpO1xuICAgICAgICAgICAgICAgIHNoaXBOYW1lID0gdGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1uYW1lJyk7XG4gICAgICAgICAgICAgICAgc2hpcFNpemUgPSBOdW1iZXIodGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1zaXplJykpO1xuICAgICAgICAgICAgICAgIGdyYWJQb2ludFggPSBlLm9mZnNldFg7XG4gICAgICAgICAgICAgICAgZ3JhYlBvaW50WSA9IGUub2Zmc2V0WTtcbiAgICAgICAgICAgICAgICBzaGlwT2JqID0gc2hpcE5hbWVUb09ialtzaGlwTmFtZV07XG4gICAgICAgICAgICAgICAgb3JpZW50YXRpb24gPSBzaGlwT2JqLmlzVmVydGljYWwgPyAndmVydGljYWwnIDogJ2hvcml6b250YWwnO1xuICAgICAgICAgICAgICAgIGlmICh0YXJnZXQuY2xvc2VzdCgnLmJvYXJkJykuaWQgPT09ICdmaXJzdEJvYXJkJykge1xuICAgICAgICAgICAgICAgICAgICBmaXJzdEdhbWVib2FyZC5yZW1vdmVTaGlwKHNoaXBPYmosIGZpcnN0R2FtZWJvYXJkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRhcmdldC5jbG9zZXN0KCcuYm9hcmQnKS5pZCA9PT0gJ3NlY29uZEJvYXJkJykge1xuICAgICAgICAgICAgICAgICAgICBzZWNvbmRHYW1lYm9hcmQucmVtb3ZlU2hpcChzaGlwT2JqLCBzZWNvbmRHYW1lYm9hcmQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGhhbmRsZURyYWdPdmVyKGluZGV4KSB7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0LmNsb3Nlc3QoJy5ib2FyZCcpLmlkID09PSAnZmlyc3RCb2FyZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2hpcE9iaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHN0YXJ0Q2VsbCA9IGluZGV4IC0gKHNoaXBPYmouaXNWZXJ0aWNhbCA/IE1hdGguZmxvb3IoZ3JhYlBvaW50WSAvIHRoaXMub2Zmc2V0SGVpZ2h0KSAqIDEwIDogTWF0aC5mbG9vcihncmFiUG9pbnRYIC8gdGhpcy5vZmZzZXRXaWR0aCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdG9IaWdobGlnaHQgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcFNpemU7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjZWxsSW5kZXggPSBzaGlwT2JqLmlzVmVydGljYWwgPyBzdGFydENlbGwgKyBpICogMTAgOiBzdGFydENlbGwgKyBpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaXJzdEJvYXJkQ2VsbHNbY2VsbEluZGV4XSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b0hpZ2hsaWdodC5wdXNoKGZpcnN0Qm9hcmRDZWxsc1tjZWxsSW5kZXhdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0ZWRDZWxscy5wdXNoKGZpcnN0Qm9hcmRDZWxsc1tjZWxsSW5kZXhdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNWYWxpZFBsYWNlbWVudCh0b0hpZ2hsaWdodCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b0hpZ2hsaWdodC5mb3JFYWNoKChjZWxsKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnaGlnaGxpZ2h0Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFsYXN0RHJhZ2dlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0RHJhZ2dlZCA9IGdldExhc3RTaGlwU2l6ZUVsZW1lbnRzKGhpZ2hsaWdodGVkQ2VsbHMsIHNoaXBTaXplKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFx0Y29uc29sZS5sb2coJ3NoaXAgaXMgb24gdGhlIGVkZ2UnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0LmNsb3Nlc3QoJy5ib2FyZCcpLmlkID09PSAnc2Vjb25kQm9hcmQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNoaXBPYmopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzdGFydENlbGwgPSBpbmRleCAtIChzaGlwT2JqLmlzVmVydGljYWwgPyBNYXRoLmZsb29yKGdyYWJQb2ludFkgLyB0aGlzLm9mZnNldEhlaWdodCkgKiAxMCA6IE1hdGguZmxvb3IoZ3JhYlBvaW50WCAvIHRoaXMub2Zmc2V0V2lkdGgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRvSGlnaGxpZ2h0ID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXBTaXplOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY2VsbEluZGV4ID0gc2hpcE9iai5pc1ZlcnRpY2FsID8gc3RhcnRDZWxsICsgaSAqIDEwIDogc3RhcnRDZWxsICsgaTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2Vjb25kQm9hcmRDZWxsc1tjZWxsSW5kZXhdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvSGlnaGxpZ2h0LnB1c2goc2Vjb25kQm9hcmRDZWxsc1tjZWxsSW5kZXhdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0ZWRDZWxscy5wdXNoKHNlY29uZEJvYXJkQ2VsbHNbY2VsbEluZGV4XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzVmFsaWRQbGFjZW1lbnQodG9IaWdobGlnaHQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9IaWdobGlnaHQuZm9yRWFjaCgoY2VsbCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoJ2hpZ2hsaWdodCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbGFzdERyYWdnZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdERyYWdnZWQgPSBnZXRMYXN0U2hpcFNpemVFbGVtZW50cyhoaWdobGlnaHRlZENlbGxzLCBzaGlwU2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBcdGNvbnNvbGUubG9nKCdzaGlwIGlzIG9uIHRoZSBlZGdlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGhhbmRsZURyYWdMZWF2ZSgpIHtcbiAgICAgICAgICAgIGhpZ2hsaWdodGVkQ2VsbHMuZm9yRWFjaCgoaGlnaGxpZ2h0ZWRDZWxsKSA9PiB7XG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0ZWRDZWxsLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZ2hsaWdodCcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBoaWdobGlnaHRlZENlbGxzID0gW107XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gaGFuZGxlRHJvcChlKSB7XG4gICAgICAgICAgICBoaWdobGlnaHRlZENlbGxzLmZvckVhY2goKGhpZ2hsaWdodGVkQ2VsbCkgPT4ge1xuICAgICAgICAgICAgICAgIGhpZ2hsaWdodGVkQ2VsbC5jbGFzc0xpc3QucmVtb3ZlKCdoaWdobGlnaHQnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3QgbGFzdCA9IGdldExhc3RTaGlwU2l6ZUVsZW1lbnRzKGhpZ2hsaWdodGVkQ2VsbHMsIHNoaXBTaXplKTtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgICAgICAgaWYgKHRhcmdldC5jbG9zZXN0KCcuYm9hcmQnKS5pZCA9PT0gJ2ZpcnN0Qm9hcmQnKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNoaXBPYmogJiYgbGFzdERyYWdnZWQgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpcnN0R2FtZWJvYXJkLmNhbkJlUGxhY2VkKHNoaXBPYmouc2l6ZSwgbGFzdFswXS5kYXRhc2V0LmNvbCwgbGFzdFswXS5kYXRhc2V0LnJvdywgb3JpZW50YXRpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaXJzdEdhbWVib2FyZC5wbGFjZVNoaXAoc2hpcE9iaiwgbGFzdFswXS5kYXRhc2V0LmNvbCwgbGFzdFswXS5kYXRhc2V0LnJvdywgb3JpZW50YXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RHYW1lYm9hcmQucmVzZXJ2ZVNwYWNlKGZpcnN0R2FtZWJvYXJkLCBsYXN0WzBdLmRhdGFzZXQuY29sLCBsYXN0WzBdLmRhdGFzZXQucm93KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0R2FtZWJvYXJkLnBsYWNlU2hpcChzaGlwT2JqLCBsYXN0RHJhZ2dlZFswXS5kYXRhc2V0LmNvbCwgbGFzdERyYWdnZWRbMF0uZGF0YXNldC5yb3csIG9yaWVudGF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0R2FtZWJvYXJkLnJlc2VydmVTcGFjZShmaXJzdEdhbWVib2FyZCwgbGFzdERyYWdnZWRbMF0uZGF0YXNldC5jb2wsIGxhc3REcmFnZ2VkWzBdLmRhdGFzZXQucm93KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0YXJnZXQuY2xvc2VzdCgnLmJvYXJkJykuaWQgPT09ICdzZWNvbmRCb2FyZCcpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2hpcE9iaiAmJiBsYXN0RHJhZ2dlZCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2Vjb25kR2FtZWJvYXJkLmNhbkJlUGxhY2VkKHNoaXBPYmouc2l6ZSwgbGFzdFswXS5kYXRhc2V0LmNvbCwgbGFzdFswXS5kYXRhc2V0LnJvdywgb3JpZW50YXRpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmRHYW1lYm9hcmQucGxhY2VTaGlwKHNoaXBPYmosIGxhc3RbMF0uZGF0YXNldC5jb2wsIGxhc3RbMF0uZGF0YXNldC5yb3csIG9yaWVudGF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZEdhbWVib2FyZC5yZXNlcnZlU3BhY2Uoc2Vjb25kR2FtZWJvYXJkLCBsYXN0WzBdLmRhdGFzZXQuY29sLCBsYXN0WzBdLmRhdGFzZXQucm93KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZEdhbWVib2FyZC5wbGFjZVNoaXAoc2hpcE9iaiwgbGFzdERyYWdnZWRbMF0uZGF0YXNldC5jb2wsIGxhc3REcmFnZ2VkWzBdLmRhdGFzZXQucm93LCBvcmllbnRhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmRHYW1lYm9hcmQucmVzZXJ2ZVNwYWNlKHNlY29uZEdhbWVib2FyZCwgbGFzdERyYWdnZWRbMF0uZGF0YXNldC5jb2wsIGxhc3REcmFnZ2VkWzBdLmRhdGFzZXQucm93KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpcnN0R2FtZWJvYXJkLnJlbW92ZVJlc2VydmVkU3BhY2UoZmlyc3RHYW1lYm9hcmQpO1xuICAgICAgICAgICAgc2Vjb25kR2FtZWJvYXJkLnJlbW92ZVJlc2VydmVkU3BhY2Uoc2Vjb25kR2FtZWJvYXJkKTtcbiAgICAgICAgICAgIGZpcnN0R2FtZWJvYXJkLnNoaXBzUGxhY2VkLmZvckVhY2goKHNoaXApID0+IHtcbiAgICAgICAgICAgICAgICBmaXJzdEdhbWVib2FyZC5yZXNlcnZlU3BhY2UoZmlyc3RHYW1lYm9hcmQsIHNoaXAuY29sLCBzaGlwLnJvdyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHNlY29uZEdhbWVib2FyZC5zaGlwc1BsYWNlZC5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgICAgICAgICAgICAgc2Vjb25kR2FtZWJvYXJkLnJlc2VydmVTcGFjZShzZWNvbmRHYW1lYm9hcmQsIHNoaXAuY29sLCBzaGlwLnJvdyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJlZnJlc2hCb2FyZChmaXJzdEdhbWVib2FyZCk7XG4gICAgICAgICAgICByZWZyZXNoQm9hcmQoc2Vjb25kR2FtZWJvYXJkKTtcbiAgICAgICAgICAgIGNyZWF0ZVNoaXBPdmVybGF5KCdmaXJzdCcsIGZpcnN0R2FtZWJvYXJkLnNoaXBzUGxhY2VkKTtcbiAgICAgICAgICAgIGNyZWF0ZVNoaXBPdmVybGF5KCdzZWNvbmQnLCBzZWNvbmRHYW1lYm9hcmQuc2hpcHNQbGFjZWQpO1xuICAgICAgICAgICAgZHJhZ0FuZERyb3AoZmlyc3RHYW1lYm9hcmQsIHNlY29uZEdhbWVib2FyZCwgY29udHJvbGxlci5odW1hblNoaXBzKTtcbiAgICAgICAgICAgIGNhbkJlU3RhcnRlZCgpO1xuICAgICAgICAgICAgbGFzdERyYWdnZWQgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGhhbmRsZURyYWdFbmQoZSkge1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXQ7XG4gICAgICAgICAgICB0YXJnZXQuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJztcbiAgICAgICAgICAgIHRoaXMuY2xhc3NMaXN0LnJlbW92ZSgnZHJhZ2dpbmcnKTtcbiAgICAgICAgICAgIGlmIChoaWdobGlnaHRlZENlbGxzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGlmICh0YXJnZXQuY2xvc2VzdCgnLmJvYXJkJykuaWQgPT09ICdmaXJzdEJvYXJkJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobGFzdERyYWdnZWQgJiYgZmlyc3RHYW1lYm9hcmQuY2FuQmVQbGFjZWQoc2hpcE9iai5zaXplLCBsYXN0RHJhZ2dlZFswXS5kYXRhc2V0LmNvbCwgbGFzdERyYWdnZWRbMF0uZGF0YXNldC5yb3csIG9yaWVudGF0aW9uKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RHYW1lYm9hcmQucGxhY2VTaGlwKHNoaXBPYmosIGxhc3REcmFnZ2VkWzBdLmRhdGFzZXQuY29sLCBsYXN0RHJhZ2dlZFswXS5kYXRhc2V0LnJvdywgb3JpZW50YXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RHYW1lYm9hcmQucmVzZXJ2ZVNwYWNlKGZpcnN0R2FtZWJvYXJkLCBsYXN0RHJhZ2dlZFswXS5kYXRhc2V0LmNvbCwgbGFzdERyYWdnZWRbMF0uZGF0YXNldC5yb3cpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVmcmVzaEJvYXJkKGZpcnN0R2FtZWJvYXJkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2hCb2FyZChzZWNvbmRHYW1lYm9hcmQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlU2hpcE92ZXJsYXkoJ2ZpcnN0JywgZmlyc3RHYW1lYm9hcmQuc2hpcHNQbGFjZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlU2hpcE92ZXJsYXkoJ3NlY29uZCcsIHNlY29uZEdhbWVib2FyZC5zaGlwc1BsYWNlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkcmFnQW5kRHJvcChmaXJzdEdhbWVib2FyZCwgc2Vjb25kR2FtZWJvYXJkLCBjb250cm9sbGVyLmh1bWFuU2hpcHMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRhcmdldC5jbG9zZXN0KCcuYm9hcmQnKS5pZCA9PT0gJ3NlY29uZEJvYXJkJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobGFzdERyYWdnZWQgJiYgc2Vjb25kR2FtZWJvYXJkLmNhbkJlUGxhY2VkKHNoaXBPYmouc2l6ZSwgbGFzdERyYWdnZWRbMF0uZGF0YXNldC5jb2wsIGxhc3REcmFnZ2VkWzBdLmRhdGFzZXQucm93LCBvcmllbnRhdGlvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZEdhbWVib2FyZC5wbGFjZVNoaXAoc2hpcE9iaiwgbGFzdERyYWdnZWRbMF0uZGF0YXNldC5jb2wsIGxhc3REcmFnZ2VkWzBdLmRhdGFzZXQucm93LCBvcmllbnRhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmRHYW1lYm9hcmQucmVzZXJ2ZVNwYWNlKHNlY29uZEdhbWVib2FyZCwgbGFzdERyYWdnZWRbMF0uZGF0YXNldC5jb2wsIGxhc3REcmFnZ2VkWzBdLmRhdGFzZXQucm93KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2hCb2FyZChmaXJzdEdhbWVib2FyZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWZyZXNoQm9hcmQoc2Vjb25kR2FtZWJvYXJkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZVNoaXBPdmVybGF5KCdmaXJzdCcsIGZpcnN0R2FtZWJvYXJkLnNoaXBzUGxhY2VkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZVNoaXBPdmVybGF5KCdzZWNvbmQnLCBzZWNvbmRHYW1lYm9hcmQuc2hpcHNQbGFjZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZHJhZ0FuZERyb3AoZmlyc3RHYW1lYm9hcmQsIHNlY29uZEdhbWVib2FyZCwgY29udHJvbGxlci5odW1hblNoaXBzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBpc1ZhbGlkUGxhY2VtZW50KHRvSGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICByZXR1cm4gKHRvSGlnaGxpZ2h0LmV2ZXJ5KChjZWxsKSA9PiBjZWxsLmNsYXNzTGlzdC5jb250YWlucygnZW1wdHknKSkgJiZcbiAgICAgICAgICAgICAgICAodG9IaWdobGlnaHQuZXZlcnkoKGNlbGwpID0+IGNlbGwuZGF0YXNldC5jb2wgPT09IHRvSGlnaGxpZ2h0WzBdLmRhdGFzZXQuY29sKSB8fFxuICAgICAgICAgICAgICAgICAgICB0b0hpZ2hsaWdodC5ldmVyeSgoY2VsbCkgPT4gY2VsbC5kYXRhc2V0LnJvdyA9PT0gdG9IaWdobGlnaHRbMF0uZGF0YXNldC5yb3cpKSAmJlxuICAgICAgICAgICAgICAgIHRvSGlnaGxpZ2h0Lmxlbmd0aCA9PT0gc2hpcFNpemUgJiZcbiAgICAgICAgICAgICAgICB0b0hpZ2hsaWdodC5ldmVyeSgoY2VsbCkgPT4gY2VsbC5kYXRhc2V0LmNvbCA+PSAnQScgJiYgY2VsbC5kYXRhc2V0LmNvbCA8PSAnSicpICYmXG4gICAgICAgICAgICAgICAgdG9IaWdobGlnaHQuZXZlcnkoKGNlbGwpID0+IE51bWJlcihjZWxsLmRhdGFzZXQucm93KSA+PSAxICYmIE51bWJlcihjZWxsLmRhdGFzZXQucm93KSA8PSAxMCkpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldExhc3RTaGlwU2l6ZUVsZW1lbnRzKGhpZ2hsaWdodGVkQ2VsbHMsIHNoaXBTaXplKSB7XG4gICAgICAgICAgICByZXR1cm4gaGlnaGxpZ2h0ZWRDZWxscy5zbGljZShNYXRoLm1pbihoaWdobGlnaHRlZENlbGxzLmxlbmd0aCAtIHNoaXBTaXplLCAwKSk7XG4gICAgICAgIH1cbiAgICAgICAgZmlyc3RCb2FyZENlbGxzLmZvckVhY2goKGNlbGwsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdvdmVyJywgaGFuZGxlRHJhZ092ZXIoaW5kZXgpKTtcbiAgICAgICAgICAgIGNlbGwuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2xlYXZlJywgaGFuZGxlRHJhZ0xlYXZlKTtcbiAgICAgICAgICAgIGNlbGwuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIGhhbmRsZURyb3ApO1xuICAgICAgICB9KTtcbiAgICAgICAgc2Vjb25kQm9hcmRDZWxscy5mb3JFYWNoKChjZWxsLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgY2VsbC5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIGhhbmRsZURyYWdPdmVyKGluZGV4KSk7XG4gICAgICAgICAgICBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdsZWF2ZScsIGhhbmRsZURyYWdMZWF2ZSk7XG4gICAgICAgICAgICBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2Ryb3AnLCBoYW5kbGVEcm9wKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGZ1bmN0aW9uIGhhbmRsZVJvdGF0ZShlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICAgICAgICAgIGxldCBnYW1lYm9hcmQ7XG4gICAgICAgICAgICBpZiAodGFyZ2V0LmNsb3Nlc3QoJy5ib2FyZCcpLmlkID09PSAnZmlyc3RCb2FyZCcpIHtcbiAgICAgICAgICAgICAgICBnYW1lYm9hcmQgPSBmaXJzdEdhbWVib2FyZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0YXJnZXQuY2xvc2VzdCgnLmJvYXJkJykuaWQgPT09ICdzZWNvbmRCb2FyZCcpIHtcbiAgICAgICAgICAgICAgICBnYW1lYm9hcmQgPSBzZWNvbmRHYW1lYm9hcmQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzaGlwTmFtZSA9IHRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbmFtZScpO1xuICAgICAgICAgICAgc2hpcFNpemUgPSBOdW1iZXIodGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1zaXplJykpO1xuICAgICAgICAgICAgc2hpcE9iaiA9IHNoaXBOYW1lVG9PYmpbc2hpcE5hbWVdO1xuICAgICAgICAgICAgY29uc3QgdGVtcFNoaXAgPSBzaGlwT2JqO1xuICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IGdhbWVib2FyZC5zaGlwc1BsYWNlZC5maWx0ZXIoKHNoaXApID0+IHNoaXAudGFrZW5CeS5uYW1lLnRvTG93ZXJDYXNlKCkgPT09IHNoaXBOYW1lKTtcbiAgICAgICAgICAgIGdhbWVib2FyZC5yZW1vdmVTaGlwKHNoaXBPYmosIGdhbWVib2FyZCk7XG4gICAgICAgICAgICBnYW1lYm9hcmQucmVtb3ZlUmVzZXJ2ZWRTcGFjZShnYW1lYm9hcmQpO1xuICAgICAgICAgICAgZ2FtZWJvYXJkLnNoaXBzUGxhY2VkLmZvckVhY2goKHNoaXApID0+IHtcbiAgICAgICAgICAgICAgICBnYW1lYm9hcmQucmVzZXJ2ZVNwYWNlKGdhbWVib2FyZCwgc2hpcC5jb2wsIHNoaXAucm93KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGVtcFNoaXAucm90YXRlKCk7XG4gICAgICAgICAgICBvcmllbnRhdGlvbiA9IHRlbXBTaGlwLmlzVmVydGljYWwgPyAndmVydGljYWwnIDogJ2hvcml6b250YWwnO1xuICAgICAgICAgICAgaWYgKGdhbWVib2FyZC5jYW5CZVBsYWNlZCh0ZW1wU2hpcC5zaXplLCBjdXJyZW50WzBdLmNvbCwgY3VycmVudFswXS5yb3csIG9yaWVudGF0aW9uKSkge1xuICAgICAgICAgICAgICAgIGdhbWVib2FyZC5wbGFjZVNoaXAodGVtcFNoaXAsIGN1cnJlbnRbMF0uY29sLCBjdXJyZW50WzBdLnJvdywgb3JpZW50YXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGVtcFNoaXAucm90YXRlKCk7XG4gICAgICAgICAgICAgICAgb3JpZW50YXRpb24gPSB0ZW1wU2hpcC5pc1ZlcnRpY2FsID8gJ3ZlcnRpY2FsJyA6ICdob3Jpem9udGFsJztcbiAgICAgICAgICAgICAgICBnYW1lYm9hcmQucGxhY2VTaGlwKHRlbXBTaGlwLCBjdXJyZW50WzBdLmNvbCwgY3VycmVudFswXS5yb3csIG9yaWVudGF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdhbWVib2FyZC5zaGlwc1BsYWNlZC5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgICAgICAgICAgICAgZ2FtZWJvYXJkLnJlc2VydmVTcGFjZShnYW1lYm9hcmQsIHNoaXAuY29sLCBzaGlwLnJvdyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJlZnJlc2hCb2FyZChnYW1lYm9hcmQpO1xuICAgICAgICAgICAgY3JlYXRlU2hpcE92ZXJsYXkoJ2ZpcnN0JywgZmlyc3RHYW1lYm9hcmQuc2hpcHNQbGFjZWQpO1xuICAgICAgICAgICAgY3JlYXRlU2hpcE92ZXJsYXkoJ3NlY29uZCcsIHNlY29uZEdhbWVib2FyZC5zaGlwc1BsYWNlZCk7XG4gICAgICAgICAgICBkcmFnQW5kRHJvcChmaXJzdEdhbWVib2FyZCwgc2Vjb25kR2FtZWJvYXJkLCBjb250cm9sbGVyLmh1bWFuU2hpcHMpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGJsb2NrUmlnaHRDbGljayhlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHBWY0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgaGFuZGxlR2FtZU1vZGUocFZjQnRuLCBjVmNCdG4pO1xuICAgICAgICBjb25zdCBzZWNvbmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc2Vjb25kQm9hcmQnKTtcbiAgICAgICAgc2Vjb25kLmNsYXNzTGlzdC5yZW1vdmUoJ3N0YXJ0Jyk7XG4gICAgfSk7XG4gICAgY1ZjQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBoYW5kbGVHYW1lTW9kZShjVmNCdG4sIHBWY0J0bik7XG4gICAgICAgIGNvbnN0IHNlY29uZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzZWNvbmRCb2FyZCcpO1xuICAgICAgICBzZWNvbmQuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpO1xuICAgICAgICBzZWNvbmQuY2xhc3NMaXN0LmFkZCgnc3RhcnQnKTtcbiAgICB9KTtcbiAgICBuZXdHYW1lQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgIHlpZWxkIGhhbmRsZU5ld0dhbWUoKTtcbiAgICAgICAgY29uc3Qgc2Vjb25kID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NlY29uZEJvYXJkJyk7XG4gICAgICAgIHNlY29uZC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlJyk7XG4gICAgICAgIGlmIChwVmNCdG4uY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpKSB7XG4gICAgICAgICAgICBzZWNvbmQuY2xhc3NMaXN0LnJlbW92ZSgnc3RhcnQnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY1ZjQnRuLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSkge1xuICAgICAgICAgICAgc2Vjb25kLmNsYXNzTGlzdC5hZGQoJ3N0YXJ0Jyk7XG4gICAgICAgICAgICByYW5kb21CdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfSkpO1xuICAgIHN0YXJ0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBjb250cm9sbGVyLnN0YXJ0KCk7XG4gICAgICAgIGNvbnN0IGZpcnN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2ZpcnN0Qm9hcmQnKTtcbiAgICAgICAgZmlyc3QuY2xhc3NMaXN0LmFkZCgnaGlkZScpO1xuICAgICAgICBjb25zdCBzZWNvbmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc2Vjb25kQm9hcmQnKTtcbiAgICAgICAgc2Vjb25kLmNsYXNzTGlzdC5hZGQoJ2hpZGUnKTtcbiAgICAgICAgc2Vjb25kLmNsYXNzTGlzdC5hZGQoJ3N0YXJ0Jyk7XG4gICAgICAgIHN0YXJ0QnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgcmFuZG9tQnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9KTtcbiAgICByYW5kb21CdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGNvbnRyb2xsZXIuY29tcHV0ZXJHYW1lYm9hcmQuY2xlYXJCb2FyZCgpO1xuICAgICAgICByZWZyZXNoQm9hcmQoY29udHJvbGxlci5jb21wdXRlckdhbWVib2FyZCk7XG4gICAgICAgIGNvbnRyb2xsZXIucmFuZG9taXplU2hpcHNQbGFjZW1lbnQoJ2ZpcnN0JywgY29udHJvbGxlci5odW1hbkdhbWVib2FyZCk7XG4gICAgICAgIGRyYWdBbmREcm9wKGNvbnRyb2xsZXIuaHVtYW5HYW1lYm9hcmQsIGNvbnRyb2xsZXIuY29tcHV0ZXJHYW1lYm9hcmQsIGNvbnRyb2xsZXIuaHVtYW5TaGlwcyk7XG4gICAgICAgIGNhbkJlU3RhcnRlZCgpO1xuICAgIH0pO1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlbmRlckJvYXJkLFxuICAgICAgICByZWZyZXNoQm9hcmQsXG4gICAgICAgIGhhbmRsZVVzZXJJbnB1dCxcbiAgICAgICAgcFZjQnRuLFxuICAgICAgICBjVmNCdG4sXG4gICAgICAgIHdhaXRpbmcsXG4gICAgICAgIHNldEJvYXJkUG9pbnRlcixcbiAgICAgICAgcmVtb3ZlQm9hcmRQb2ludGVyLFxuICAgICAgICBjcmVhdGVTaGlwT3ZlcmxheSxcbiAgICAgICAgZHJhZ0FuZERyb3AsXG4gICAgICAgIGNhbkJlU3RhcnRlZCxcbiAgICB9O1xufSkoKTtcbmV4cG9ydCBkZWZhdWx0IHVpO1xuIiwidmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgZ2FtZWJvYXJkRmFjdG9yeSBmcm9tICcuL2dhbWVib2FyZCc7XG5pbXBvcnQgc2hpcEZhY3RvcnkgZnJvbSAnLi9zaGlwJztcbmltcG9ydCBwbGF5ZXJGYWN0b3J5IGZyb20gJy4vcGxheWVyJztcbmltcG9ydCB1aSBmcm9tICcuL3VpJztcbmNvbnN0IGNvbnRyb2xsZXIgPSAoKCkgPT4ge1xuICAgIGNvbnN0IGh1bWFuR2FtZWJvYXJkID0gZ2FtZWJvYXJkRmFjdG9yeSgpO1xuICAgIGNvbnN0IGNvbXB1dGVyR2FtZWJvYXJkID0gZ2FtZWJvYXJkRmFjdG9yeSgpO1xuICAgIGNvbnN0IGh1bWFuID0gcGxheWVyRmFjdG9yeSgpO1xuICAgIGNvbnN0IGNvbXB1dGVyID0gcGxheWVyRmFjdG9yeSgpO1xuICAgIGxldCBpc1N0b3BwZWQgPSB0cnVlO1xuICAgIGxldCBodW1hbkNhcnJpZXIgPSBzaGlwRmFjdG9yeSgnQ2FycmllcicpO1xuICAgIGxldCBodW1hbkJhdHRsZXNoaXAgPSBzaGlwRmFjdG9yeSgnQmF0dGxlc2hpcCcpO1xuICAgIGxldCBodW1hbkRlc3Ryb3llciA9IHNoaXBGYWN0b3J5KCdEZXN0cm95ZXInKTtcbiAgICBsZXQgaHVtYW5TdWJtYXJpbmUgPSBzaGlwRmFjdG9yeSgnU3VibWFyaW5lJyk7XG4gICAgbGV0IGh1bWFuUGF0cm9sYm9hdCA9IHNoaXBGYWN0b3J5KCdQYXRyb2xCb2F0Jyk7XG4gICAgY29uc3QgaHVtYW5TaGlwcyA9IFtodW1hbkNhcnJpZXIsIGh1bWFuQmF0dGxlc2hpcCwgaHVtYW5EZXN0cm95ZXIsIGh1bWFuU3VibWFyaW5lLCBodW1hblBhdHJvbGJvYXRdO1xuICAgIGNvbnN0IHBvcHVsYXRlU2hpcHMgPSAoKSA9PiB7XG4gICAgICAgIGNvbXB1dGVyR2FtZWJvYXJkLnBsYWNlU2hpcChodW1hbkNhcnJpZXIsICdBJywgJzEnLCAnaG9yaXpvbnRhbCcpO1xuICAgICAgICBjb21wdXRlckdhbWVib2FyZC5wbGFjZVNoaXAoaHVtYW5CYXR0bGVzaGlwLCAnQScsICczJywgJ2hvcml6b250YWwnKTtcbiAgICAgICAgY29tcHV0ZXJHYW1lYm9hcmQucGxhY2VTaGlwKGh1bWFuRGVzdHJveWVyLCAnQScsICc1JywgJ2hvcml6b250YWwnKTtcbiAgICAgICAgY29tcHV0ZXJHYW1lYm9hcmQucGxhY2VTaGlwKGh1bWFuU3VibWFyaW5lLCAnQScsICc3JywgJ2hvcml6b250YWwnKTtcbiAgICAgICAgY29tcHV0ZXJHYW1lYm9hcmQucGxhY2VTaGlwKGh1bWFuUGF0cm9sYm9hdCwgJ0EnLCAnOScsICdob3Jpem9udGFsJyk7XG4gICAgICAgIGNvbXB1dGVyR2FtZWJvYXJkLnJlc2VydmVTcGFjZShjb21wdXRlckdhbWVib2FyZCwgJ0EnLCAnMScpO1xuICAgICAgICBjb21wdXRlckdhbWVib2FyZC5yZXNlcnZlU3BhY2UoY29tcHV0ZXJHYW1lYm9hcmQsICdBJywgJzMnKTtcbiAgICAgICAgY29tcHV0ZXJHYW1lYm9hcmQucmVzZXJ2ZVNwYWNlKGNvbXB1dGVyR2FtZWJvYXJkLCAnQScsICc1Jyk7XG4gICAgICAgIGNvbXB1dGVyR2FtZWJvYXJkLnJlc2VydmVTcGFjZShjb21wdXRlckdhbWVib2FyZCwgJ0EnLCAnNycpO1xuICAgICAgICBjb21wdXRlckdhbWVib2FyZC5yZXNlcnZlU3BhY2UoY29tcHV0ZXJHYW1lYm9hcmQsICdBJywgJzknKTtcbiAgICB9O1xuICAgIGNvbnN0IGlzR2FtZU92ZXIgPSAoKSA9PiB7XG4gICAgICAgIGlmIChjb21wdXRlckdhbWVib2FyZC5hbGxTdW5rKGNvbXB1dGVyR2FtZWJvYXJkKSkge1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ0FsbCBjb21wdXRlciBzaGlwcyBhcmUgc3Vuay4gSHVtYW4gcGxheWVyIHdvbiEnKTtcbiAgICAgICAgICAgIHVpLnJlbW92ZUJvYXJkUG9pbnRlcigpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGh1bWFuR2FtZWJvYXJkLmFsbFN1bmsoaHVtYW5HYW1lYm9hcmQpKSB7XG4gICAgICAgICAgICB1aS5yZW1vdmVCb2FyZFBvaW50ZXIoKTtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdBbGwgaHVtYW4gc2hpcHMgYXJlIHN1bmsuIENvbXB1dGVyIHBsYXllciB3b24hJyk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBjb25zdCBjb21wdXRlckFJID0gKGdhbWVib2FyZCkgPT4ge1xuICAgICAgICBsZXQgcGxheWVyO1xuICAgICAgICBpZiAoZ2FtZWJvYXJkID09PSBodW1hbkdhbWVib2FyZCkge1xuICAgICAgICAgICAgcGxheWVyID0gY29tcHV0ZXI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZ2FtZWJvYXJkID09PSBjb21wdXRlckdhbWVib2FyZCkge1xuICAgICAgICAgICAgcGxheWVyID0gaHVtYW47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGdhbWVib2FyZC5oaXRCdXROb3RTdW5rKGdhbWVib2FyZCkpIHtcbiAgICAgICAgICAgIGlmIChwbGF5ZXIuZ2V0UHJldkhpdCgpICE9PSBudWxsICYmXG4gICAgICAgICAgICAgICAgcGxheWVyLmdldExhc3RIaXQoKSAhPT0gbnVsbCAmJlxuICAgICAgICAgICAgICAgIGdhbWVib2FyZC5nZXRDZWxsKHBsYXllci5nZXRMYXN0SGl0KCkuY29sLCBwbGF5ZXIuZ2V0TGFzdEhpdCgpLnJvdykudGFrZW5CeS5oaXRDb3VudCA+PSAyICYmXG4gICAgICAgICAgICAgICAgZ2FtZWJvYXJkLmdldENlbGwocGxheWVyLmdldExhc3RIaXQoKS5jb2wsIHBsYXllci5nZXRMYXN0SGl0KCkucm93KS50YWtlbkJ5LmhpdENvdW50IDw9IDQpIHtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnRklOSVNIOiA+PSAyIHRyYWZpZW5pYSB3IHN0YXRlaycsIHBsYXllci5nZXRQcmV2SGl0KCkpO1xuICAgICAgICAgICAgICAgIHBsYXllci5maW5pc2hpbmdBdHRhY2soZ2FtZWJvYXJkLCBwbGF5ZXIuZ2V0TGFzdEhpdCgpLmNvbCwgcGxheWVyLmdldExhc3RIaXQoKS5yb3csIHBsYXllci5nZXRQcmV2SGl0KCkpO1xuICAgICAgICAgICAgICAgIGdhbWVib2FyZC5zaW5rU2hpcChnYW1lYm9hcmQsIHBsYXllci5nZXRMYXN0SGl0KCkuY29sLCBwbGF5ZXIuZ2V0TGFzdEhpdCgpLnJvdyk7XG4gICAgICAgICAgICAgICAgaWYgKGlzR2FtZU92ZXIoKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZ2FtZWJvYXJkLmdldENlbGwocGxheWVyLmdldExhc3RIaXQoKS5jb2wsIHBsYXllci5nZXRMYXN0SGl0KCkucm93KS50YWtlbkJ5LmhpdENvdW50ID09PSAxKSB7XG4gICAgICAgICAgICAgICAgcGxheWVyLmZvbGxvd3VwQXR0YWNrKGdhbWVib2FyZCwgcGxheWVyLmdldExhc3RIaXQoKS5jb2wsIHBsYXllci5nZXRMYXN0SGl0KCkucm93KTtcbiAgICAgICAgICAgICAgICBnYW1lYm9hcmQuc2lua1NoaXAoZ2FtZWJvYXJkLCBwbGF5ZXIuZ2V0TGFzdEhpdCgpLmNvbCwgcGxheWVyLmdldExhc3RIaXQoKS5yb3cpO1xuICAgICAgICAgICAgICAgIGlmIChpc0dhbWVPdmVyKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHsgY29sLCByb3cgfSA9IHBsYXllci5yYW5kb21BdHRhY2soZ2FtZWJvYXJkKTtcbiAgICAgICAgICAgIGlmIChnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIHJvdykuc3RhdHVzID09PSAnaGl0Jykge1xuICAgICAgICAgICAgICAgIHBsYXllci5zZXRQcmV2SGl0KHBsYXllci5nZXRMYXN0SGl0KCkpO1xuICAgICAgICAgICAgICAgIHBsYXllci5zZXRMYXN0SGl0KHsgY29sLCByb3cgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZ2FtZWJvYXJkLmdldENlbGwoY29sLCByb3cpLnN0YXR1cyA9PT0gJ2hpdCcgJiYgZ2FtZWJvYXJkLmdldENlbGwoY29sLCByb3cpLnRha2VuQnkuaXNTdW5rKCkpIHtcbiAgICAgICAgICAgICAgICBnYW1lYm9hcmQuc2lua1NoaXAoZ2FtZWJvYXJkLCBjb2wsIHJvdyk7XG4gICAgICAgICAgICAgICAgcGxheWVyLnNldFByZXZIaXQobnVsbCk7XG4gICAgICAgICAgICAgICAgcGxheWVyLnNldExhc3RIaXQobnVsbCk7XG4gICAgICAgICAgICAgICAgaWYgKGlzR2FtZU92ZXIoKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBwbGF5ZXJWc0NvbXB1dGVyTW9kZSA9ICgpID0+IF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICBsZXQgaXNQbGF5ZXJUdXJuID0gdHJ1ZTtcbiAgICAgICAgd2hpbGUgKCFpc0dhbWVPdmVyKCkgJiYgIWlzU3RvcHBlZCkge1xuICAgICAgICAgICAgaWYgKGlzUGxheWVyVHVybikge1xuICAgICAgICAgICAgICAgIHVpLnNldEJvYXJkUG9pbnRlcigncGxheWVyJyk7XG4gICAgICAgICAgICAgICAgdWkud2FpdGluZyhmYWxzZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBjb2wsIHJvdyB9ID0geWllbGQgdWkuaGFuZGxlVXNlcklucHV0KCk7XG4gICAgICAgICAgICAgICAgaHVtYW4uYXR0YWNrKGNvbXB1dGVyR2FtZWJvYXJkLCBjb2wsIHJvdyk7XG4gICAgICAgICAgICAgICAgY29tcHV0ZXJHYW1lYm9hcmQuc2lua1NoaXAoY29tcHV0ZXJHYW1lYm9hcmQsIGNvbCwgcm93KTtcbiAgICAgICAgICAgICAgICB1aS5yZWZyZXNoQm9hcmQoY29tcHV0ZXJHYW1lYm9hcmQpO1xuICAgICAgICAgICAgICAgIGlzUGxheWVyVHVybiA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlzR2FtZU92ZXIoKSB8fCBpc1N0b3BwZWQpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghaXNQbGF5ZXJUdXJuKSB7XG4gICAgICAgICAgICAgICAgdWkuc2V0Qm9hcmRQb2ludGVyKCdjb21wdXRlcicpO1xuICAgICAgICAgICAgICAgIHVpLndhaXRpbmcodHJ1ZSk7XG4gICAgICAgICAgICAgICAgeWllbGQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwMCkpO1xuICAgICAgICAgICAgICAgIGlmICghdWkucFZjQnRuLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSB8fCBpc1N0b3BwZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbXB1dGVyQUkoaHVtYW5HYW1lYm9hcmQpO1xuICAgICAgICAgICAgICAgIHVpLnJlZnJlc2hCb2FyZChodW1hbkdhbWVib2FyZCk7XG4gICAgICAgICAgICAgICAgaXNQbGF5ZXJUdXJuID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpc1N0b3BwZWQgPSBmYWxzZTtcbiAgICAgICAgdWkud2FpdGluZyhmYWxzZSk7XG4gICAgfSk7XG4gICAgY29uc3QgY29tcHV0ZXJWc0NvbXB1dGVyTW9kZSA9ICgpID0+IF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICB1aS5yZW1vdmVCb2FyZFBvaW50ZXIoKTtcbiAgICAgICAgbGV0IGlzUGxheWVyVHVybiA9IHRydWU7XG4gICAgICAgIHdoaWxlICghaXNHYW1lT3ZlcigpICYmICFpc1N0b3BwZWQpIHtcbiAgICAgICAgICAgIHVpLndhaXRpbmcodHJ1ZSk7XG4gICAgICAgICAgICBpZiAoaXNQbGF5ZXJUdXJuKSB7XG4gICAgICAgICAgICAgICAgeWllbGQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwMCkpO1xuICAgICAgICAgICAgICAgIGlmICghdWkuY1ZjQnRuLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSB8fCBpc1N0b3BwZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbXB1dGVyQUkoaHVtYW5HYW1lYm9hcmQpO1xuICAgICAgICAgICAgICAgIHVpLnJlZnJlc2hCb2FyZChodW1hbkdhbWVib2FyZCk7XG4gICAgICAgICAgICAgICAgaXNQbGF5ZXJUdXJuID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXNHYW1lT3ZlcigpIHx8IGlzU3RvcHBlZCkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFpc1BsYXllclR1cm4pIHtcbiAgICAgICAgICAgICAgICB5aWVsZCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDAwKSk7XG4gICAgICAgICAgICAgICAgaWYgKCF1aS5jVmNCdG4uY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpIHx8IGlzU3RvcHBlZCkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29tcHV0ZXJBSShjb21wdXRlckdhbWVib2FyZCk7XG4gICAgICAgICAgICAgICAgdWkucmVmcmVzaEJvYXJkKGNvbXB1dGVyR2FtZWJvYXJkKTtcbiAgICAgICAgICAgICAgICBpc1BsYXllclR1cm4gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlzU3RvcHBlZCA9IGZhbHNlO1xuICAgICAgICB1aS53YWl0aW5nKGZhbHNlKTtcbiAgICB9KTtcbiAgICBjb25zdCByYW5kb21QbGFjZW1lbnQgPSAoZ2FtZWJvYXJkKSA9PiB7XG4gICAgICAgIGxldCBhbGxTaGlwcztcbiAgICAgICAgaWYgKGdhbWVib2FyZCA9PT0gaHVtYW5HYW1lYm9hcmQpIHtcbiAgICAgICAgICAgIGh1bWFuQ2FycmllciA9IHNoaXBGYWN0b3J5KCdDYXJyaWVyJyk7XG4gICAgICAgICAgICBodW1hbkJhdHRsZXNoaXAgPSBzaGlwRmFjdG9yeSgnQmF0dGxlc2hpcCcpO1xuICAgICAgICAgICAgaHVtYW5EZXN0cm95ZXIgPSBzaGlwRmFjdG9yeSgnRGVzdHJveWVyJyk7XG4gICAgICAgICAgICBodW1hblN1Ym1hcmluZSA9IHNoaXBGYWN0b3J5KCdTdWJtYXJpbmUnKTtcbiAgICAgICAgICAgIGh1bWFuUGF0cm9sYm9hdCA9IHNoaXBGYWN0b3J5KCdQYXRyb2xCb2F0Jyk7XG4gICAgICAgICAgICBhbGxTaGlwcyA9IFtodW1hbkNhcnJpZXIsIGh1bWFuQmF0dGxlc2hpcCwgaHVtYW5EZXN0cm95ZXIsIGh1bWFuU3VibWFyaW5lLCBodW1hblBhdHJvbGJvYXRdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGdhbWVib2FyZCA9PT0gY29tcHV0ZXJHYW1lYm9hcmQpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbXB1dGVyQ2FycmllciA9IHNoaXBGYWN0b3J5KCdDYXJyaWVyJyk7XG4gICAgICAgICAgICBjb25zdCBjb21wdXRlckJhdHRsZXNoaXAgPSBzaGlwRmFjdG9yeSgnQmF0dGxlc2hpcCcpO1xuICAgICAgICAgICAgY29uc3QgY29tcHV0ZXJEZXN0cm95ZXIgPSBzaGlwRmFjdG9yeSgnRGVzdHJveWVyJyk7XG4gICAgICAgICAgICBjb25zdCBjb21wdXRlclN1Ym1hcmluZSA9IHNoaXBGYWN0b3J5KCdTdWJtYXJpbmUnKTtcbiAgICAgICAgICAgIGNvbnN0IGNvbXB1dGVyUGF0cm9sYm9hdCA9IHNoaXBGYWN0b3J5KCdQYXRyb2xCb2F0Jyk7XG4gICAgICAgICAgICBhbGxTaGlwcyA9IFtjb21wdXRlckNhcnJpZXIsIGNvbXB1dGVyQmF0dGxlc2hpcCwgY29tcHV0ZXJEZXN0cm95ZXIsIGNvbXB1dGVyU3VibWFyaW5lLCBjb21wdXRlclBhdHJvbGJvYXRdO1xuICAgICAgICB9XG4gICAgICAgIGNvbnRyb2xsZXIuaHVtYW5TaGlwcy5sZW5ndGggPSAwO1xuICAgICAgICBjb25zdCBjb2xzID0gWydBJywgJ0InLCAnQycsICdEJywgJ0UnLCAnRicsICdHJywgJ0gnLCAnSScsICdKJ107XG4gICAgICAgIGNvbnN0IHJhbmRvbUNvbCA9ICgpID0+IGNvbHNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY29scy5sZW5ndGgpXTtcbiAgICAgICAgY29uc3QgcmFuZG9tUm93ID0gKCkgPT4gTWF0aC5jZWlsKE1hdGgucmFuZG9tKCkgKiAxMCkudG9TdHJpbmcoKTtcbiAgICAgICAgY29uc3QgcmFuZG9tT3JpZW50YXRpb24gPSAoKSA9PiAoTWF0aC5yYW5kb20oKSA+IDAuNSA/ICdob3Jpem9udGFsJyA6ICd2ZXJ0aWNhbCcpO1xuICAgICAgICBhbGxTaGlwcy5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgICAgICAgICBsZXQgY29sID0gcmFuZG9tQ29sKCk7XG4gICAgICAgICAgICBsZXQgcm93ID0gcmFuZG9tUm93KCk7XG4gICAgICAgICAgICBsZXQgb3JpZW50YXRpb24gPSByYW5kb21PcmllbnRhdGlvbigpO1xuICAgICAgICAgICAgbGV0IHJlc3VsdCA9IGdhbWVib2FyZC5jYW5CZVBsYWNlZChzaGlwLnNpemUsIGNvbCwgcm93LCBvcmllbnRhdGlvbik7XG4gICAgICAgICAgICB3aGlsZSAoIXJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGNvbCA9IHJhbmRvbUNvbCgpO1xuICAgICAgICAgICAgICAgIHJvdyA9IHJhbmRvbVJvdygpO1xuICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uID0gcmFuZG9tT3JpZW50YXRpb24oKTtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBnYW1lYm9hcmQuY2FuQmVQbGFjZWQoc2hpcC5zaXplLCBjb2wsIHJvdywgb3JpZW50YXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGdhbWVib2FyZC5wbGFjZVNoaXAoc2hpcCwgY29sLCByb3csIG9yaWVudGF0aW9uKTtcbiAgICAgICAgICAgICAgICBnYW1lYm9hcmQucmVzZXJ2ZVNwYWNlKGdhbWVib2FyZCwgY29sLCByb3cpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29udHJvbGxlci5odW1hblNoaXBzLnB1c2goc2hpcCk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgY29uc3QgcmFuZG9taXplU2hpcHNQbGFjZW1lbnQgPSAoZ2FtZWJvYXJkTmFtZSwgZ2FtZWJvYXJkKSA9PiB7XG4gICAgICAgIGdhbWVib2FyZC5jbGVhckJvYXJkKCk7XG4gICAgICAgIHJhbmRvbVBsYWNlbWVudChnYW1lYm9hcmQpO1xuICAgICAgICB1aS5yZWZyZXNoQm9hcmQoZ2FtZWJvYXJkKTtcbiAgICAgICAgaWYgKGdhbWVib2FyZE5hbWUgPT09ICdmaXJzdCcpIHtcbiAgICAgICAgICAgIHVpLmNyZWF0ZVNoaXBPdmVybGF5KCdmaXJzdCcsIGdhbWVib2FyZC5zaGlwc1BsYWNlZCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IHBpY2tHYW1lTW9kZSA9ICgpID0+IHtcbiAgICAgICAgaWYgKHVpLmNWY0J0bi5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpIHtcbiAgICAgICAgICAgIHJhbmRvbWl6ZVNoaXBzUGxhY2VtZW50KCdmaXJzdCcsIGh1bWFuR2FtZWJvYXJkKTtcbiAgICAgICAgICAgIHJhbmRvbWl6ZVNoaXBzUGxhY2VtZW50KCdzZWNvbmQnLCBjb21wdXRlckdhbWVib2FyZCk7XG4gICAgICAgICAgICBpc1N0b3BwZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGNvbXB1dGVyVnNDb21wdXRlck1vZGUoKTtcbiAgICAgICAgICAgIHVpLnJlZnJlc2hCb2FyZChodW1hbkdhbWVib2FyZCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IHN0YXJ0ID0gKCkgPT4ge1xuICAgICAgICB1aS5yZWZyZXNoQm9hcmQoaHVtYW5HYW1lYm9hcmQpO1xuICAgICAgICByYW5kb21pemVTaGlwc1BsYWNlbWVudCgnc2Vjb25kJywgY29tcHV0ZXJHYW1lYm9hcmQpO1xuICAgICAgICBpc1N0b3BwZWQgPSBmYWxzZTtcbiAgICAgICAgcGxheWVyVnNDb21wdXRlck1vZGUoKTtcbiAgICB9O1xuICAgIGNvbnN0IHJlc3RhcnQgPSAoKSA9PiB7XG4gICAgICAgIGlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIGh1bWFuLnNldFByZXZIaXQobnVsbCk7XG4gICAgICAgIGh1bWFuLnNldExhc3RIaXQobnVsbCk7XG4gICAgICAgIGNvbXB1dGVyLnNldFByZXZIaXQobnVsbCk7XG4gICAgICAgIGNvbXB1dGVyLnNldExhc3RIaXQobnVsbCk7XG4gICAgICAgIGh1bWFuR2FtZWJvYXJkLmNsZWFyQm9hcmQoKTtcbiAgICAgICAgY29tcHV0ZXJHYW1lYm9hcmQuY2xlYXJCb2FyZCgpO1xuICAgICAgICBwb3B1bGF0ZVNoaXBzKCk7XG4gICAgICAgIHVpLnJlZnJlc2hCb2FyZChodW1hbkdhbWVib2FyZCk7XG4gICAgICAgIHVpLnJlZnJlc2hCb2FyZChjb21wdXRlckdhbWVib2FyZCk7XG4gICAgICAgIHVpLmNyZWF0ZVNoaXBPdmVybGF5KCdzZWNvbmQnLCBjb21wdXRlckdhbWVib2FyZC5zaGlwc1BsYWNlZCk7XG4gICAgICAgIHVpLmRyYWdBbmREcm9wKGh1bWFuR2FtZWJvYXJkLCBjb21wdXRlckdhbWVib2FyZCwgaHVtYW5TaGlwcyk7XG4gICAgICAgIHVpLmNhbkJlU3RhcnRlZCgpO1xuICAgICAgICBwaWNrR2FtZU1vZGUoKTtcbiAgICB9O1xuICAgIGNvbnN0IG5ld0dhbWUgPSAoKSA9PiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgeWllbGQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwMCkpO1xuICAgICAgICBpc1N0b3BwZWQgPSBmYWxzZTtcbiAgICAgICAgcmVzdGFydCgpO1xuICAgIH0pO1xuICAgIGNvbnN0IGluaXQgPSAoKSA9PiB7XG4gICAgICAgIHVpLnJlbmRlckJvYXJkKGh1bWFuR2FtZWJvYXJkKTtcbiAgICAgICAgdWkucmVuZGVyQm9hcmQoY29tcHV0ZXJHYW1lYm9hcmQpO1xuICAgICAgICBwb3B1bGF0ZVNoaXBzKCk7XG4gICAgICAgIHVpLnJlZnJlc2hCb2FyZChjb21wdXRlckdhbWVib2FyZCk7XG4gICAgICAgIHVpLmNyZWF0ZVNoaXBPdmVybGF5KCdzZWNvbmQnLCBjb21wdXRlckdhbWVib2FyZC5zaGlwc1BsYWNlZCk7XG4gICAgICAgIHVpLmRyYWdBbmREcm9wKGh1bWFuR2FtZWJvYXJkLCBjb21wdXRlckdhbWVib2FyZCwgaHVtYW5TaGlwcyk7XG4gICAgICAgIHVpLmNhbkJlU3RhcnRlZCgpO1xuICAgICAgICBwaWNrR2FtZU1vZGUoKTtcbiAgICB9O1xuICAgIHJldHVybiB7IGluaXQsIGh1bWFuR2FtZWJvYXJkLCBjb21wdXRlckdhbWVib2FyZCwgcmVzdGFydCwgbmV3R2FtZSwgc3RhcnQsIHJhbmRvbWl6ZVNoaXBzUGxhY2VtZW50LCBodW1hblNoaXBzIH07XG59KSgpO1xuZXhwb3J0IGRlZmF1bHQgY29udHJvbGxlcjtcbiIsImltcG9ydCAnbm9ybWFsaXplLmNzcyc7XG5pbXBvcnQgJy4vc3R5bGUvc3R5bGUuY3NzJztcbmltcG9ydCBjb250cm9sbGVyIGZyb20gJy4vbW9kdWxlcy9jb250cm9sbGVyJztcbmNvbnRyb2xsZXIuaW5pdCgpO1xuIl0sIm5hbWVzIjpbImNvbHMiLCJyb3dzIiwiYXJyYXkiLCJzaGlwc1BsYWNlZCIsImdldENlbGwiLCJjb2wiLCJyb3ciLCJjb2xJbmRleCIsImluZGV4T2YiLCJyb3dJbmRleCIsInNldENlbGwiLCJuZXdTdGF0dXMiLCJuZXdUYWtlbkJ5Iiwic3RhdHVzIiwidGFrZW5CeSIsImkiLCJqIiwiZ2VuZXJhdGVBcnJheSIsImNsZWFyQm9hcmQiLCJ1bmRlZmluZWQiLCJsZW5ndGgiLCJyZW1vdmVTaGlwIiwic2hpcCIsImdhbWVib2FyZCIsImZsYXQiLCJmb3JFYWNoIiwiY2VsbCIsImJvYXJkSWQiLCJuYW1lIiwic3BsaWNlIiwiaHVtYW5HYW1lYm9hcmQiLCJjb21wdXRlckdhbWVib2FyZCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwiZ2V0QXR0cmlidXRlIiwidG9Mb3dlckNhc2UiLCJyZW1vdmUiLCJhZGQiLCJyZW1vdmVBdHRyaWJ1dGUiLCJwbGFjZVNoaXAiLCJvcmllbnRhdGlvbiIsImlzVmVydGljYWwiLCJpc0hvcml6b250YWwiLCJjZWxscyIsInN0YXJ0Iiwic2hpcENlbGxzIiwic2l6ZSIsImN1cnJlbnRDb2wiLCJjdXJyZW50Um93IiwicHVzaCIsInJlY2VpdmVBdHRhY2siLCJoaXQiLCJyZWNlaXZlQXJvdW5kIiwicmVzZXJ2ZVNwYWNlIiwiZmlsdGVyIiwiYyIsImRpcmVjdGlvbiIsIm5ld0NvbCIsIlN0cmluZyIsImZyb21DaGFyQ29kZSIsImNoYXJDb2RlQXQiLCJuZXdSb3ciLCJOdW1iZXIiLCJ0b1N0cmluZyIsImhpdEJ1dE5vdFN1bmsiLCJzb21lIiwiaXNTdW5rIiwic2lua1NoaXAiLCJhbGxTdW5rIiwidGFrZW5CeUNlbGxzIiwiZXZlcnkiLCJjYW5CZVBsYWNlZCIsImFyZUVtcHR5IiwiaXRlbSIsInJlbW92ZVJlc2VydmVkU3BhY2UiLCJoaXRDb3VudCIsInJvdGF0ZSIsInRoaXMiLCJwcmV2SGl0IiwibGFzdEhpdCIsInJhbmdlIiwiZ29SaWdodCIsImdvRG93biIsImZpbmlzaGluZ0F0dGFjayIsImNvbnNvbGUiLCJsb2ciLCJzZXRQcmV2SGl0Iiwic2V0TGFzdEhpdCIsIm5ld1ByZXZIaXQiLCJuZXdMYXN0SGl0IiwiYXR0YWNrIiwicmVzdWx0IiwicmFuZG9tQXR0YWNrIiwicmFuZG9tQ29sIiwicmFuZG9tUm93IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiY2VpbCIsImZvbGxvd3VwQXR0YWNrIiwidmFsaWREaXJlY3Rpb25zIiwicmFuZG9tRGlyZWN0aW9uIiwiZ2V0UHJldkhpdCIsImdldExhc3RIaXQiLCJfX2F3YWl0ZXIiLCJ0aGlzQXJnIiwiX2FyZ3VtZW50cyIsIlAiLCJnZW5lcmF0b3IiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImZ1bGZpbGxlZCIsInZhbHVlIiwic3RlcCIsIm5leHQiLCJlIiwicmVqZWN0ZWQiLCJkb25lIiwidGhlbiIsImFwcGx5IiwidWkiLCJib2FyZHMiLCJxdWVyeVNlbGVjdG9yIiwicFZjQnRuIiwibmV3R2FtZUJ0biIsImNWY0J0biIsInN0YXJ0QnRuIiwicmFuZG9tQnRuIiwiYWxsQnRucyIsInJlbmRlckNlbGxzIiwiYm9hcmQiLCJlbGVtZW50IiwiY3JlYXRlRWxlbWVudCIsInNldEF0dHJpYnV0ZSIsImNyZWF0ZUNlbGwiLCJhcHBlbmQiLCJyZWZyZXNoQm9hcmQiLCJpbm5lckhUTUwiLCJnZXRVc2VySW5wdXQiLCJ0YXJnZXQiLCJoYW5kbGVHYW1lTW9kZSIsInNlbGVjdGVkRWxlbWVudCIsImRlc2VsZWN0ZWRFbGVtZW50Iiwid2FpdGluZyIsImJ0biIsImRpc2FibGVkIiwidGV4dENvbnRlbnQiLCJzZXRUaW1lb3V0IiwicmVzdGFydCIsImJvb2wiLCJkb2N1bWVudEVsZW1lbnQiLCJ0b2dnbGUiLCJjcmVhdGVTaGlwT3ZlcmxheSIsImdhbWVib2FyZE5hbWUiLCJzaGlwcyIsImZpcnN0Q2VsbCIsInNoaXBFbGVtZW50Iiwic2hpcE5hbWUiLCJzaGlwU2l6ZSIsInNldFNoaXBTdHlsZSIsInN0eWxlIiwid2lkdGgiLCJjZWxsU2l6ZSIsImhlaWdodCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsIndpbmRvdyIsImFkZEV2ZW50TGlzdGVuZXIiLCJhcHBlbmRDaGlsZCIsImNhbkJlU3RhcnRlZCIsImRyYWdBbmREcm9wIiwiZmlyc3RHYW1lYm9hcmQiLCJzZWNvbmRHYW1lYm9hcmQiLCJzaGlwT2JqIiwiZ3JhYlBvaW50WCIsImdyYWJQb2ludFkiLCJoaWdobGlnaHRlZENlbGxzIiwic2hpcE5hbWVUb09iaiIsImNhcnJpZXIiLCJiYXR0bGVzaGlwIiwiZGVzdHJveWVyIiwic3VibWFyaW5lIiwicGF0cm9sYm9hdCIsImZpcnN0Qm9hcmRFbGVtZW50Iiwic2Vjb25kQm9hcmRFbGVtZW50IiwiZmlyc3RCb2FyZENlbGxzIiwic2Vjb25kQm9hcmRDZWxscyIsIm5vblNoaXBDZWxscyIsImRyYWdnYWJsZSIsImhhbmRsZU1vdXNlZG93biIsImhhbmRsZU1vdXNldXAiLCJoYW5kbGVEcmFnU3RhcnQiLCJoYW5kbGVEcmFnRW5kIiwiaGFuZGxlUm90YXRlIiwiYmxvY2tSaWdodENsaWNrIiwibGFzdERyYWdnZWQiLCJ0YXJnZXRTaGlwTmFtZSIsInVwZGF0ZWRTaGlwc1BsYWNlZEZpcnN0IiwidXBkYXRlZFNoaXBzUGxhY2VkVGVtcCIsImh1bWFuU2hpcHMiLCJ2aXNpYmlsaXR5Iiwib2Zmc2V0WCIsIm9mZnNldFkiLCJjbG9zZXN0IiwiaWQiLCJoYW5kbGVEcmFnT3ZlciIsImluZGV4IiwicHJldmVudERlZmF1bHQiLCJzdGFydENlbGwiLCJvZmZzZXRIZWlnaHQiLCJvZmZzZXRXaWR0aCIsInRvSGlnaGxpZ2h0IiwiY2VsbEluZGV4IiwiaXNWYWxpZFBsYWNlbWVudCIsImdldExhc3RTaGlwU2l6ZUVsZW1lbnRzIiwiaGFuZGxlRHJhZ0xlYXZlIiwiaGlnaGxpZ2h0ZWRDZWxsIiwiaGFuZGxlRHJvcCIsImxhc3QiLCJkYXRhc2V0Iiwic2xpY2UiLCJtaW4iLCJ0ZW1wU2hpcCIsImN1cnJlbnQiLCJzZWNvbmQiLCJuZXdHYW1lIiwicmFuZG9taXplU2hpcHNQbGFjZW1lbnQiLCJyZW5kZXJCb2FyZCIsImhhbmRsZVVzZXJJbnB1dCIsInVzZXJJbnB1dCIsIm9uY2UiLCJzZXRCb2FyZFBvaW50ZXIiLCJ3aGljaCIsInJlbW92ZUJvYXJkUG9pbnRlciIsImNvbnRyb2xsZXIiLCJodW1hbiIsInBsYXllciIsImNvbXB1dGVyIiwiaXNTdG9wcGVkIiwiaHVtYW5DYXJyaWVyIiwiaHVtYW5CYXR0bGVzaGlwIiwiaHVtYW5EZXN0cm95ZXIiLCJodW1hblN1Ym1hcmluZSIsImh1bWFuUGF0cm9sYm9hdCIsInBvcHVsYXRlU2hpcHMiLCJpc0dhbWVPdmVyIiwiY29tcHV0ZXJBSSIsImFsbFNoaXBzIiwicmFuZG9tT3JpZW50YXRpb24iLCJyYW5kb21QbGFjZW1lbnQiLCJwaWNrR2FtZU1vZGUiLCJpc1BsYXllclR1cm4iLCJpbml0Il0sInNvdXJjZVJvb3QiOiIifQ==