(()=>{"use strict";const e=()=>{const e=["A","B","C","D","E","F","G","H","I","J"],t=["1","2","3","4","5","6","7","8","9","10"],r=[],a=[],s=(a,s)=>{const o=e.indexOf(a),n=t.indexOf(s);return-1===o||-1===n?null:r[n][o]},o=(a,s,o,n)=>{const i=e.indexOf(a),l=t.indexOf(s);return-1===i||-1===l?null:(r[l][i].status=o,n&&(r[l][i].takenBy=n),r[l][i])};return{generateArray:()=>{for(let a=0;a<10;a+=1){r[a]=[];for(let s=0;s<10;s+=1)r[a][s]={col:e[s],row:t[a],status:"empty",takenBy:null}}},clearBoard:()=>{r.flat().forEach((e=>{e.status="empty",e.takenBy=void 0})),a.length=0},getCell:s,setCell:o,removeShip:(e,t)=>{t.array.flat().forEach((t=>{"taken"===t.status&&t.takenBy.name===e.name&&(t.status="empty",t.takenBy=null);const r=a.indexOf(t);null===t.takenBy&&-1!==r&&a.splice(r,1)}))},placeShip:(r,n,i,l)=>{const c="horizontal"===l,d=c?e:t,u=d.indexOf(c?n:i);r.isVertical="horizontal"!==l;let h=[];if(u<0||u+r.size>d.length)return!1;for(let e=0;e<r.size;e+=1){const t=c?d[u+e]:n,a=c?i:d[u+e];if("empty"!==s(t,a).status)return!1;o(t,a,"taken",r),h.push(s(t,a))}return a.push(h[0]),!0},receiveAttack:(e,t)=>{const r=s(e,t);return"taken"===r.status?(r.takenBy.hit(),o(e,t,"hit"),r.status):"empty"===r.status||"reserved"===r.status?(o(e,t,"miss"),r.status):null},receiveAround:(e,t)=>{const r=s(e,t);return"empty"===r.status?(o(e,t,"reserved"),r.status):null},reserveSpace:(e,t,r)=>{const a=e.getCell(t,r);if(a&&a.takenBy){e.array.flat().filter((e=>e.takenBy&&e.takenBy.name===a.takenBy.name)).forEach((t=>{[{col:0,row:-1},{col:0,row:1},{col:-1,row:0},{col:1,row:0},{col:-1,row:-1},{col:-1,row:1},{col:1,row:-1},{col:1,row:1}].forEach((r=>{const a=String.fromCharCode(t.col.charCodeAt(0)+r.col),s=(Number(t.row)+r.row).toString();e.getCell(a,s)&&e.receiveAround(a,s)}))}))}},reserveSpaceForAll:function(e){e.shipsPlaced.forEach((t=>{e.reserveSpace(e,t.col,t.row)}))},hitButNotSunk:e=>e.array.flat().some((e=>"hit"===e.status&&!1===e.takenBy.isSunk())),sinkShip:(e,t,r)=>{const a=e.getCell(t,r);if(a&&a.takenBy&&a.takenBy.isSunk()){e.array.flat().filter((e=>e.takenBy&&e.takenBy.name===a.takenBy.name)).forEach((t=>{[{col:0,row:-1},{col:0,row:1},{col:-1,row:0},{col:1,row:0},{col:-1,row:-1},{col:-1,row:1},{col:1,row:-1},{col:1,row:1}].forEach((r=>{const a=String.fromCharCode(t.col.charCodeAt(0)+r.col),s=(Number(t.row)+r.row).toString();e.getCell(a,s)&&e.receiveAttack(a,s)}))}))}},allSunk:e=>{let t=e.array.flat().filter((e=>e.takenBy));return!!(t.length>0&&t.every((e=>e.takenBy.isSunk())))},array:r,canBePlaced:(r,a,o,n)=>{const i="horizontal"===n,l=i?e:t,c=l.indexOf(i?a:o);if(c<0||c+r>l.length)return!1;const d=[];for(let e=0;e<r;e+=1){const t=i?l[c+e]:a,r=i?o:l[c+e];d.push("empty"===s(t,r).status)}return d.every((e=>!0===e))},shipsPlaced:a,removeReservedSpace:e=>{e.array.flat().forEach((e=>{"reserved"===e.status&&o(e.col,e.row,"empty")}))}}},t=e=>{let t;return"Carrier"===e&&(t=5),"Battleship"===e&&(t=4),"Destroyer"===e&&(t=3),"Submarine"===e&&(t=3),"PatrolBoat"===e&&(t=2),{name:e,size:t,hitCount:0,isVertical:!1,rotate(){this.isVertical=!this.isVertical},hit(){this.hitCount+=1},isSunk(){return this.hitCount===t}}},r=()=>{const e=["A","B","C","D","E","F","G","H","I","J"];let t=null,r=null,a=1,s=!0,o=!0;const n=(e,t,c,d)=>{if(d.row===c)if(s){a=1;let o=String.fromCharCode(t.charCodeAt(0)+a);for(;e.getCell(o,c)&&"hit"===e.getCell(o,c).status;)a+=1,o=String.fromCharCode(t.charCodeAt(0)+a);e.getCell(o,c)&&"hit"!==e.getCell(o,c).status&&"miss"!==e.getCell(o,c).status?(e.receiveAttack(o,c),"hit"===e.getCell(o,c).status&&(i(r),l({col:o,row:c})),a+=1):(a=1,s=!1,n(e,o,c,d))}else{a=1;let o=String.fromCharCode(t.charCodeAt(0)-a);for(;e.getCell(o,c)&&"hit"===e.getCell(o,c).status;)a+=1,o=String.fromCharCode(t.charCodeAt(0)-a);e.getCell(o,c)&&"hit"!==e.getCell(o,c).status&&"miss"!==e.getCell(o,c).status?(e.receiveAttack(o,c),"hit"===e.getCell(o,c).status&&(i(r),l({col:o,row:c})),a+=1):(a=1,s=!0,n(e,o,c,d))}else if(d.col===t)if(o){a=1;let s=(Number(c)+a).toString();for(;e.getCell(t,s)&&"hit"===e.getCell(t,s).status;)a+=1,s=(Number(c)+a).toString();e.getCell(t,s)&&"hit"!==e.getCell(t,s).status&&"miss"!==e.getCell(t,s).status?(e.receiveAttack(t,s),"hit"===e.getCell(t,s).status&&(i(r),l({col:t,row:s})),a+=1):(a=1,o=!1,n(e,t,s,d))}else{a=1;let s=(Number(c)-a).toString();for(;e.getCell(t,s)&&"hit"===e.getCell(t,s).status;)a+=1,s=(Number(c)-a).toString();e.getCell(t,s)&&"hit"!==e.getCell(t,s).status&&"miss"!==e.getCell(t,s).status?(e.receiveAttack(t,s),"hit"===e.getCell(t,s).status&&(i(r),l({col:t,row:s})),a+=1):(a=1,o=!0,n(e,t,s,d))}},i=e=>{t=e},l=e=>{r=e};return{attack:(e,t,a)=>{if("hit"!==e.getCell(t,a).status&&"miss"!==e.getCell(t,a).status){let s=e.receiveAttack(t,a);return"hit"===s&&(i(r),l({col:t,row:a})),s}return"already shot"},randomAttack:t=>{let a,s;do{a=e[Math.floor(Math.random()*e.length)],s=Math.ceil(10*Math.random()).toString()}while("hit"===t.getCell(a,s).status||"miss"===t.getCell(a,s).status);if("hit"!==t.getCell(a,s).status&&"miss"!==t.getCell(a,s).status){const e=t.receiveAttack(a,s);return"hit"===t.getCell(a,s).status&&(i(r),l({col:a,row:s})),{result:e,col:a,row:s}}return{result:"already shot",col:a,row:s}},followupAttack:(e,t,s)=>{const o=[{col:0,row:-1},{col:0,row:1},{col:-1,row:0},{col:1,row:0}].filter((r=>{const a=String.fromCharCode(t.charCodeAt(0)+r.col),o=(Number(s)+r.row).toString(),n=e.getCell(a,o);return!(!n||"miss"===n.status||"hit"===n.status)}));if(o.length>0){const n=o[Math.floor(Math.random()*o.length)],c=String.fromCharCode(t.charCodeAt(0)+n.col),d=(Number(s)+n.row).toString();e.receiveAttack(c,d),a=1,"hit"===e.getCell(c,d).status&&(i(r),l({col:c,row:d}))}},finishingAttack:n,prevHit:t,lastHit:r,getPrevHit:()=>t,getLastHit:()=>r,setPrevHit:i,setLastHit:l}};var a=function(e,t,r,a){return new(r||(r=Promise))((function(s,o){function n(e){try{l(a.next(e))}catch(e){o(e)}}function i(e){try{l(a.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,i)}l((a=a.apply(e,t||[])).next())}))};const s=(e,t,r)=>{const s=document.querySelector("#firstBoard"),o=document.querySelector("#secondBoard"),n=s.querySelectorAll(".cell"),l=o.querySelectorAll(".cell");let c,u,h,m,f=0,g=0,v=[];const p={carrier:r[0],battleship:r[1],destroyer:r[2],submarine:r[3],patrolboat:r[4]};let y=null;const S=document.querySelectorAll(".draggable");function w(e){return Array.from(e).filter((e=>!e.classList.contains("taken")))}const C=[...w(n),...w(l)];function B(e,t){return e.slice(Math.min(e.length-t,0))}function b(r){const a=r.target;let s;const o=a.closest(".board").id;return"firstBoard"===o&&(s=e),"secondBoard"===o&&(s=t),{target:a,gameboard:s}}function L(e,t){return c=t.getAttribute("data-name"),u=Number(t.getAttribute("data-size")),f=e.offsetX,g=e.offsetY,h=p[c],m=h.isVertical?"vertical":"horizontal",{shipName:c,shipObj:h}}function k(){v.forEach((e=>e.classList.remove("highlight")))}function A(e){return"firstBoard"===e||"secondBoard"===e}function P(e){const{gameboard:t}=b(e);t.removeReservedSpace(t),function(e,t){const{target:r}=b(t),a=r.getAttribute("data-name");let s=e.shipsPlaced.filter((e=>a!==e.takenBy.name.toLowerCase()));s.forEach((t=>{e.reserveSpace(e,t.col,t.row)}))}(t,e),d.renew(),i.setInitMessage()}function E(e){return a(this,void 0,void 0,(function*(){yield new Promise((e=>setTimeout(e,0)));const{target:t,gameboard:r}=b(e);t.style.visibility="hidden",L(e,t),r.removeShip(h,r),i.clearShip(h,r)}))}function H(e){return function(t){const{target:r}=b(t),a=r.closest(".board").id;if(A(a)&&(t.preventDefault(),h)){const r=function(e,t,r){const{target:a}=b(r);return e-(t.isVertical?10*Math.floor(g/a.offsetHeight):Math.floor(f/a.offsetWidth))}(e,h,t),s=function(e){return"firstBoard"===e?n:l}(a),o=[];!function(e,t,r,a){for(let s=0;s<u;s++){let o=e.isVertical?t+10*s:t+s;r[o]&&(a.push(r[o]),v.push(r[o]))}}(h,r,s,o),function(e){return e.every((e=>e.classList.contains("empty")))&&(e.every((t=>t.dataset.col===e[0].dataset.col))||e.every((t=>t.dataset.row===e[0].dataset.row)))&&e.length===u&&e.every((e=>e.dataset.col>="A"&&e.dataset.col<="J"))&&e.every((e=>Number(e.dataset.row)>=1&&Number(e.dataset.row)<=10))}(o)&&(!function(e){e.forEach((e=>{e.classList.add("highlight")}))}(o),y||(y=B(v,u)))}}}function M(){k(),v.length=0}function V(e){k();const t=B(v,u),{target:r,gameboard:a}=b(e);A(r.closest(".board").id)&&h&&null!==y&&function(e,t,r,a){e.canBePlaced(t.size,r[0].dataset.col,r[0].dataset.row,a)?(e.placeShip(t,r[0].dataset.col,r[0].dataset.row,a),e.reserveSpace(e,r[0].dataset.col,r[0].dataset.row)):(e.placeShip(t,y[0].dataset.col,y[0].dataset.row,a),e.reserveSpace(e,y[0].dataset.col,y[0].dataset.row))}(a,h,t,m),a.removeReservedSpace(a),a.reserveSpaceForAll(a),d.renew(),i.canBeStarted(),i.setStartMessage(),y=null}function q(r){const a=r.target;a.style.visibility="visible",function(r,a){if(0===v.length){const s=r.closest(".board");if(s){let{gameboard:r}=b(a);"firstBoard"===s.id?r=e:"secondBoard"===s.id&&(r=t),r&&y&&r.canBePlaced(h.size,y[0].dataset.col,y[0].dataset.row,m)&&(r.placeShip(h,y[0].dataset.col,y[0].dataset.row,m),r.reserveSpace(r,y[0].dataset.col,y[0].dataset.row),d.renew())}}}(a,r),i.canBeStarted()&&i.fillCells("second"),i.setStartMessage()}function x(e){const{gameboard:t}=b(e);t.reserveSpaceForAll(t),d.renew(),i.setStartMessage()}function z(e){e.preventDefault();const{target:t,gameboard:r}=b(e),{shipName:a,shipObj:s}=L(e,t),o=r.shipsPlaced.filter((e=>e.takenBy.name.toLowerCase()===a));r.removeShip(s,r),r.removeReservedSpace(r),r.reserveSpaceForAll(r),s.rotate(),m=s.isVertical?"vertical":"horizontal",r.canBePlaced(s.size,o[0].col,o[0].row,m)||(s.rotate(),m=s.isVertical?"vertical":"horizontal"),r.placeShip(s,o[0].col,o[0].row,m),r.reserveSpaceForAll(r),d.renew(),i.canBeStarted()&&i.fillCells("second")}function G(e){e.preventDefault()}function O(e){e.forEach(((e,t)=>{e.addEventListener("dragover",H(t)),e.addEventListener("dragleave",M),e.addEventListener("drop",V)}))}O(n),O(l),S.forEach((e=>{e.addEventListener("mousedown",P),e.addEventListener("dragstart",E),e.addEventListener("dragend",q),e.addEventListener("mouseup",x),e.addEventListener("contextmenu",z),C.forEach((e=>e.addEventListener("contextmenu",G)))}))};var o=function(e,t,r,a){return new(r||(r=Promise))((function(s,o){function n(e){try{l(a.next(e))}catch(e){o(e)}}function i(e){try{l(a.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,i)}l((a=a.apply(e,t||[])).next())}))};const n=(()=>{const e=document.querySelector("#messageBox p"),t=document.querySelector("#boards"),r=document.querySelector("#playerVsComputer"),a=document.querySelector("#newGame"),i=document.querySelector("#computerVsComputer"),l=document.querySelector("#start"),c=document.querySelector("#randomPlacement"),u=[r,a,i,l,c],h=document.getElementsByName("speed");let m=1e3;const f=(e,t)=>{e.array.forEach((e=>{e.forEach((e=>{const r=(e=>{const t=document.createElement("div");return t.classList.add("cell"),t.classList.add(e.status),t.setAttribute("data-col",e.col),t.setAttribute("data-row",e.row),e.takenBy&&t.setAttribute("data-shipName",e.takenBy.name.toLowerCase()),t})(e);t.append(r)}))}))},g=e=>e===d.humanGameboard?"firstBoard":e===d.computerGameboard?"secondBoard":void 0,v=e=>{const t=document.querySelector(`#${g(e)}`);t.innerHTML="",f(e,t)},p=e=>{if(!e.target.classList.contains("hit")&&!e.target.classList.contains("miss")){return{col:e.target.getAttribute("data-col"),row:e.target.getAttribute("data-row")}}},y=(e,t)=>{t.classList.remove("selected"),e.classList.contains("selected")||(e.classList.add("selected"),e===r&&o(void 0,void 0,void 0,(function*(){L("first"),S(!0),u.forEach((e=>e.disabled=!0)),yield new Promise((e=>setTimeout(e,A()))),u.forEach((e=>e.disabled=!1)),S(!1),w(),C()})),e===i&&o(void 0,void 0,void 0,(function*(){S(!0),u.forEach((e=>e.disabled=!0)),yield new Promise((e=>setTimeout(e,A()))),u.forEach((e=>e.disabled=!1)),S(!1),l.disabled=!0,c.disabled=!0,i.disabled=!0})),d.restart(),b())},S=e=>{document.documentElement.classList.toggle("wait",e)},w=()=>5===d.humanGameboard.shipsPlaced.length&&0===d.computerGameboard.shipsPlaced.length?(L("second"),l.disabled=!1,!0):(l.disabled=!0,!1),C=()=>{const t="Use 'Random Placement' button, then press Start!",r="Drag and drop ships onto the left board or use 'Random Placement' button. Right click to rotate. When ready, press Start!";e.textContent!==t&&e.textContent!==r&&"Restarting..."!==e.textContent&&"You can now begin the game. Press start!"!==e.textContent||(e.textContent=t,window.matchMedia("(min-width: 1024px)").matches&&(e.textContent=r))},B=()=>{w()&&(e.textContent="You can now begin the game. Press start!")},b=()=>{e.textContent="Restarting..."},L=e=>{let t;"first"===e?t=document.querySelector("#firstBoard"):"second"===e&&(t=document.querySelector("#secondBoard"));t.querySelectorAll(".cell").forEach((e=>{e.classList.add("filled")}))},k=e=>o(void 0,void 0,void 0,(function*(){let t;S(!0),"first"===e?t=document.querySelector("#firstBoard"):"second"===e&&(t=document.querySelector("#secondBoard"));const r=t.querySelectorAll(".cell");r.forEach((e=>{e.classList.add("filled")})),yield new Promise((e=>{r.forEach(((t,a)=>{setTimeout((()=>{t.classList.remove("filled"),a===r.length-1&&e()}),A()/120*a)}))})),S(!1)}));r.addEventListener("click",(()=>{L("first"),y(r,i);document.querySelector("#secondBoard").classList.remove("start"),l.disabled=!0,r.disabled=!0,k("first")})),i.addEventListener("click",(()=>{L("first"),L("second"),y(i,r);const e=document.querySelector("#secondBoard");e.classList.remove("hide"),e.classList.add("start"),l.disabled=!0,c.disabled=!0,i.disabled=!0,Promise.all([k("first"),k("second")])})),a.addEventListener("click",(()=>o(void 0,void 0,void 0,(function*(){L("first"),i.classList.contains("selected")&&(L("second"),l.disabled=!0,c.disabled=!0,i.disabled=!0),n.removeBoardPointer(),yield o(void 0,void 0,void 0,(function*(){b(),S(!0),u.forEach((e=>e.disabled=!0)),yield d.newGame(),u.forEach((e=>e.disabled=!1)),S(!1),w(),r.classList.contains("selected")&&C()}));const e=document.querySelector("#secondBoard");e.classList.remove("hide"),r.classList.contains("selected")&&(e.classList.remove("start"),k("first"),l.disabled=!0,r.disabled=!0),i.classList.contains("selected")&&(e.classList.add("start"),c.disabled=!0,Promise.all([k("first"),k("second")]),l.disabled=!0,c.disabled=!0,i.disabled=!0)})))),l.addEventListener("click",(()=>{d.start();document.querySelector("#firstBoard").classList.add("hide");const e=document.querySelector("#secondBoard");e.classList.add("hide"),e.classList.add("start"),l.disabled=!0,c.disabled=!0,k("second")})),c.addEventListener("click",(()=>{d.computerGameboard.clearBoard(),v(d.computerGameboard),d.randomizeShipsPlacement(d.humanGameboard),s(d.humanGameboard,d.computerGameboard,d.humanShips),w(),B(),L("second")})),h.forEach((e=>{e.addEventListener("click",(()=>{let t=e;t.checked&&(m=Number(t.value))}))}));const A=()=>m;return window.addEventListener("resize",C),{renderBoard:e=>{const r=document.createElement("div");r.classList.add("board"),r.id=g(e),f(e,r),t.append(r)},clearShip:(e,t)=>{document.querySelectorAll(`#${g(t)} .cell`).forEach((t=>{t.classList.contains("taken")&&t.getAttribute("data-shipName")===e.name.toLowerCase()&&(t.classList.remove("taken"),t.classList.add("empty"),t.removeAttribute("data-shipName"))}))},refreshBoard:v,handleUserInput:()=>o(void 0,void 0,void 0,(function*(){const e=document.querySelectorAll("#secondBoard .cell");let t;do{t=yield new Promise((t=>{e.forEach((e=>{e.classList.contains("hit")||e.classList.contains("miss")||e.addEventListener("click",(e=>{t(p(e))}),{once:!0})}))}))}while(!t);return{col:t.col.toString(),row:t.row.toString()}})),pVcBtn:r,cVcBtn:i,waiting:S,setBoardPointer:e=>{const t=document.querySelector("#secondBoard");"player"===e?t.classList.add("boardOutline"):"computer"===e&&t.classList.remove("boardOutline")},removeBoardPointer:()=>{document.querySelector("#secondBoard").classList.remove("boardOutline")},createShipOverlay:e=>{e.shipsPlaced.forEach((t=>{const r=document.createElement("div"),a=t.takenBy.name.toLowerCase(),s=t.takenBy.size,o=t.takenBy.isVertical;r.classList.add("ship",a),r.setAttribute("data-size",`${s}`),r.setAttribute("data-name",`${a}`),r.setAttribute("draggable","true"),r.classList.add("draggable");const n=()=>{const e=document.querySelector("html"),t=parseFloat(window.getComputedStyle(e,null).getPropertyValue("font-size"));o?o&&(r.style.width=i/t+"rem",r.style.height=s*(i/t)+"rem"):(r.style.width=s*(i/t)+"rem",r.style.height=i/t+"rem")};let i=document.querySelector(".board .cell").getBoundingClientRect().width;n(),window.addEventListener("resize",(function(){i=document.querySelector(".board .cell").getBoundingClientRect().width,n()}));document.querySelector(`#${g(e)} .cell[data-col="${t.col}"][data-row="${t.row}"]`).appendChild(r)}))},canBeStarted:w,setInitMessage:C,setStartMessage:B,setTurnMessagePvC:t=>{e.textContent=t?"Player's turn. Take aim and attack!":"Computer's turn. The shot is coming!"},setTurnMessageCvC:t=>{e.textContent=t?"Violet's turn":"Blue's turn"},setGameOverMessagePvC:t=>{"player"===t?e.textContent="Game over, Player wins!":"computer"===t&&(e.textContent="Game over, Computer wins!")},setGameOverMessageCvC:t=>{"player"===t?e.textContent="Game over, Blue Computer wins!":"computer"===t&&(e.textContent="Game over, Violet Computer wins!")},setRestartMessage:b,getSpeedValue:A,fillCells:L,unFillCells:k}})(),i=n;var l=function(e,t,r,a){return new(r||(r=Promise))((function(s,o){function n(e){try{l(a.next(e))}catch(e){o(e)}}function i(e){try{l(a.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,i)}l((a=a.apply(e,t||[])).next())}))};const c=(()=>{const a=e(),o=e(),n=r(),d=r();let u=!0,h=t("Carrier"),m=t("Battleship"),f=t("Destroyer"),g=t("Submarine"),v=t("PatrolBoat");const p=[h,m,f,g,v],y=()=>{o.placeShip(h,"A","1","horizontal"),o.placeShip(m,"A","3","horizontal"),o.placeShip(f,"A","5","horizontal"),o.placeShip(g,"A","7","horizontal"),o.placeShip(v,"A","9","horizontal"),o.reserveSpace(o,"A","1"),o.reserveSpace(o,"A","3"),o.reserveSpace(o,"A","5"),o.reserveSpace(o,"A","7"),o.reserveSpace(o,"A","9")},S=()=>o.allSunk(o)?(i.removeBoardPointer(),i.pVcBtn.classList.contains("selected")&&i.setGameOverMessagePvC("player"),i.cVcBtn.classList.contains("selected")&&i.setGameOverMessageCvC("player"),!0):!!a.allSunk(a)&&(i.removeBoardPointer(),i.pVcBtn.classList.contains("selected")&&i.setGameOverMessagePvC("computer"),i.cVcBtn.classList.contains("selected")&&i.setGameOverMessageCvC("computer"),!0),w=e=>{let t;if(e===a?t=d:e===o&&(t=n),e.hitButNotSunk(e)){if(null!==t.getPrevHit()&&null!==t.getLastHit()&&e.getCell(t.getLastHit().col,t.getLastHit().row).takenBy.hitCount>=2&&e.getCell(t.getLastHit().col,t.getLastHit().row).takenBy.hitCount<=4){if(t.finishingAttack(e,t.getLastHit().col,t.getLastHit().row,t.getPrevHit()),e.sinkShip(e,t.getLastHit().col,t.getLastHit().row),S())return}else if(1===e.getCell(t.getLastHit().col,t.getLastHit().row).takenBy.hitCount&&(t.followupAttack(e,t.getLastHit().col,t.getLastHit().row),e.sinkShip(e,t.getLastHit().col,t.getLastHit().row),S()))return}else{const{col:r,row:a}=t.randomAttack(e);if("hit"===e.getCell(r,a).status&&(t.setPrevHit(t.getLastHit()),t.setLastHit({col:r,row:a})),"hit"===e.getCell(r,a).status&&e.getCell(r,a).takenBy.isSunk()&&(e.sinkShip(e,r,a),t.setPrevHit(null),t.setLastHit(null),S()))return}},C=e=>{e.clearBoard(),(e=>{let r;e===a?(h=t("Carrier"),m=t("Battleship"),f=t("Destroyer"),g=t("Submarine"),v=t("PatrolBoat"),r=[h,m,f,g,v]):e===o&&(r=[t("Carrier"),t("Battleship"),t("Destroyer"),t("Submarine"),t("PatrolBoat")]);c.humanShips.length=0;const s=["A","B","C","D","E","F","G","H","I","J"],n=()=>s[Math.floor(Math.random()*s.length)],i=()=>Math.ceil(10*Math.random()).toString(),l=()=>Math.random()>.5?"horizontal":"vertical";r.forEach((t=>{let r=n(),a=i(),s=l(),o=e.canBePlaced(t.size,r,a,s);for(;!o;)r=n(),a=i(),s=l(),o=e.canBePlaced(t.size,r,a,s);o&&(e.placeShip(t,r,a,s),e.reserveSpace(e,r,a)),c.humanShips.push(t)}))})(e),i.refreshBoard(e),e===a&&i.createShipOverlay(e)},B=()=>{i.cVcBtn.classList.contains("selected")&&(C(a),C(o),u=!1,l(void 0,void 0,void 0,(function*(){i.removeBoardPointer();let e=!0;for(;!S()&&!u;){if(i.waiting(!0),e){if(i.setTurnMessageCvC(e),yield new Promise((e=>setTimeout(e,i.getSpeedValue()))),!i.cVcBtn.classList.contains("selected")||u)break;w(a),i.refreshBoard(a),e=!1}if(S()||u)break;if(!e){if(i.setTurnMessageCvC(e),yield new Promise((e=>setTimeout(e,i.getSpeedValue()))),!i.cVcBtn.classList.contains("selected")||u)break;w(o),i.refreshBoard(o),e=!0}}u=!1,i.waiting(!1)})),i.refreshBoard(a))},b=()=>{u=!0,n.setPrevHit(null),n.setLastHit(null),d.setPrevHit(null),d.setLastHit(null),a.clearBoard(),o.clearBoard(),y(),i.refreshBoard(a),i.refreshBoard(o),i.createShipOverlay(o),s(a,o,p),i.canBeStarted(),B(),p.forEach((e=>{!0===e.isVertical&&(e.isVertical=!1)}))};return{init:()=>{i.setInitMessage(),a.generateArray(),o.generateArray(),i.renderBoard(a),i.renderBoard(o),y(),i.refreshBoard(o),i.createShipOverlay(o),s(a,o,p),i.canBeStarted(),B(),i.unFillCells("first"),i.pVcBtn.disabled=!0},renew:()=>{i.refreshBoard(a),i.refreshBoard(o),i.createShipOverlay(a),i.createShipOverlay(o),s(a,o,p)},humanGameboard:a,computerGameboard:o,restart:b,newGame:()=>l(void 0,void 0,void 0,(function*(){u=!0,yield new Promise((e=>setTimeout(e,i.getSpeedValue()))),u=!1,b()})),start:()=>{i.refreshBoard(a),C(o),u=!1,l(void 0,void 0,void 0,(function*(){let e=!0;for(;!S()&&!u;){if(e){i.setTurnMessagePvC(e),i.setBoardPointer("player"),i.waiting(!1);const{col:t,row:r}=yield i.handleUserInput();n.attack(o,t,r),o.sinkShip(o,t,r),i.refreshBoard(o),e=!1}if(S()||u)break;if(!e){if(i.setTurnMessagePvC(e),i.setBoardPointer("computer"),i.waiting(!0),yield new Promise((e=>setTimeout(e,i.getSpeedValue()))),!i.pVcBtn.classList.contains("selected")||u)break;w(a),i.refreshBoard(a),e=!0}}u=!1,i.waiting(!1)}))},randomizeShipsPlacement:C,humanShips:p}})(),d=c;d.init()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9tb2R1bGVzL3NoaXAudHMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9tb2R1bGVzL3BsYXllci50cyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL21vZHVsZXMvZHJhZ0FuZERyb3AudHMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9tb2R1bGVzL3VpLnRzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvbW9kdWxlcy9jb250cm9sbGVyLnRzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZ2FtZWJvYXJkRmFjdG9yeSA9ICgpID0+IHtcbiAgICBjb25zdCBjb2xzID0gWydBJywgJ0InLCAnQycsICdEJywgJ0UnLCAnRicsICdHJywgJ0gnLCAnSScsICdKJ107XG4gICAgY29uc3Qgcm93cyA9IFsnMScsICcyJywgJzMnLCAnNCcsICc1JywgJzYnLCAnNycsICc4JywgJzknLCAnMTAnXTtcbiAgICBjb25zdCBhcnJheSA9IFtdO1xuICAgIGNvbnN0IHNoaXBzUGxhY2VkID0gW107XG4gICAgY29uc3QgZ2VuZXJhdGVBcnJheSA9ICgpID0+IHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgaSArPSAxKSB7XG4gICAgICAgICAgICBhcnJheVtpXSA9IFtdO1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAxMDsgaiArPSAxKSB7XG4gICAgICAgICAgICAgICAgYXJyYXlbaV1bal0gPSB7IGNvbDogY29sc1tqXSwgcm93OiByb3dzW2ldLCBzdGF0dXM6ICdlbXB0eScsIHRha2VuQnk6IG51bGwgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3QgY2xlYXJCb2FyZCA9ICgpID0+IHtcbiAgICAgICAgYXJyYXkuZmxhdCgpLmZvckVhY2goKGNlbGwpID0+IHtcbiAgICAgICAgICAgIGNlbGwuc3RhdHVzID0gJ2VtcHR5JztcbiAgICAgICAgICAgIGNlbGwudGFrZW5CeSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfSk7XG4gICAgICAgIHNoaXBzUGxhY2VkLmxlbmd0aCA9IDA7XG4gICAgfTtcbiAgICBjb25zdCBnZXRDZWxsID0gKGNvbCwgcm93KSA9PiB7XG4gICAgICAgIGNvbnN0IGNvbEluZGV4ID0gY29scy5pbmRleE9mKGNvbCk7XG4gICAgICAgIGNvbnN0IHJvd0luZGV4ID0gcm93cy5pbmRleE9mKHJvdyk7XG4gICAgICAgIGlmIChjb2xJbmRleCA9PT0gLTEgfHwgcm93SW5kZXggPT09IC0xKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXJyYXlbcm93SW5kZXhdW2NvbEluZGV4XTtcbiAgICB9O1xuICAgIGNvbnN0IHNldENlbGwgPSAoY29sLCByb3csIG5ld1N0YXR1cywgbmV3VGFrZW5CeSkgPT4ge1xuICAgICAgICBjb25zdCBjb2xJbmRleCA9IGNvbHMuaW5kZXhPZihjb2wpO1xuICAgICAgICBjb25zdCByb3dJbmRleCA9IHJvd3MuaW5kZXhPZihyb3cpO1xuICAgICAgICBpZiAoY29sSW5kZXggPT09IC0xIHx8IHJvd0luZGV4ID09PSAtMSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgYXJyYXlbcm93SW5kZXhdW2NvbEluZGV4XS5zdGF0dXMgPSBuZXdTdGF0dXM7XG4gICAgICAgIGlmIChuZXdUYWtlbkJ5KSB7XG4gICAgICAgICAgICBhcnJheVtyb3dJbmRleF1bY29sSW5kZXhdLnRha2VuQnkgPSBuZXdUYWtlbkJ5O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcnJheVtyb3dJbmRleF1bY29sSW5kZXhdO1xuICAgIH07XG4gICAgY29uc3QgcmVtb3ZlU2hpcCA9IChzaGlwLCBnYW1lYm9hcmQpID0+IHtcbiAgICAgICAgY29uc3QgZ2FtZWJvYXJkQ2VsbHMgPSBnYW1lYm9hcmQuYXJyYXkuZmxhdCgpO1xuICAgICAgICBnYW1lYm9hcmRDZWxscy5mb3JFYWNoKChjZWxsKSA9PiB7XG4gICAgICAgICAgICBpZiAoY2VsbC5zdGF0dXMgPT09ICd0YWtlbicgJiYgY2VsbC50YWtlbkJ5Lm5hbWUgPT09IHNoaXAubmFtZSkge1xuICAgICAgICAgICAgICAgIGNlbGwuc3RhdHVzID0gJ2VtcHR5JztcbiAgICAgICAgICAgICAgICBjZWxsLnRha2VuQnkgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3Qgc2hpcEluZGV4ID0gc2hpcHNQbGFjZWQuaW5kZXhPZihjZWxsKTtcbiAgICAgICAgICAgIGlmIChjZWxsLnRha2VuQnkgPT09IG51bGwgJiYgc2hpcEluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHNoaXBzUGxhY2VkLnNwbGljZShzaGlwSW5kZXgsIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIGNvbnN0IHBsYWNlU2hpcCA9IChzaGlwLCBjb2wsIHJvdywgb3JpZW50YXRpb24pID0+IHtcbiAgICAgICAgY29uc3QgaXNIb3Jpem9udGFsID0gb3JpZW50YXRpb24gPT09ICdob3Jpem9udGFsJztcbiAgICAgICAgY29uc3QgY2VsbHMgPSBpc0hvcml6b250YWwgPyBjb2xzIDogcm93cztcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBjZWxscy5pbmRleE9mKGlzSG9yaXpvbnRhbCA/IGNvbCA6IHJvdyk7XG4gICAgICAgIGlmIChvcmllbnRhdGlvbiA9PT0gJ2hvcml6b250YWwnKSB7XG4gICAgICAgICAgICBzaGlwLmlzVmVydGljYWwgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNoaXAuaXNWZXJ0aWNhbCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHNoaXBDZWxscyA9IFtdO1xuICAgICAgICBpZiAoc3RhcnQgPCAwIHx8IHN0YXJ0ICsgc2hpcC5zaXplID4gY2VsbHMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwLnNpemU7IGkgKz0gMSkge1xuICAgICAgICAgICAgY29uc3QgY3VycmVudENvbCA9IGlzSG9yaXpvbnRhbCA/IGNlbGxzW3N0YXJ0ICsgaV0gOiBjb2w7XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50Um93ID0gaXNIb3Jpem9udGFsID8gcm93IDogY2VsbHNbc3RhcnQgKyBpXTtcbiAgICAgICAgICAgIGlmIChnZXRDZWxsKGN1cnJlbnRDb2wsIGN1cnJlbnRSb3cpLnN0YXR1cyAhPT0gJ2VtcHR5Jykge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNldENlbGwoY3VycmVudENvbCwgY3VycmVudFJvdywgJ3Rha2VuJywgc2hpcCk7XG4gICAgICAgICAgICBzaGlwQ2VsbHMucHVzaChnZXRDZWxsKGN1cnJlbnRDb2wsIGN1cnJlbnRSb3cpKTtcbiAgICAgICAgfVxuICAgICAgICBzaGlwc1BsYWNlZC5wdXNoKHNoaXBDZWxsc1swXSk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgY29uc3QgY2FuQmVQbGFjZWQgPSAoc2l6ZSwgY29sLCByb3csIG9yaWVudGF0aW9uKSA9PiB7XG4gICAgICAgIGNvbnN0IGlzSG9yaXpvbnRhbCA9IG9yaWVudGF0aW9uID09PSAnaG9yaXpvbnRhbCc7XG4gICAgICAgIGNvbnN0IGNlbGxzID0gaXNIb3Jpem9udGFsID8gY29scyA6IHJvd3M7XG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gY2VsbHMuaW5kZXhPZihpc0hvcml6b250YWwgPyBjb2wgOiByb3cpO1xuICAgICAgICBpZiAoc3RhcnQgPCAwIHx8IHN0YXJ0ICsgc2l6ZSA+IGNlbGxzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGFyZUVtcHR5ID0gW107XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2l6ZTsgaSArPSAxKSB7XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50Q29sID0gaXNIb3Jpem9udGFsID8gY2VsbHNbc3RhcnQgKyBpXSA6IGNvbDtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRSb3cgPSBpc0hvcml6b250YWwgPyByb3cgOiBjZWxsc1tzdGFydCArIGldO1xuICAgICAgICAgICAgYXJlRW1wdHkucHVzaChnZXRDZWxsKGN1cnJlbnRDb2wsIGN1cnJlbnRSb3cpLnN0YXR1cyA9PT0gJ2VtcHR5Jyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFyZUVtcHR5LmV2ZXJ5KChpdGVtKSA9PiBpdGVtID09PSB0cnVlKTtcbiAgICB9O1xuICAgIGNvbnN0IHJlY2VpdmVBdHRhY2sgPSAoY29sLCByb3cpID0+IHtcbiAgICAgICAgY29uc3QgY2VsbCA9IGdldENlbGwoY29sLCByb3cpO1xuICAgICAgICBpZiAoY2VsbC5zdGF0dXMgPT09ICd0YWtlbicpIHtcbiAgICAgICAgICAgIGNlbGwudGFrZW5CeS5oaXQoKTtcbiAgICAgICAgICAgIHNldENlbGwoY29sLCByb3csICdoaXQnKTtcbiAgICAgICAgICAgIHJldHVybiBjZWxsLnN0YXR1cztcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2VsbC5zdGF0dXMgPT09ICdlbXB0eScgfHwgY2VsbC5zdGF0dXMgPT09ICdyZXNlcnZlZCcpIHtcbiAgICAgICAgICAgIHNldENlbGwoY29sLCByb3csICdtaXNzJyk7XG4gICAgICAgICAgICByZXR1cm4gY2VsbC5zdGF0dXM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBjb25zdCByZWNlaXZlQXJvdW5kID0gKGNvbCwgcm93KSA9PiB7XG4gICAgICAgIGNvbnN0IGNlbGwgPSBnZXRDZWxsKGNvbCwgcm93KTtcbiAgICAgICAgaWYgKGNlbGwuc3RhdHVzID09PSAnZW1wdHknKSB7XG4gICAgICAgICAgICBzZXRDZWxsKGNvbCwgcm93LCAncmVzZXJ2ZWQnKTtcbiAgICAgICAgICAgIHJldHVybiBjZWxsLnN0YXR1cztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIGNvbnN0IHJlc2VydmVTcGFjZSA9IChnYW1lYm9hcmQsIGNvbCwgcm93KSA9PiB7XG4gICAgICAgIGNvbnN0IGNlbGwgPSBnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIHJvdyk7XG4gICAgICAgIGlmIChjZWxsICYmIGNlbGwudGFrZW5CeSkge1xuICAgICAgICAgICAgY29uc3QgZ2FtZWJvYXJkQ2VsbHMgPSBnYW1lYm9hcmQuYXJyYXkuZmxhdCgpO1xuICAgICAgICAgICAgY29uc3Qgc2hpcENlbGxzID0gZ2FtZWJvYXJkQ2VsbHMuZmlsdGVyKChjKSA9PiBjLnRha2VuQnkgJiYgYy50YWtlbkJ5Lm5hbWUgPT09IGNlbGwudGFrZW5CeS5uYW1lKTtcbiAgICAgICAgICAgIHNoaXBDZWxscy5mb3JFYWNoKChjZWxsKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGlyZWN0aW9ucyA9IFtcbiAgICAgICAgICAgICAgICAgICAgeyBjb2w6IDAsIHJvdzogLTEgfSxcbiAgICAgICAgICAgICAgICAgICAgeyBjb2w6IDAsIHJvdzogMSB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogLTEsIHJvdzogMCB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogMSwgcm93OiAwIH0sXG4gICAgICAgICAgICAgICAgICAgIHsgY29sOiAtMSwgcm93OiAtMSB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogLTEsIHJvdzogMSB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogMSwgcm93OiAtMSB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogMSwgcm93OiAxIH0sXG4gICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb25zLmZvckVhY2goKGRpcmVjdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdDb2wgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNlbGwuY29sLmNoYXJDb2RlQXQoMCkgKyBkaXJlY3Rpb24uY29sKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3Um93ID0gKE51bWJlcihjZWxsLnJvdykgKyBkaXJlY3Rpb24ucm93KS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCBuZXdSb3cpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnYW1lYm9hcmQucmVjZWl2ZUFyb3VuZChuZXdDb2wsIG5ld1Jvdyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBmdW5jdGlvbiByZXNlcnZlU3BhY2VGb3JBbGwoZ2FtZWJvYXJkKSB7XG4gICAgICAgIGdhbWVib2FyZC5zaGlwc1BsYWNlZC5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgICAgICAgICBnYW1lYm9hcmQucmVzZXJ2ZVNwYWNlKGdhbWVib2FyZCwgc2hpcC5jb2wsIHNoaXAucm93KTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHJlbW92ZVJlc2VydmVkU3BhY2UgPSAoZ2FtZWJvYXJkKSA9PiB7XG4gICAgICAgIGNvbnN0IGdhbWVib2FyZENlbGxzID0gZ2FtZWJvYXJkLmFycmF5LmZsYXQoKTtcbiAgICAgICAgZ2FtZWJvYXJkQ2VsbHMuZm9yRWFjaCgoY2VsbCkgPT4ge1xuICAgICAgICAgICAgaWYgKGNlbGwuc3RhdHVzID09PSAncmVzZXJ2ZWQnKSB7XG4gICAgICAgICAgICAgICAgc2V0Q2VsbChjZWxsLmNvbCwgY2VsbC5yb3csICdlbXB0eScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIGNvbnN0IHNpbmtTaGlwID0gKGdhbWVib2FyZCwgY29sLCByb3cpID0+IHtcbiAgICAgICAgY29uc3QgY2VsbCA9IGdhbWVib2FyZC5nZXRDZWxsKGNvbCwgcm93KTtcbiAgICAgICAgaWYgKGNlbGwgJiYgY2VsbC50YWtlbkJ5ICYmIGNlbGwudGFrZW5CeS5pc1N1bmsoKSkge1xuICAgICAgICAgICAgY29uc3Qgc2hpcENlbGxzID0gZ2FtZWJvYXJkLmFycmF5LmZsYXQoKS5maWx0ZXIoKGMpID0+IGMudGFrZW5CeSAmJiBjLnRha2VuQnkubmFtZSA9PT0gY2VsbC50YWtlbkJ5Lm5hbWUpO1xuICAgICAgICAgICAgc2hpcENlbGxzLmZvckVhY2goKGNlbGwpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBkaXJlY3Rpb25zID0gW1xuICAgICAgICAgICAgICAgICAgICB7IGNvbDogMCwgcm93OiAtMSB9LFxuICAgICAgICAgICAgICAgICAgICB7IGNvbDogMCwgcm93OiAxIH0sXG4gICAgICAgICAgICAgICAgICAgIHsgY29sOiAtMSwgcm93OiAwIH0sXG4gICAgICAgICAgICAgICAgICAgIHsgY29sOiAxLCByb3c6IDAgfSxcbiAgICAgICAgICAgICAgICAgICAgeyBjb2w6IC0xLCByb3c6IC0xIH0sXG4gICAgICAgICAgICAgICAgICAgIHsgY29sOiAtMSwgcm93OiAxIH0sXG4gICAgICAgICAgICAgICAgICAgIHsgY29sOiAxLCByb3c6IC0xIH0sXG4gICAgICAgICAgICAgICAgICAgIHsgY29sOiAxLCByb3c6IDEgfSxcbiAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgIGRpcmVjdGlvbnMuZm9yRWFjaCgoZGlyZWN0aW9uKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0NvbCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoY2VsbC5jb2wuY2hhckNvZGVBdCgwKSArIGRpcmVjdGlvbi5jb2wpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdSb3cgPSAoTnVtYmVyKGNlbGwucm93KSArIGRpcmVjdGlvbi5yb3cpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChnYW1lYm9hcmQuZ2V0Q2VsbChuZXdDb2wsIG5ld1JvdykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVib2FyZC5yZWNlaXZlQXR0YWNrKG5ld0NvbCwgbmV3Um93KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IGhpdEJ1dE5vdFN1bmsgPSAoZ2FtZWJvYXJkKSA9PiB7XG4gICAgICAgIGNvbnN0IGdhbWVib2FyZENlbGxzID0gZ2FtZWJvYXJkLmFycmF5LmZsYXQoKTtcbiAgICAgICAgcmV0dXJuIGdhbWVib2FyZENlbGxzLnNvbWUoKGNlbGwpID0+IHtcbiAgICAgICAgICAgIGlmIChjZWxsLnN0YXR1cyA9PT0gJ2hpdCcgJiYgY2VsbC50YWtlbkJ5LmlzU3VuaygpID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIGNvbnN0IGFsbFN1bmsgPSAoZ2FtZWJvYXJkKSA9PiB7XG4gICAgICAgIGNvbnN0IGdhbWVib2FyZENlbGxzID0gZ2FtZWJvYXJkLmFycmF5LmZsYXQoKTtcbiAgICAgICAgbGV0IHRha2VuQnlDZWxscyA9IGdhbWVib2FyZENlbGxzLmZpbHRlcigoY2VsbCkgPT4gY2VsbC50YWtlbkJ5KTtcbiAgICAgICAgaWYgKHRha2VuQnlDZWxscy5sZW5ndGggPiAwICYmIHRha2VuQnlDZWxscy5ldmVyeSgoY2VsbCkgPT4gY2VsbC50YWtlbkJ5LmlzU3VuaygpKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiB7XG4gICAgICAgIGdlbmVyYXRlQXJyYXksXG4gICAgICAgIGNsZWFyQm9hcmQsXG4gICAgICAgIGdldENlbGwsXG4gICAgICAgIHNldENlbGwsXG4gICAgICAgIHJlbW92ZVNoaXAsXG4gICAgICAgIHBsYWNlU2hpcCxcbiAgICAgICAgcmVjZWl2ZUF0dGFjayxcbiAgICAgICAgcmVjZWl2ZUFyb3VuZCxcbiAgICAgICAgcmVzZXJ2ZVNwYWNlLFxuICAgICAgICByZXNlcnZlU3BhY2VGb3JBbGwsXG4gICAgICAgIGhpdEJ1dE5vdFN1bmssXG4gICAgICAgIHNpbmtTaGlwLFxuICAgICAgICBhbGxTdW5rLFxuICAgICAgICBhcnJheSxcbiAgICAgICAgY2FuQmVQbGFjZWQsXG4gICAgICAgIHNoaXBzUGxhY2VkLFxuICAgICAgICByZW1vdmVSZXNlcnZlZFNwYWNlLFxuICAgIH07XG59O1xuZXhwb3J0IGRlZmF1bHQgZ2FtZWJvYXJkRmFjdG9yeTtcbiIsImNvbnN0IHNoaXBGYWN0b3J5ID0gKG5hbWUpID0+IHtcbiAgICBsZXQgc2l6ZTtcbiAgICBpZiAobmFtZSA9PT0gJ0NhcnJpZXInKSB7XG4gICAgICAgIHNpemUgPSA1O1xuICAgIH1cbiAgICBpZiAobmFtZSA9PT0gJ0JhdHRsZXNoaXAnKSB7XG4gICAgICAgIHNpemUgPSA0O1xuICAgIH1cbiAgICBpZiAobmFtZSA9PT0gJ0Rlc3Ryb3llcicpIHtcbiAgICAgICAgc2l6ZSA9IDM7XG4gICAgfVxuICAgIGlmIChuYW1lID09PSAnU3VibWFyaW5lJykge1xuICAgICAgICBzaXplID0gMztcbiAgICB9XG4gICAgaWYgKG5hbWUgPT09ICdQYXRyb2xCb2F0Jykge1xuICAgICAgICBzaXplID0gMjtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgc2l6ZSxcbiAgICAgICAgaGl0Q291bnQ6IDAsXG4gICAgICAgIGlzVmVydGljYWw6IGZhbHNlLFxuICAgICAgICByb3RhdGUoKSB7XG4gICAgICAgICAgICB0aGlzLmlzVmVydGljYWwgPSAhdGhpcy5pc1ZlcnRpY2FsO1xuICAgICAgICB9LFxuICAgICAgICBoaXQoKSB7XG4gICAgICAgICAgICB0aGlzLmhpdENvdW50ICs9IDE7XG4gICAgICAgIH0sXG4gICAgICAgIGlzU3VuaygpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmhpdENvdW50ID09PSBzaXplO1xuICAgICAgICB9LFxuICAgIH07XG59O1xuZXhwb3J0IGRlZmF1bHQgc2hpcEZhY3Rvcnk7XG4iLCJjb25zdCBwbGF5ZXJGYWN0b3J5ID0gKCkgPT4ge1xuICAgIGNvbnN0IGNvbHMgPSBbJ0EnLCAnQicsICdDJywgJ0QnLCAnRScsICdGJywgJ0cnLCAnSCcsICdJJywgJ0onXTtcbiAgICBsZXQgcHJldkhpdCA9IG51bGw7XG4gICAgbGV0IGxhc3RIaXQgPSBudWxsO1xuICAgIGxldCByYW5nZSA9IDE7XG4gICAgbGV0IGdvUmlnaHQgPSB0cnVlO1xuICAgIGxldCBnb0Rvd24gPSB0cnVlO1xuICAgIGNvbnN0IGF0dGFjayA9IChnYW1lYm9hcmQsIGNvbCwgcm93KSA9PiB7XG4gICAgICAgIGlmIChnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIHJvdykuc3RhdHVzICE9PSAnaGl0JyAmJiBnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIHJvdykuc3RhdHVzICE9PSAnbWlzcycpIHtcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSBnYW1lYm9hcmQucmVjZWl2ZUF0dGFjayhjb2wsIHJvdyk7XG4gICAgICAgICAgICBpZiAocmVzdWx0ID09PSAnaGl0Jykge1xuICAgICAgICAgICAgICAgIHNldFByZXZIaXQobGFzdEhpdCk7XG4gICAgICAgICAgICAgICAgc2V0TGFzdEhpdCh7IGNvbDogY29sLCByb3c6IHJvdyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICdhbHJlYWR5IHNob3QnO1xuICAgIH07XG4gICAgY29uc3QgcmFuZG9tQXR0YWNrID0gKGdhbWVib2FyZCkgPT4ge1xuICAgICAgICBsZXQgcmFuZG9tQ29sO1xuICAgICAgICBsZXQgcmFuZG9tUm93O1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICByYW5kb21Db2wgPSBjb2xzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNvbHMubGVuZ3RoKV07XG4gICAgICAgICAgICByYW5kb21Sb3cgPSBNYXRoLmNlaWwoTWF0aC5yYW5kb20oKSAqIDEwKS50b1N0cmluZygpO1xuICAgICAgICB9IHdoaWxlIChnYW1lYm9hcmQuZ2V0Q2VsbChyYW5kb21Db2wsIHJhbmRvbVJvdykuc3RhdHVzID09PSAnaGl0JyB8fCBnYW1lYm9hcmQuZ2V0Q2VsbChyYW5kb21Db2wsIHJhbmRvbVJvdykuc3RhdHVzID09PSAnbWlzcycpO1xuICAgICAgICBpZiAoZ2FtZWJvYXJkLmdldENlbGwocmFuZG9tQ29sLCByYW5kb21Sb3cpLnN0YXR1cyAhPT0gJ2hpdCcgJiYgZ2FtZWJvYXJkLmdldENlbGwocmFuZG9tQ29sLCByYW5kb21Sb3cpLnN0YXR1cyAhPT0gJ21pc3MnKSB7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBnYW1lYm9hcmQucmVjZWl2ZUF0dGFjayhyYW5kb21Db2wsIHJhbmRvbVJvdyk7XG4gICAgICAgICAgICBpZiAoZ2FtZWJvYXJkLmdldENlbGwocmFuZG9tQ29sLCByYW5kb21Sb3cpLnN0YXR1cyA9PT0gJ2hpdCcpIHtcbiAgICAgICAgICAgICAgICBzZXRQcmV2SGl0KGxhc3RIaXQpO1xuICAgICAgICAgICAgICAgIHNldExhc3RIaXQoeyBjb2w6IHJhbmRvbUNvbCwgcm93OiByYW5kb21Sb3cgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4geyByZXN1bHQsIGNvbDogcmFuZG9tQ29sLCByb3c6IHJhbmRvbVJvdyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHJlc3VsdDogJ2FscmVhZHkgc2hvdCcsIGNvbDogcmFuZG9tQ29sLCByb3c6IHJhbmRvbVJvdyB9O1xuICAgIH07XG4gICAgY29uc3QgZm9sbG93dXBBdHRhY2sgPSAoZ2FtZWJvYXJkLCBjb2wsIHJvdykgPT4ge1xuICAgICAgICBjb25zdCBkaXJlY3Rpb25zID0gW1xuICAgICAgICAgICAgeyBjb2w6IDAsIHJvdzogLTEgfSxcbiAgICAgICAgICAgIHsgY29sOiAwLCByb3c6IDEgfSxcbiAgICAgICAgICAgIHsgY29sOiAtMSwgcm93OiAwIH0sXG4gICAgICAgICAgICB7IGNvbDogMSwgcm93OiAwIH0sXG4gICAgICAgIF07XG4gICAgICAgIGNvbnN0IHZhbGlkRGlyZWN0aW9ucyA9IGRpcmVjdGlvbnMuZmlsdGVyKChkaXJlY3Rpb24pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5ld0NvbCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoY29sLmNoYXJDb2RlQXQoMCkgKyBkaXJlY3Rpb24uY29sKTtcbiAgICAgICAgICAgIGNvbnN0IG5ld1JvdyA9IChOdW1iZXIocm93KSArIGRpcmVjdGlvbi5yb3cpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICBjb25zdCBjZWxsID0gZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCBuZXdSb3cpO1xuICAgICAgICAgICAgaWYgKGNlbGwgJiYgY2VsbC5zdGF0dXMgIT09ICdtaXNzJyAmJiBjZWxsLnN0YXR1cyAhPT0gJ2hpdCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh2YWxpZERpcmVjdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3QgcmFuZG9tRGlyZWN0aW9uID0gdmFsaWREaXJlY3Rpb25zW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHZhbGlkRGlyZWN0aW9ucy5sZW5ndGgpXTtcbiAgICAgICAgICAgIGNvbnN0IG5ld0NvbCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoY29sLmNoYXJDb2RlQXQoMCkgKyByYW5kb21EaXJlY3Rpb24uY29sKTtcbiAgICAgICAgICAgIGNvbnN0IG5ld1JvdyA9IChOdW1iZXIocm93KSArIHJhbmRvbURpcmVjdGlvbi5yb3cpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICBnYW1lYm9hcmQucmVjZWl2ZUF0dGFjayhuZXdDb2wsIG5ld1Jvdyk7XG4gICAgICAgICAgICByYW5nZSA9IDE7XG4gICAgICAgICAgICBpZiAoZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCBuZXdSb3cpLnN0YXR1cyA9PT0gJ2hpdCcpIHtcbiAgICAgICAgICAgICAgICBzZXRQcmV2SGl0KGxhc3RIaXQpO1xuICAgICAgICAgICAgICAgIHNldExhc3RIaXQoeyBjb2w6IG5ld0NvbCwgcm93OiBuZXdSb3cgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IGZpbmlzaGluZ0F0dGFjayA9IChnYW1lYm9hcmQsIGNvbCwgcm93LCBwcmV2SGl0KSA9PiB7XG4gICAgICAgIGlmIChwcmV2SGl0LnJvdyA9PT0gcm93KSB7XG4gICAgICAgICAgICBpZiAoZ29SaWdodCkge1xuICAgICAgICAgICAgICAgIHJhbmdlID0gMTtcbiAgICAgICAgICAgICAgICBsZXQgbmV3Q29sID0gU3RyaW5nLmZyb21DaGFyQ29kZShjb2wuY2hhckNvZGVBdCgwKSArIHJhbmdlKTtcbiAgICAgICAgICAgICAgICB3aGlsZSAoZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCByb3cpICYmIGdhbWVib2FyZC5nZXRDZWxsKG5ld0NvbCwgcm93KS5zdGF0dXMgPT09ICdoaXQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NvbCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoY29sLmNoYXJDb2RlQXQoMCkgKyByYW5nZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChnYW1lYm9hcmQuZ2V0Q2VsbChuZXdDb2wsIHJvdykgJiYgZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCByb3cpLnN0YXR1cyAhPT0gJ2hpdCcgJiYgZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCByb3cpLnN0YXR1cyAhPT0gJ21pc3MnKSB7XG4gICAgICAgICAgICAgICAgICAgIGdhbWVib2FyZC5yZWNlaXZlQXR0YWNrKG5ld0NvbCwgcm93KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdhbWVib2FyZC5nZXRDZWxsKG5ld0NvbCwgcm93KS5zdGF0dXMgPT09ICdoaXQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRQcmV2SGl0KGxhc3RIaXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0TGFzdEhpdCh7IGNvbDogbmV3Q29sLCByb3c6IHJvdyB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByYW5nZSArPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2UgPSAxO1xuICAgICAgICAgICAgICAgICAgICBnb1JpZ2h0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGZpbmlzaGluZ0F0dGFjayhnYW1lYm9hcmQsIG5ld0NvbCwgcm93LCBwcmV2SGl0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByYW5nZSA9IDE7XG4gICAgICAgICAgICAgICAgbGV0IG5ld0NvbCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoY29sLmNoYXJDb2RlQXQoMCkgLSByYW5nZSk7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGdhbWVib2FyZC5nZXRDZWxsKG5ld0NvbCwgcm93KSAmJiBnYW1lYm9hcmQuZ2V0Q2VsbChuZXdDb2wsIHJvdykuc3RhdHVzID09PSAnaGl0Jykge1xuICAgICAgICAgICAgICAgICAgICByYW5nZSArPSAxO1xuICAgICAgICAgICAgICAgICAgICBuZXdDb2wgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNvbC5jaGFyQ29kZUF0KDApIC0gcmFuZ2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZ2FtZWJvYXJkLmdldENlbGwobmV3Q29sLCByb3cpICYmIGdhbWVib2FyZC5nZXRDZWxsKG5ld0NvbCwgcm93KS5zdGF0dXMgIT09ICdoaXQnICYmIGdhbWVib2FyZC5nZXRDZWxsKG5ld0NvbCwgcm93KS5zdGF0dXMgIT09ICdtaXNzJykge1xuICAgICAgICAgICAgICAgICAgICBnYW1lYm9hcmQucmVjZWl2ZUF0dGFjayhuZXdDb2wsIHJvdyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChnYW1lYm9hcmQuZ2V0Q2VsbChuZXdDb2wsIHJvdykuc3RhdHVzID09PSAnaGl0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0UHJldkhpdChsYXN0SGl0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldExhc3RIaXQoeyBjb2w6IG5ld0NvbCwgcm93OiByb3cgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmFuZ2UgKz0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlID0gMTtcbiAgICAgICAgICAgICAgICAgICAgZ29SaWdodCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGZpbmlzaGluZ0F0dGFjayhnYW1lYm9hcmQsIG5ld0NvbCwgcm93LCBwcmV2SGl0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocHJldkhpdC5jb2wgPT09IGNvbCkge1xuICAgICAgICAgICAgaWYgKGdvRG93bikge1xuICAgICAgICAgICAgICAgIHJhbmdlID0gMTtcbiAgICAgICAgICAgICAgICBsZXQgbmV3Um93ID0gKE51bWJlcihyb3cpICsgcmFuZ2UpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGdhbWVib2FyZC5nZXRDZWxsKGNvbCwgbmV3Um93KSAmJiBnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIG5ld1Jvdykuc3RhdHVzID09PSAnaGl0Jykge1xuICAgICAgICAgICAgICAgICAgICByYW5nZSArPSAxO1xuICAgICAgICAgICAgICAgICAgICBuZXdSb3cgPSAoTnVtYmVyKHJvdykgKyByYW5nZSkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGdhbWVib2FyZC5nZXRDZWxsKGNvbCwgbmV3Um93KSAmJiBnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIG5ld1Jvdykuc3RhdHVzICE9PSAnaGl0JyAmJiBnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIG5ld1Jvdykuc3RhdHVzICE9PSAnbWlzcycpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2FtZWJvYXJkLnJlY2VpdmVBdHRhY2soY29sLCBuZXdSb3cpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ2FtZWJvYXJkLmdldENlbGwoY29sLCBuZXdSb3cpLnN0YXR1cyA9PT0gJ2hpdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFByZXZIaXQobGFzdEhpdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRMYXN0SGl0KHsgY29sOiBjb2wsIHJvdzogbmV3Um93IH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlICs9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByYW5nZSA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGdvRG93biA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBmaW5pc2hpbmdBdHRhY2soZ2FtZWJvYXJkLCBjb2wsIG5ld1JvdywgcHJldkhpdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmFuZ2UgPSAxO1xuICAgICAgICAgICAgICAgIGxldCBuZXdSb3cgPSAoTnVtYmVyKHJvdykgLSByYW5nZSkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB3aGlsZSAoZ2FtZWJvYXJkLmdldENlbGwoY29sLCBuZXdSb3cpICYmIGdhbWVib2FyZC5nZXRDZWxsKGNvbCwgbmV3Um93KS5zdGF0dXMgPT09ICdoaXQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIG5ld1JvdyA9IChOdW1iZXIocm93KSAtIHJhbmdlKS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZ2FtZWJvYXJkLmdldENlbGwoY29sLCBuZXdSb3cpICYmIGdhbWVib2FyZC5nZXRDZWxsKGNvbCwgbmV3Um93KS5zdGF0dXMgIT09ICdoaXQnICYmIGdhbWVib2FyZC5nZXRDZWxsKGNvbCwgbmV3Um93KS5zdGF0dXMgIT09ICdtaXNzJykge1xuICAgICAgICAgICAgICAgICAgICBnYW1lYm9hcmQucmVjZWl2ZUF0dGFjayhjb2wsIG5ld1Jvdyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIG5ld1Jvdykuc3RhdHVzID09PSAnaGl0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0UHJldkhpdChsYXN0SGl0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldExhc3RIaXQoeyBjb2w6IGNvbCwgcm93OiBuZXdSb3cgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmFuZ2UgKz0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlID0gMTtcbiAgICAgICAgICAgICAgICAgICAgZ29Eb3duID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgZmluaXNoaW5nQXR0YWNrKGdhbWVib2FyZCwgY29sLCBuZXdSb3csIHByZXZIaXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3QgZ2V0UHJldkhpdCA9ICgpID0+IHtcbiAgICAgICAgcmV0dXJuIHByZXZIaXQ7XG4gICAgfTtcbiAgICBjb25zdCBnZXRMYXN0SGl0ID0gKCkgPT4ge1xuICAgICAgICByZXR1cm4gbGFzdEhpdDtcbiAgICB9O1xuICAgIGNvbnN0IHNldFByZXZIaXQgPSAobmV3UHJldkhpdCkgPT4ge1xuICAgICAgICBwcmV2SGl0ID0gbmV3UHJldkhpdDtcbiAgICB9O1xuICAgIGNvbnN0IHNldExhc3RIaXQgPSAobmV3TGFzdEhpdCkgPT4ge1xuICAgICAgICBsYXN0SGl0ID0gbmV3TGFzdEhpdDtcbiAgICB9O1xuICAgIHJldHVybiB7IGF0dGFjaywgcmFuZG9tQXR0YWNrLCBmb2xsb3d1cEF0dGFjaywgZmluaXNoaW5nQXR0YWNrLCBwcmV2SGl0LCBsYXN0SGl0LCBnZXRQcmV2SGl0LCBnZXRMYXN0SGl0LCBzZXRQcmV2SGl0LCBzZXRMYXN0SGl0IH07XG59O1xuZXhwb3J0IGRlZmF1bHQgcGxheWVyRmFjdG9yeTtcbiIsInZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuaW1wb3J0IHVpIGZyb20gJy4vdWknO1xuaW1wb3J0IGNvbnRyb2xsZXIgZnJvbSAnLi9jb250cm9sbGVyJztcbmNvbnN0IGRyYWdBbmREcm9wID0gKGZpcnN0R2FtZWJvYXJkLCBzZWNvbmRHYW1lYm9hcmQsIHNoaXBzKSA9PiB7XG4gICAgY29uc3QgZmlyc3RCb2FyZEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZmlyc3RCb2FyZCcpO1xuICAgIGNvbnN0IHNlY29uZEJvYXJkRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzZWNvbmRCb2FyZCcpO1xuICAgIGNvbnN0IGZpcnN0Qm9hcmRDZWxscyA9IGZpcnN0Qm9hcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jZWxsJyk7XG4gICAgY29uc3Qgc2Vjb25kQm9hcmRDZWxscyA9IHNlY29uZEJvYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2VsbCcpO1xuICAgIGxldCBzaGlwTmFtZTtcbiAgICBsZXQgc2hpcFNpemU7XG4gICAgbGV0IGdyYWJQb2ludFggPSAwO1xuICAgIGxldCBncmFiUG9pbnRZID0gMDtcbiAgICBsZXQgc2hpcE9iajtcbiAgICBsZXQgb3JpZW50YXRpb247XG4gICAgbGV0IGhpZ2hsaWdodGVkQ2VsbHMgPSBbXTtcbiAgICBjb25zdCBzaGlwTmFtZVRvT2JqID0ge1xuICAgICAgICBjYXJyaWVyOiBzaGlwc1swXSxcbiAgICAgICAgYmF0dGxlc2hpcDogc2hpcHNbMV0sXG4gICAgICAgIGRlc3Ryb3llcjogc2hpcHNbMl0sXG4gICAgICAgIHN1Ym1hcmluZTogc2hpcHNbM10sXG4gICAgICAgIHBhdHJvbGJvYXQ6IHNoaXBzWzRdLFxuICAgIH07XG4gICAgbGV0IGxhc3REcmFnZ2VkID0gbnVsbDtcbiAgICBjb25zdCBkcmFnZ2FibGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmRyYWdnYWJsZScpO1xuICAgIGZ1bmN0aW9uIGdldE5vblNoaXBDZWxscyhib2FyZENlbGxzKSB7XG4gICAgICAgIGNvbnN0IGJvYXJkQ2VsbHNBcnJheSA9IEFycmF5LmZyb20oYm9hcmRDZWxscyk7XG4gICAgICAgIHJldHVybiBib2FyZENlbGxzQXJyYXkuZmlsdGVyKChjZWxsKSA9PiAhY2VsbC5jbGFzc0xpc3QuY29udGFpbnMoJ3Rha2VuJykpO1xuICAgIH1cbiAgICBjb25zdCBub25TaGlwQ2VsbHMgPSBbLi4uZ2V0Tm9uU2hpcENlbGxzKGZpcnN0Qm9hcmRDZWxscyksIC4uLmdldE5vblNoaXBDZWxscyhzZWNvbmRCb2FyZENlbGxzKV07XG4gICAgZnVuY3Rpb24gaXNWYWxpZFBsYWNlbWVudCh0b0hpZ2hsaWdodCkge1xuICAgICAgICByZXR1cm4gKHRvSGlnaGxpZ2h0LmV2ZXJ5KChjZWxsKSA9PiBjZWxsLmNsYXNzTGlzdC5jb250YWlucygnZW1wdHknKSkgJiZcbiAgICAgICAgICAgICh0b0hpZ2hsaWdodC5ldmVyeSgoY2VsbCkgPT4gY2VsbC5kYXRhc2V0LmNvbCA9PT0gdG9IaWdobGlnaHRbMF0uZGF0YXNldC5jb2wpIHx8XG4gICAgICAgICAgICAgICAgdG9IaWdobGlnaHQuZXZlcnkoKGNlbGwpID0+IGNlbGwuZGF0YXNldC5yb3cgPT09IHRvSGlnaGxpZ2h0WzBdLmRhdGFzZXQucm93KSkgJiZcbiAgICAgICAgICAgIHRvSGlnaGxpZ2h0Lmxlbmd0aCA9PT0gc2hpcFNpemUgJiZcbiAgICAgICAgICAgIHRvSGlnaGxpZ2h0LmV2ZXJ5KChjZWxsKSA9PiBjZWxsLmRhdGFzZXQuY29sID49ICdBJyAmJiBjZWxsLmRhdGFzZXQuY29sIDw9ICdKJykgJiZcbiAgICAgICAgICAgIHRvSGlnaGxpZ2h0LmV2ZXJ5KChjZWxsKSA9PiBOdW1iZXIoY2VsbC5kYXRhc2V0LnJvdykgPj0gMSAmJiBOdW1iZXIoY2VsbC5kYXRhc2V0LnJvdykgPD0gMTApKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZ2V0TGFzdFNoaXBTaXplRWxlbWVudHMoaGlnaGxpZ2h0ZWRDZWxscywgc2hpcFNpemUpIHtcbiAgICAgICAgcmV0dXJuIGhpZ2hsaWdodGVkQ2VsbHMuc2xpY2UoTWF0aC5taW4oaGlnaGxpZ2h0ZWRDZWxscy5sZW5ndGggLSBzaGlwU2l6ZSwgMCkpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBnZXRHYW1lYm9hcmQoZSkge1xuICAgICAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICAgICAgbGV0IGdhbWVib2FyZDtcbiAgICAgICAgY29uc3QgYm9hcmRJZCA9IHRhcmdldC5jbG9zZXN0KCcuYm9hcmQnKS5pZDtcbiAgICAgICAgaWYgKGJvYXJkSWQgPT09ICdmaXJzdEJvYXJkJykge1xuICAgICAgICAgICAgZ2FtZWJvYXJkID0gZmlyc3RHYW1lYm9hcmQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGJvYXJkSWQgPT09ICdzZWNvbmRCb2FyZCcpIHtcbiAgICAgICAgICAgIGdhbWVib2FyZCA9IHNlY29uZEdhbWVib2FyZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyB0YXJnZXQsIGdhbWVib2FyZCB9O1xuICAgIH1cbiAgICBmdW5jdGlvbiByZXNlcnZlU3BhY2VGb3JSZW1haW5pbmdTaGlwcyhnYW1lYm9hcmQsIGUpIHtcbiAgICAgICAgY29uc3QgeyB0YXJnZXQgfSA9IGdldEdhbWVib2FyZChlKTtcbiAgICAgICAgY29uc3QgdGFyZ2V0U2hpcE5hbWUgPSB0YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLW5hbWUnKTtcbiAgICAgICAgbGV0IHJlbWFpbmluZ1NoaXBzID0gZ2FtZWJvYXJkLnNoaXBzUGxhY2VkLmZpbHRlcigoc2hpcCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHRhcmdldFNoaXBOYW1lICE9PSBzaGlwLnRha2VuQnkubmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmVtYWluaW5nU2hpcHMuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgICAgICAgICAgZ2FtZWJvYXJkLnJlc2VydmVTcGFjZShnYW1lYm9hcmQsIHNoaXAuY29sLCBzaGlwLnJvdyk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiBzZXRTaGlwQXR0cmlidXRlcyhlLCB0YXJnZXQpIHtcbiAgICAgICAgc2hpcE5hbWUgPSB0YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLW5hbWUnKTtcbiAgICAgICAgc2hpcFNpemUgPSBOdW1iZXIodGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1zaXplJykpO1xuICAgICAgICBncmFiUG9pbnRYID0gZS5vZmZzZXRYO1xuICAgICAgICBncmFiUG9pbnRZID0gZS5vZmZzZXRZO1xuICAgICAgICBzaGlwT2JqID0gc2hpcE5hbWVUb09ialtzaGlwTmFtZV07XG4gICAgICAgIG9yaWVudGF0aW9uID0gc2hpcE9iai5pc1ZlcnRpY2FsID8gJ3ZlcnRpY2FsJyA6ICdob3Jpem9udGFsJztcbiAgICAgICAgcmV0dXJuIHsgc2hpcE5hbWUsIHNoaXBPYmogfTtcbiAgICB9XG4gICAgZnVuY3Rpb24gcHJldmVudE9mZkJvYXJkUGxhY2VtZW50KHRhcmdldCwgZSkge1xuICAgICAgICBpZiAoaGlnaGxpZ2h0ZWRDZWxscy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGJvYXJkID0gdGFyZ2V0LmNsb3Nlc3QoJy5ib2FyZCcpO1xuICAgICAgICAgICAgaWYgKGJvYXJkKSB7XG4gICAgICAgICAgICAgICAgbGV0IHsgZ2FtZWJvYXJkIH0gPSBnZXRHYW1lYm9hcmQoZSk7XG4gICAgICAgICAgICAgICAgaWYgKGJvYXJkLmlkID09PSAnZmlyc3RCb2FyZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2FtZWJvYXJkID0gZmlyc3RHYW1lYm9hcmQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGJvYXJkLmlkID09PSAnc2Vjb25kQm9hcmQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGdhbWVib2FyZCA9IHNlY29uZEdhbWVib2FyZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGdhbWVib2FyZCAmJiBsYXN0RHJhZ2dlZCAmJiBnYW1lYm9hcmQuY2FuQmVQbGFjZWQoc2hpcE9iai5zaXplLCBsYXN0RHJhZ2dlZFswXS5kYXRhc2V0LmNvbCwgbGFzdERyYWdnZWRbMF0uZGF0YXNldC5yb3csIG9yaWVudGF0aW9uKSkge1xuICAgICAgICAgICAgICAgICAgICBnYW1lYm9hcmQucGxhY2VTaGlwKHNoaXBPYmosIGxhc3REcmFnZ2VkWzBdLmRhdGFzZXQuY29sLCBsYXN0RHJhZ2dlZFswXS5kYXRhc2V0LnJvdywgb3JpZW50YXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBnYW1lYm9hcmQucmVzZXJ2ZVNwYWNlKGdhbWVib2FyZCwgbGFzdERyYWdnZWRbMF0uZGF0YXNldC5jb2wsIGxhc3REcmFnZ2VkWzBdLmRhdGFzZXQucm93KTtcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5yZW5ldygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBnZXRTdGFydENlbGwoaW5kZXgsIHNoaXBPYmosIGUpIHtcbiAgICAgICAgY29uc3QgeyB0YXJnZXQgfSA9IGdldEdhbWVib2FyZChlKTtcbiAgICAgICAgcmV0dXJuIGluZGV4IC0gKHNoaXBPYmouaXNWZXJ0aWNhbCA/IE1hdGguZmxvb3IoZ3JhYlBvaW50WSAvIHRhcmdldC5vZmZzZXRIZWlnaHQpICogMTAgOiBNYXRoLmZsb29yKGdyYWJQb2ludFggLyB0YXJnZXQub2Zmc2V0V2lkdGgpKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZ2V0Qm9hcmRDZWxscyhib2FyZElkKSB7XG4gICAgICAgIHJldHVybiBib2FyZElkID09PSAnZmlyc3RCb2FyZCcgPyBmaXJzdEJvYXJkQ2VsbHMgOiBzZWNvbmRCb2FyZENlbGxzO1xuICAgIH1cbiAgICBmdW5jdGlvbiBoaWdobGlnaHRDZWxscyh0b0hpZ2hsaWdodCkge1xuICAgICAgICB0b0hpZ2hsaWdodC5mb3JFYWNoKChjZWxsKSA9PiB7XG4gICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoJ2hpZ2hsaWdodCcpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaGlnaGxpZ2h0Q2VsbHNPbkJvYXJkKHNoaXBPYmosIHN0YXJ0Q2VsbCwgYm9hcmRDZWxscywgdG9IaWdobGlnaHQpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwU2l6ZTsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgY2VsbEluZGV4ID0gc2hpcE9iai5pc1ZlcnRpY2FsID8gc3RhcnRDZWxsICsgaSAqIDEwIDogc3RhcnRDZWxsICsgaTtcbiAgICAgICAgICAgIGlmIChib2FyZENlbGxzW2NlbGxJbmRleF0pIHtcbiAgICAgICAgICAgICAgICB0b0hpZ2hsaWdodC5wdXNoKGJvYXJkQ2VsbHNbY2VsbEluZGV4XSk7XG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0ZWRDZWxscy5wdXNoKGJvYXJkQ2VsbHNbY2VsbEluZGV4XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gcmVtb3ZlSGlnaGxpZ2h0KCkge1xuICAgICAgICBoaWdobGlnaHRlZENlbGxzLmZvckVhY2goKGhpZ2hsaWdodGVkQ2VsbCkgPT4gaGlnaGxpZ2h0ZWRDZWxsLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZ2hsaWdodCcpKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaXNCb2FyZFZhbGlkKGJvYXJkSWQpIHtcbiAgICAgICAgcmV0dXJuIGJvYXJkSWQgPT09ICdmaXJzdEJvYXJkJyB8fCBib2FyZElkID09PSAnc2Vjb25kQm9hcmQnO1xuICAgIH1cbiAgICBmdW5jdGlvbiBwbGFjZVNoaXBPbkJvYXJkKGdhbWVib2FyZCwgc2hpcE9iaiwgbGFzdCwgb3JpZW50YXRpb24pIHtcbiAgICAgICAgaWYgKGdhbWVib2FyZC5jYW5CZVBsYWNlZChzaGlwT2JqLnNpemUsIGxhc3RbMF0uZGF0YXNldC5jb2wsIGxhc3RbMF0uZGF0YXNldC5yb3csIG9yaWVudGF0aW9uKSkge1xuICAgICAgICAgICAgZ2FtZWJvYXJkLnBsYWNlU2hpcChzaGlwT2JqLCBsYXN0WzBdLmRhdGFzZXQuY29sLCBsYXN0WzBdLmRhdGFzZXQucm93LCBvcmllbnRhdGlvbik7XG4gICAgICAgICAgICBnYW1lYm9hcmQucmVzZXJ2ZVNwYWNlKGdhbWVib2FyZCwgbGFzdFswXS5kYXRhc2V0LmNvbCwgbGFzdFswXS5kYXRhc2V0LnJvdyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBnYW1lYm9hcmQucGxhY2VTaGlwKHNoaXBPYmosIGxhc3REcmFnZ2VkWzBdLmRhdGFzZXQuY29sLCBsYXN0RHJhZ2dlZFswXS5kYXRhc2V0LnJvdywgb3JpZW50YXRpb24pO1xuICAgICAgICAgICAgZ2FtZWJvYXJkLnJlc2VydmVTcGFjZShnYW1lYm9hcmQsIGxhc3REcmFnZ2VkWzBdLmRhdGFzZXQuY29sLCBsYXN0RHJhZ2dlZFswXS5kYXRhc2V0LnJvdyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gaGFuZGxlTW91c2Vkb3duKGUpIHtcbiAgICAgICAgY29uc3QgeyBnYW1lYm9hcmQgfSA9IGdldEdhbWVib2FyZChlKTtcbiAgICAgICAgZ2FtZWJvYXJkLnJlbW92ZVJlc2VydmVkU3BhY2UoZ2FtZWJvYXJkKTtcbiAgICAgICAgcmVzZXJ2ZVNwYWNlRm9yUmVtYWluaW5nU2hpcHMoZ2FtZWJvYXJkLCBlKTtcbiAgICAgICAgY29udHJvbGxlci5yZW5ldygpO1xuICAgICAgICB1aS5zZXRJbml0TWVzc2FnZSgpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBoYW5kbGVEcmFnU3RhcnQoZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgeWllbGQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMCkpO1xuICAgICAgICAgICAgY29uc3QgeyB0YXJnZXQsIGdhbWVib2FyZCB9ID0gZ2V0R2FtZWJvYXJkKGUpO1xuICAgICAgICAgICAgdGFyZ2V0LnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJztcbiAgICAgICAgICAgIHNldFNoaXBBdHRyaWJ1dGVzKGUsIHRhcmdldCk7XG4gICAgICAgICAgICBnYW1lYm9hcmQucmVtb3ZlU2hpcChzaGlwT2JqLCBnYW1lYm9hcmQpO1xuICAgICAgICAgICAgdWkuY2xlYXJTaGlwKHNoaXBPYmosIGdhbWVib2FyZCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiBoYW5kbGVEcmFnT3ZlcihpbmRleCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgdGFyZ2V0IH0gPSBnZXRHYW1lYm9hcmQoZSk7XG4gICAgICAgICAgICBjb25zdCBib2FyZElkID0gdGFyZ2V0LmNsb3Nlc3QoJy5ib2FyZCcpLmlkO1xuICAgICAgICAgICAgaWYgKGlzQm9hcmRWYWxpZChib2FyZElkKSkge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICBpZiAoc2hpcE9iaikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydENlbGwgPSBnZXRTdGFydENlbGwoaW5kZXgsIHNoaXBPYmosIGUpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBib2FyZENlbGxzID0gZ2V0Qm9hcmRDZWxscyhib2FyZElkKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdG9IaWdobGlnaHQgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0Q2VsbHNPbkJvYXJkKHNoaXBPYmosIHN0YXJ0Q2VsbCwgYm9hcmRDZWxscywgdG9IaWdobGlnaHQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNWYWxpZFBsYWNlbWVudCh0b0hpZ2hsaWdodCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodENlbGxzKHRvSGlnaGxpZ2h0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbGFzdERyYWdnZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0RHJhZ2dlZCA9IGdldExhc3RTaGlwU2l6ZUVsZW1lbnRzKGhpZ2hsaWdodGVkQ2VsbHMsIHNoaXBTaXplKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaGFuZGxlRHJhZ0xlYXZlKCkge1xuICAgICAgICByZW1vdmVIaWdobGlnaHQoKTtcbiAgICAgICAgaGlnaGxpZ2h0ZWRDZWxscy5sZW5ndGggPSAwO1xuICAgIH1cbiAgICBmdW5jdGlvbiBoYW5kbGVEcm9wKGUpIHtcbiAgICAgICAgcmVtb3ZlSGlnaGxpZ2h0KCk7XG4gICAgICAgIGNvbnN0IGxhc3QgPSBnZXRMYXN0U2hpcFNpemVFbGVtZW50cyhoaWdobGlnaHRlZENlbGxzLCBzaGlwU2l6ZSk7XG4gICAgICAgIGNvbnN0IHsgdGFyZ2V0LCBnYW1lYm9hcmQgfSA9IGdldEdhbWVib2FyZChlKTtcbiAgICAgICAgY29uc3QgYm9hcmRJZCA9IHRhcmdldC5jbG9zZXN0KCcuYm9hcmQnKS5pZDtcbiAgICAgICAgaWYgKGlzQm9hcmRWYWxpZChib2FyZElkKSAmJiBzaGlwT2JqICYmIGxhc3REcmFnZ2VkICE9PSBudWxsKSB7XG4gICAgICAgICAgICBwbGFjZVNoaXBPbkJvYXJkKGdhbWVib2FyZCwgc2hpcE9iaiwgbGFzdCwgb3JpZW50YXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIGdhbWVib2FyZC5yZW1vdmVSZXNlcnZlZFNwYWNlKGdhbWVib2FyZCk7XG4gICAgICAgIGdhbWVib2FyZC5yZXNlcnZlU3BhY2VGb3JBbGwoZ2FtZWJvYXJkKTtcbiAgICAgICAgY29udHJvbGxlci5yZW5ldygpO1xuICAgICAgICB1aS5jYW5CZVN0YXJ0ZWQoKTtcbiAgICAgICAgdWkuc2V0U3RhcnRNZXNzYWdlKCk7XG4gICAgICAgIGxhc3REcmFnZ2VkID0gbnVsbDtcbiAgICB9XG4gICAgZnVuY3Rpb24gaGFuZGxlRHJhZ0VuZChlKSB7XG4gICAgICAgIGNvbnN0IHRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgICB0YXJnZXQuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJztcbiAgICAgICAgcHJldmVudE9mZkJvYXJkUGxhY2VtZW50KHRhcmdldCwgZSk7XG4gICAgICAgIGlmICh1aS5jYW5CZVN0YXJ0ZWQoKSkge1xuICAgICAgICAgICAgdWkuZmlsbENlbGxzKCdzZWNvbmQnKTtcbiAgICAgICAgfVxuICAgICAgICB1aS5zZXRTdGFydE1lc3NhZ2UoKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaGFuZGxlTW91c2V1cChlKSB7XG4gICAgICAgIGNvbnN0IHsgZ2FtZWJvYXJkIH0gPSBnZXRHYW1lYm9hcmQoZSk7XG4gICAgICAgIGdhbWVib2FyZC5yZXNlcnZlU3BhY2VGb3JBbGwoZ2FtZWJvYXJkKTtcbiAgICAgICAgY29udHJvbGxlci5yZW5ldygpO1xuICAgICAgICB1aS5zZXRTdGFydE1lc3NhZ2UoKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaGFuZGxlUm90YXRlKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBjb25zdCB7IHRhcmdldCwgZ2FtZWJvYXJkIH0gPSBnZXRHYW1lYm9hcmQoZSk7XG4gICAgICAgIGNvbnN0IHsgc2hpcE5hbWUsIHNoaXBPYmogfSA9IHNldFNoaXBBdHRyaWJ1dGVzKGUsIHRhcmdldCk7XG4gICAgICAgIGNvbnN0IGN1cnJlbnQgPSBnYW1lYm9hcmQuc2hpcHNQbGFjZWQuZmlsdGVyKChzaGlwKSA9PiBzaGlwLnRha2VuQnkubmFtZS50b0xvd2VyQ2FzZSgpID09PSBzaGlwTmFtZSk7XG4gICAgICAgIGdhbWVib2FyZC5yZW1vdmVTaGlwKHNoaXBPYmosIGdhbWVib2FyZCk7XG4gICAgICAgIGdhbWVib2FyZC5yZW1vdmVSZXNlcnZlZFNwYWNlKGdhbWVib2FyZCk7XG4gICAgICAgIGdhbWVib2FyZC5yZXNlcnZlU3BhY2VGb3JBbGwoZ2FtZWJvYXJkKTtcbiAgICAgICAgc2hpcE9iai5yb3RhdGUoKTtcbiAgICAgICAgb3JpZW50YXRpb24gPSBzaGlwT2JqLmlzVmVydGljYWwgPyAndmVydGljYWwnIDogJ2hvcml6b250YWwnO1xuICAgICAgICBpZiAoIWdhbWVib2FyZC5jYW5CZVBsYWNlZChzaGlwT2JqLnNpemUsIGN1cnJlbnRbMF0uY29sLCBjdXJyZW50WzBdLnJvdywgb3JpZW50YXRpb24pKSB7XG4gICAgICAgICAgICBzaGlwT2JqLnJvdGF0ZSgpO1xuICAgICAgICAgICAgb3JpZW50YXRpb24gPSBzaGlwT2JqLmlzVmVydGljYWwgPyAndmVydGljYWwnIDogJ2hvcml6b250YWwnO1xuICAgICAgICB9XG4gICAgICAgIGdhbWVib2FyZC5wbGFjZVNoaXAoc2hpcE9iaiwgY3VycmVudFswXS5jb2wsIGN1cnJlbnRbMF0ucm93LCBvcmllbnRhdGlvbik7XG4gICAgICAgIGdhbWVib2FyZC5yZXNlcnZlU3BhY2VGb3JBbGwoZ2FtZWJvYXJkKTtcbiAgICAgICAgY29udHJvbGxlci5yZW5ldygpO1xuICAgICAgICBpZiAodWkuY2FuQmVTdGFydGVkKCkpIHtcbiAgICAgICAgICAgIHVpLmZpbGxDZWxscygnc2Vjb25kJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gYmxvY2tSaWdodENsaWNrKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBhZGRFdmVudExpc3RlbmVyc1RvQ2VsbHMoY2VsbHMpIHtcbiAgICAgICAgY2VsbHMuZm9yRWFjaCgoY2VsbCwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNlbGwuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLCBoYW5kbGVEcmFnT3ZlcihpbmRleCkpO1xuICAgICAgICAgICAgY2VsbC5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCBoYW5kbGVEcmFnTGVhdmUpO1xuICAgICAgICAgICAgY2VsbC5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgaGFuZGxlRHJvcCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhZGRFdmVudExpc3RlbmVyc1RvQ2VsbHMoZmlyc3RCb2FyZENlbGxzKTtcbiAgICBhZGRFdmVudExpc3RlbmVyc1RvQ2VsbHMoc2Vjb25kQm9hcmRDZWxscyk7XG4gICAgZHJhZ2dhYmxlcy5mb3JFYWNoKChkcmFnZ2FibGUpID0+IHtcbiAgICAgICAgZHJhZ2dhYmxlLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGhhbmRsZU1vdXNlZG93bik7XG4gICAgICAgIGRyYWdnYWJsZS5hZGRFdmVudExpc3RlbmVyKCdkcmFnc3RhcnQnLCBoYW5kbGVEcmFnU3RhcnQpO1xuICAgICAgICBkcmFnZ2FibGUuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VuZCcsIGhhbmRsZURyYWdFbmQpO1xuICAgICAgICBkcmFnZ2FibGUuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIGhhbmRsZU1vdXNldXApO1xuICAgICAgICBkcmFnZ2FibGUuYWRkRXZlbnRMaXN0ZW5lcignY29udGV4dG1lbnUnLCBoYW5kbGVSb3RhdGUpO1xuICAgICAgICBub25TaGlwQ2VsbHMuZm9yRWFjaCgoY2VsbCkgPT4gY2VsbC5hZGRFdmVudExpc3RlbmVyKCdjb250ZXh0bWVudScsIGJsb2NrUmlnaHRDbGljaykpO1xuICAgIH0pO1xufTtcbmV4cG9ydCBkZWZhdWx0IGRyYWdBbmREcm9wO1xuIiwidmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5pbXBvcnQgZHJhZ0FuZERyb3AgZnJvbSAnLi9kcmFnQW5kRHJvcCc7XG5pbXBvcnQgY29udHJvbGxlciBmcm9tICcuL2NvbnRyb2xsZXInO1xuY29uc3QgdWkgPSAoKCkgPT4ge1xuICAgIGNvbnN0IHN0YXR1c0JveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtZXNzYWdlQm94IHAnKTtcbiAgICBjb25zdCBib2FyZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYm9hcmRzJyk7XG4gICAgY29uc3QgcFZjQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3BsYXllclZzQ29tcHV0ZXInKTtcbiAgICBjb25zdCBuZXdHYW1lQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI25ld0dhbWUnKTtcbiAgICBjb25zdCBjVmNCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY29tcHV0ZXJWc0NvbXB1dGVyJyk7XG4gICAgY29uc3Qgc3RhcnRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc3RhcnQnKTtcbiAgICBjb25zdCByYW5kb21CdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcmFuZG9tUGxhY2VtZW50Jyk7XG4gICAgY29uc3QgYWxsQnRucyA9IFtwVmNCdG4sIG5ld0dhbWVCdG4sIGNWY0J0biwgc3RhcnRCdG4sIHJhbmRvbUJ0bl07XG4gICAgY29uc3Qgc3BlZWRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoJ3NwZWVkJyk7XG4gICAgbGV0IHNwZWVkVmFsdWUgPSAxMDAwO1xuICAgIGNvbnN0IGNyZWF0ZUNlbGwgPSAoY2VsbCkgPT4ge1xuICAgICAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnY2VsbCcpO1xuICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoY2VsbC5zdGF0dXMpO1xuICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1jb2wnLCBjZWxsLmNvbCk7XG4gICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXJvdycsIGNlbGwucm93KTtcbiAgICAgICAgaWYgKGNlbGwudGFrZW5CeSkge1xuICAgICAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtc2hpcE5hbWUnLCBjZWxsLnRha2VuQnkubmFtZS50b0xvd2VyQ2FzZSgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICB9O1xuICAgIGNvbnN0IHJlbmRlckNlbGxzID0gKGdhbWVib2FyZCwgYm9hcmQpID0+IHtcbiAgICAgICAgZ2FtZWJvYXJkLmFycmF5LmZvckVhY2goKHJvdykgPT4ge1xuICAgICAgICAgICAgcm93LmZvckVhY2goKGNvbCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNlbGwgPSBjcmVhdGVDZWxsKGNvbCk7XG4gICAgICAgICAgICAgICAgYm9hcmQuYXBwZW5kKGNlbGwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgY29uc3QgZ2V0Qm9hcmRJZCA9IChnYW1lYm9hcmQpID0+IHtcbiAgICAgICAgaWYgKGdhbWVib2FyZCA9PT0gY29udHJvbGxlci5odW1hbkdhbWVib2FyZCkge1xuICAgICAgICAgICAgcmV0dXJuICdmaXJzdEJvYXJkJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChnYW1lYm9hcmQgPT09IGNvbnRyb2xsZXIuY29tcHV0ZXJHYW1lYm9hcmQpIHtcbiAgICAgICAgICAgIHJldHVybiAnc2Vjb25kQm9hcmQnO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCByZW5kZXJCb2FyZCA9IChnYW1lYm9hcmQpID0+IHtcbiAgICAgICAgY29uc3QgYm9hcmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgYm9hcmQuY2xhc3NMaXN0LmFkZCgnYm9hcmQnKTtcbiAgICAgICAgYm9hcmQuaWQgPSBnZXRCb2FyZElkKGdhbWVib2FyZCk7XG4gICAgICAgIHJlbmRlckNlbGxzKGdhbWVib2FyZCwgYm9hcmQpO1xuICAgICAgICBib2FyZHMuYXBwZW5kKGJvYXJkKTtcbiAgICB9O1xuICAgIGNvbnN0IGNsZWFyU2hpcCA9IChzaGlwLCBnYW1lYm9hcmQpID0+IHtcbiAgICAgICAgY29uc3QgY2VsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGAjJHtnZXRCb2FyZElkKGdhbWVib2FyZCl9IC5jZWxsYCk7XG4gICAgICAgIGNlbGxzLmZvckVhY2goKGNlbGwpID0+IHtcbiAgICAgICAgICAgIGlmIChjZWxsLmNsYXNzTGlzdC5jb250YWlucygndGFrZW4nKSAmJiBjZWxsLmdldEF0dHJpYnV0ZSgnZGF0YS1zaGlwTmFtZScpID09PSBzaGlwLm5hbWUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LnJlbW92ZSgndGFrZW4nKTtcbiAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoJ2VtcHR5Jyk7XG4gICAgICAgICAgICAgICAgY2VsbC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtc2hpcE5hbWUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBjb25zdCByZWZyZXNoQm9hcmQgPSAoZ2FtZWJvYXJkKSA9PiB7XG4gICAgICAgIGNvbnN0IGJvYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7Z2V0Qm9hcmRJZChnYW1lYm9hcmQpfWApO1xuICAgICAgICBib2FyZC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgcmVuZGVyQ2VsbHMoZ2FtZWJvYXJkLCBib2FyZCk7XG4gICAgfTtcbiAgICBjb25zdCBnZXRVc2VySW5wdXQgPSAoZSkgPT4ge1xuICAgICAgICBpZiAoIWUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnaGl0JykgJiYgIWUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbWlzcycpKSB7XG4gICAgICAgICAgICBjb25zdCBjb2wgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtY29sJyk7XG4gICAgICAgICAgICBjb25zdCByb3cgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtcm93Jyk7XG4gICAgICAgICAgICByZXR1cm4geyBjb2wsIHJvdyB9O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBoYW5kbGVVc2VySW5wdXQgPSAoKSA9PiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgY29uc3QgY2VsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjc2Vjb25kQm9hcmQgLmNlbGwnKTtcbiAgICAgICAgbGV0IHVzZXJJbnB1dDtcbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgdXNlcklucHV0ID0geWllbGQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgICAgICAgICBjZWxscy5mb3JFYWNoKChjZWxsKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghY2VsbC5jbGFzc0xpc3QuY29udGFpbnMoJ2hpdCcpICYmICFjZWxsLmNsYXNzTGlzdC5jb250YWlucygnbWlzcycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGdldFVzZXJJbnB1dChlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCB7IG9uY2U6IHRydWUgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IHdoaWxlICghdXNlcklucHV0KTtcbiAgICAgICAgY29uc3QgY29sID0gdXNlcklucHV0LmNvbC50b1N0cmluZygpO1xuICAgICAgICBjb25zdCByb3cgPSB1c2VySW5wdXQucm93LnRvU3RyaW5nKCk7XG4gICAgICAgIHJldHVybiB7IGNvbCwgcm93IH07XG4gICAgfSk7XG4gICAgY29uc3QgaGFuZGxlUHZDID0gKCkgPT4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgIGZpbGxDZWxscygnZmlyc3QnKTtcbiAgICAgICAgd2FpdGluZyh0cnVlKTtcbiAgICAgICAgYWxsQnRucy5mb3JFYWNoKChidG4pID0+IChidG4uZGlzYWJsZWQgPSB0cnVlKSk7XG4gICAgICAgIHlpZWxkIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIGdldFNwZWVkVmFsdWUoKSkpO1xuICAgICAgICBhbGxCdG5zLmZvckVhY2goKGJ0bikgPT4gKGJ0bi5kaXNhYmxlZCA9IGZhbHNlKSk7XG4gICAgICAgIHdhaXRpbmcoZmFsc2UpO1xuICAgICAgICBjYW5CZVN0YXJ0ZWQoKTtcbiAgICAgICAgc2V0SW5pdE1lc3NhZ2UoKTtcbiAgICB9KTtcbiAgICBjb25zdCBoYW5kbGVOZXdHYW1lID0gKCkgPT4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgIHNldFJlc3RhcnRNZXNzYWdlKCk7XG4gICAgICAgIHdhaXRpbmcodHJ1ZSk7XG4gICAgICAgIGFsbEJ0bnMuZm9yRWFjaCgoYnRuKSA9PiAoYnRuLmRpc2FibGVkID0gdHJ1ZSkpO1xuICAgICAgICB5aWVsZCBjb250cm9sbGVyLm5ld0dhbWUoKTtcbiAgICAgICAgYWxsQnRucy5mb3JFYWNoKChidG4pID0+IChidG4uZGlzYWJsZWQgPSBmYWxzZSkpO1xuICAgICAgICB3YWl0aW5nKGZhbHNlKTtcbiAgICAgICAgY2FuQmVTdGFydGVkKCk7XG4gICAgICAgIGlmIChwVmNCdG4uY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpKSB7XG4gICAgICAgICAgICBzZXRJbml0TWVzc2FnZSgpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgY29uc3QgaGFuZGxlQ3ZDID0gKCkgPT4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgIHdhaXRpbmcodHJ1ZSk7XG4gICAgICAgIGFsbEJ0bnMuZm9yRWFjaCgoYnRuKSA9PiAoYnRuLmRpc2FibGVkID0gdHJ1ZSkpO1xuICAgICAgICB5aWVsZCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCBnZXRTcGVlZFZhbHVlKCkpKTtcbiAgICAgICAgYWxsQnRucy5mb3JFYWNoKChidG4pID0+IChidG4uZGlzYWJsZWQgPSBmYWxzZSkpO1xuICAgICAgICB3YWl0aW5nKGZhbHNlKTtcbiAgICAgICAgc3RhcnRCdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICByYW5kb21CdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICBjVmNCdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0pO1xuICAgIGNvbnN0IGhhbmRsZUdhbWVNb2RlID0gKHNlbGVjdGVkRWxlbWVudCwgZGVzZWxlY3RlZEVsZW1lbnQpID0+IHtcbiAgICAgICAgZGVzZWxlY3RlZEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKTtcbiAgICAgICAgaWYgKCFzZWxlY3RlZEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpKSB7XG4gICAgICAgICAgICBzZWxlY3RlZEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTtcbiAgICAgICAgICAgIGlmIChzZWxlY3RlZEVsZW1lbnQgPT09IHBWY0J0bikge1xuICAgICAgICAgICAgICAgIGhhbmRsZVB2QygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNlbGVjdGVkRWxlbWVudCA9PT0gY1ZjQnRuKSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlQ3ZDKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb250cm9sbGVyLnJlc3RhcnQoKTtcbiAgICAgICAgICAgIHNldFJlc3RhcnRNZXNzYWdlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IHdhaXRpbmcgPSAoYm9vbCkgPT4ge1xuICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LnRvZ2dsZSgnd2FpdCcsIGJvb2wpO1xuICAgIH07XG4gICAgY29uc3Qgc2V0Qm9hcmRQb2ludGVyID0gKHdoaWNoKSA9PiB7XG4gICAgICAgIGNvbnN0IHNlY29uZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzZWNvbmRCb2FyZCcpO1xuICAgICAgICBpZiAod2hpY2ggPT09ICdwbGF5ZXInKSB7XG4gICAgICAgICAgICBzZWNvbmQuY2xhc3NMaXN0LmFkZCgnYm9hcmRPdXRsaW5lJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAod2hpY2ggPT09ICdjb21wdXRlcicpIHtcbiAgICAgICAgICAgIHNlY29uZC5jbGFzc0xpc3QucmVtb3ZlKCdib2FyZE91dGxpbmUnKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3QgcmVtb3ZlQm9hcmRQb2ludGVyID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBzZWNvbmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc2Vjb25kQm9hcmQnKTtcbiAgICAgICAgc2Vjb25kLmNsYXNzTGlzdC5yZW1vdmUoJ2JvYXJkT3V0bGluZScpO1xuICAgIH07XG4gICAgY29uc3QgY3JlYXRlU2hpcE92ZXJsYXkgPSAoZ2FtZWJvYXJkKSA9PiB7XG4gICAgICAgIGdhbWVib2FyZC5zaGlwc1BsYWNlZC5mb3JFYWNoKChmaXJzdENlbGwpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHNoaXBFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBjb25zdCBzaGlwTmFtZSA9IGZpcnN0Q2VsbC50YWtlbkJ5Lm5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIGNvbnN0IHNoaXBTaXplID0gZmlyc3RDZWxsLnRha2VuQnkuc2l6ZTtcbiAgICAgICAgICAgIGNvbnN0IGlzVmVydGljYWwgPSBmaXJzdENlbGwudGFrZW5CeS5pc1ZlcnRpY2FsO1xuICAgICAgICAgICAgc2hpcEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnc2hpcCcsIHNoaXBOYW1lKTtcbiAgICAgICAgICAgIHNoaXBFbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1zaXplJywgYCR7c2hpcFNpemV9YCk7XG4gICAgICAgICAgICBzaGlwRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtbmFtZScsIGAke3NoaXBOYW1lfWApO1xuICAgICAgICAgICAgc2hpcEVsZW1lbnQuc2V0QXR0cmlidXRlKCdkcmFnZ2FibGUnLCAndHJ1ZScpO1xuICAgICAgICAgICAgc2hpcEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZHJhZ2dhYmxlJyk7XG4gICAgICAgICAgICBjb25zdCBzZXRTaGlwU3R5bGUgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaHRtbEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdodG1sJyk7XG4gICAgICAgICAgICAgICAgY29uc3Qgcm9vdEZvbnRTaXplID0gcGFyc2VGbG9hdCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShodG1sRWxlbWVudCwgbnVsbCkuZ2V0UHJvcGVydHlWYWx1ZSgnZm9udC1zaXplJykpO1xuICAgICAgICAgICAgICAgIGlmICghaXNWZXJ0aWNhbCkge1xuICAgICAgICAgICAgICAgICAgICBzaGlwRWxlbWVudC5zdHlsZS53aWR0aCA9IHNoaXBTaXplICogKGNlbGxTaXplIC8gcm9vdEZvbnRTaXplKSArICdyZW0nO1xuICAgICAgICAgICAgICAgICAgICBzaGlwRWxlbWVudC5zdHlsZS5oZWlnaHQgPSBjZWxsU2l6ZSAvIHJvb3RGb250U2l6ZSArICdyZW0nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChpc1ZlcnRpY2FsKSB7XG4gICAgICAgICAgICAgICAgICAgIHNoaXBFbGVtZW50LnN0eWxlLndpZHRoID0gY2VsbFNpemUgLyByb290Rm9udFNpemUgKyAncmVtJztcbiAgICAgICAgICAgICAgICAgICAgc2hpcEVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gc2hpcFNpemUgKiAoY2VsbFNpemUgLyByb290Rm9udFNpemUpICsgJ3JlbSc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGxldCBjZWxsU2l6ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ib2FyZCAuY2VsbCcpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoO1xuICAgICAgICAgICAgc2V0U2hpcFN0eWxlKCk7XG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNlbGxTaXplID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJvYXJkIC5jZWxsJykuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGg7XG4gICAgICAgICAgICAgICAgc2V0U2hpcFN0eWxlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IGZpcnN0Q2VsbEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtnZXRCb2FyZElkKGdhbWVib2FyZCl9IC5jZWxsW2RhdGEtY29sPVwiJHtmaXJzdENlbGwuY29sfVwiXVtkYXRhLXJvdz1cIiR7Zmlyc3RDZWxsLnJvd31cIl1gKTtcbiAgICAgICAgICAgIGZpcnN0Q2VsbEVsZW1lbnQuYXBwZW5kQ2hpbGQoc2hpcEVsZW1lbnQpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIGNvbnN0IGNhbkJlU3RhcnRlZCA9ICgpID0+IHtcbiAgICAgICAgaWYgKGNvbnRyb2xsZXIuaHVtYW5HYW1lYm9hcmQuc2hpcHNQbGFjZWQubGVuZ3RoID09PSA1ICYmIGNvbnRyb2xsZXIuY29tcHV0ZXJHYW1lYm9hcmQuc2hpcHNQbGFjZWQubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBmaWxsQ2VsbHMoJ3NlY29uZCcpO1xuICAgICAgICAgICAgc3RhcnRCdG4uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc3RhcnRCdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBzZXRJbml0TWVzc2FnZSA9ICgpID0+IHtcbiAgICAgICAgY29uc3Qgc3RhdHVzVGV4dE1vYmlsZSA9IFwiVXNlICdSYW5kb20gUGxhY2VtZW50JyBidXR0b24sIHRoZW4gcHJlc3MgU3RhcnQhXCI7XG4gICAgICAgIGNvbnN0IHN0YXR1c1RleHREZXNrdG9wID0gXCJEcmFnIGFuZCBkcm9wIHNoaXBzIG9udG8gdGhlIGxlZnQgYm9hcmQgb3IgdXNlICdSYW5kb20gUGxhY2VtZW50JyBidXR0b24uIFJpZ2h0IGNsaWNrIHRvIHJvdGF0ZS4gV2hlbiByZWFkeSwgcHJlc3MgU3RhcnQhXCI7XG4gICAgICAgIGlmIChzdGF0dXNCb3gudGV4dENvbnRlbnQgPT09IHN0YXR1c1RleHRNb2JpbGUgfHxcbiAgICAgICAgICAgIHN0YXR1c0JveC50ZXh0Q29udGVudCA9PT0gc3RhdHVzVGV4dERlc2t0b3AgfHxcbiAgICAgICAgICAgIHN0YXR1c0JveC50ZXh0Q29udGVudCA9PT0gJ1Jlc3RhcnRpbmcuLi4nIHx8XG4gICAgICAgICAgICBzdGF0dXNCb3gudGV4dENvbnRlbnQgPT09ICdZb3UgY2FuIG5vdyBiZWdpbiB0aGUgZ2FtZS4gUHJlc3Mgc3RhcnQhJykge1xuICAgICAgICAgICAgc3RhdHVzQm94LnRleHRDb250ZW50ID0gc3RhdHVzVGV4dE1vYmlsZTtcbiAgICAgICAgICAgIGlmICh3aW5kb3cubWF0Y2hNZWRpYSgnKG1pbi13aWR0aDogMTAyNHB4KScpLm1hdGNoZXMpIHtcbiAgICAgICAgICAgICAgICBzdGF0dXNCb3gudGV4dENvbnRlbnQgPSBzdGF0dXNUZXh0RGVza3RvcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3Qgc2V0U3RhcnRNZXNzYWdlID0gKCkgPT4ge1xuICAgICAgICBpZiAoY2FuQmVTdGFydGVkKCkpIHtcbiAgICAgICAgICAgIHN0YXR1c0JveC50ZXh0Q29udGVudCA9ICdZb3UgY2FuIG5vdyBiZWdpbiB0aGUgZ2FtZS4gUHJlc3Mgc3RhcnQhJztcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3Qgc2V0VHVybk1lc3NhZ2VQdkMgPSAoaXNQbGF5ZXJUdXJuKSA9PiB7XG4gICAgICAgIGlmIChpc1BsYXllclR1cm4pIHtcbiAgICAgICAgICAgIHN0YXR1c0JveC50ZXh0Q29udGVudCA9IFwiUGxheWVyJ3MgdHVybi4gVGFrZSBhaW0gYW5kIGF0dGFjayFcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHN0YXR1c0JveC50ZXh0Q29udGVudCA9IFwiQ29tcHV0ZXIncyB0dXJuLiBUaGUgc2hvdCBpcyBjb21pbmchXCI7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IHNldFR1cm5NZXNzYWdlQ3ZDID0gKGlzUGxheWVyVHVybikgPT4ge1xuICAgICAgICBpZiAoaXNQbGF5ZXJUdXJuKSB7XG4gICAgICAgICAgICBzdGF0dXNCb3gudGV4dENvbnRlbnQgPSBcIlZpb2xldCdzIHR1cm5cIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHN0YXR1c0JveC50ZXh0Q29udGVudCA9IFwiQmx1ZSdzIHR1cm5cIjtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3Qgc2V0R2FtZU92ZXJNZXNzYWdlUHZDID0gKHdobykgPT4ge1xuICAgICAgICBpZiAod2hvID09PSAncGxheWVyJykge1xuICAgICAgICAgICAgc3RhdHVzQm94LnRleHRDb250ZW50ID0gJ0dhbWUgb3ZlciwgUGxheWVyIHdpbnMhJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh3aG8gPT09ICdjb21wdXRlcicpIHtcbiAgICAgICAgICAgIHN0YXR1c0JveC50ZXh0Q29udGVudCA9ICdHYW1lIG92ZXIsIENvbXB1dGVyIHdpbnMhJztcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3Qgc2V0R2FtZU92ZXJNZXNzYWdlQ3ZDID0gKHdobykgPT4ge1xuICAgICAgICBpZiAod2hvID09PSAncGxheWVyJykge1xuICAgICAgICAgICAgc3RhdHVzQm94LnRleHRDb250ZW50ID0gJ0dhbWUgb3ZlciwgQmx1ZSBDb21wdXRlciB3aW5zISc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAod2hvID09PSAnY29tcHV0ZXInKSB7XG4gICAgICAgICAgICBzdGF0dXNCb3gudGV4dENvbnRlbnQgPSAnR2FtZSBvdmVyLCBWaW9sZXQgQ29tcHV0ZXIgd2lucyEnO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBzZXRSZXN0YXJ0TWVzc2FnZSA9ICgpID0+IHtcbiAgICAgICAgc3RhdHVzQm94LnRleHRDb250ZW50ID0gJ1Jlc3RhcnRpbmcuLi4nO1xuICAgIH07XG4gICAgY29uc3QgZmlsbENlbGxzID0gKGlucHV0KSA9PiB7XG4gICAgICAgIGxldCBib2FyZDtcbiAgICAgICAgaWYgKGlucHV0ID09PSAnZmlyc3QnKSB7XG4gICAgICAgICAgICBib2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNmaXJzdEJvYXJkJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaW5wdXQgPT09ICdzZWNvbmQnKSB7XG4gICAgICAgICAgICBib2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzZWNvbmRCb2FyZCcpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNlbGxzID0gYm9hcmQucXVlcnlTZWxlY3RvckFsbCgnLmNlbGwnKTtcbiAgICAgICAgY2VsbHMuZm9yRWFjaCgoY2VsbCkgPT4ge1xuICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKCdmaWxsZWQnKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBjb25zdCB1bkZpbGxDZWxscyA9IChpbnB1dCkgPT4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgIHdhaXRpbmcodHJ1ZSk7XG4gICAgICAgIGxldCBib2FyZDtcbiAgICAgICAgaWYgKGlucHV0ID09PSAnZmlyc3QnKSB7XG4gICAgICAgICAgICBib2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNmaXJzdEJvYXJkJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaW5wdXQgPT09ICdzZWNvbmQnKSB7XG4gICAgICAgICAgICBib2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzZWNvbmRCb2FyZCcpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNlbGxzID0gYm9hcmQucXVlcnlTZWxlY3RvckFsbCgnLmNlbGwnKTtcbiAgICAgICAgY2VsbHMuZm9yRWFjaCgoY2VsbCkgPT4ge1xuICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKCdmaWxsZWQnKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHlpZWxkIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgICBjZWxscy5mb3JFYWNoKChjZWxsLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5yZW1vdmUoJ2ZpbGxlZCcpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggPT09IGNlbGxzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIChnZXRTcGVlZFZhbHVlKCkgLyAxMjApICogaW5kZXgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICB3YWl0aW5nKGZhbHNlKTtcbiAgICB9KTtcbiAgICBwVmNCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGZpbGxDZWxscygnZmlyc3QnKTtcbiAgICAgICAgaGFuZGxlR2FtZU1vZGUocFZjQnRuLCBjVmNCdG4pO1xuICAgICAgICBjb25zdCBzZWNvbmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc2Vjb25kQm9hcmQnKTtcbiAgICAgICAgc2Vjb25kLmNsYXNzTGlzdC5yZW1vdmUoJ3N0YXJ0Jyk7XG4gICAgICAgIHN0YXJ0QnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgcFZjQnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgdW5GaWxsQ2VsbHMoJ2ZpcnN0Jyk7XG4gICAgfSk7XG4gICAgY1ZjQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBmaWxsQ2VsbHMoJ2ZpcnN0Jyk7XG4gICAgICAgIGZpbGxDZWxscygnc2Vjb25kJyk7XG4gICAgICAgIGhhbmRsZUdhbWVNb2RlKGNWY0J0biwgcFZjQnRuKTtcbiAgICAgICAgY29uc3Qgc2Vjb25kID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NlY29uZEJvYXJkJyk7XG4gICAgICAgIHNlY29uZC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlJyk7XG4gICAgICAgIHNlY29uZC5jbGFzc0xpc3QuYWRkKCdzdGFydCcpO1xuICAgICAgICBzdGFydEJ0bi5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgIHJhbmRvbUJ0bi5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgIGNWY0J0bi5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgIFByb21pc2UuYWxsKFt1bkZpbGxDZWxscygnZmlyc3QnKSwgdW5GaWxsQ2VsbHMoJ3NlY29uZCcpXSk7XG4gICAgfSk7XG4gICAgbmV3R2FtZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICBmaWxsQ2VsbHMoJ2ZpcnN0Jyk7XG4gICAgICAgIGlmIChjVmNCdG4uY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpKSB7XG4gICAgICAgICAgICBmaWxsQ2VsbHMoJ3NlY29uZCcpO1xuICAgICAgICAgICAgc3RhcnRCdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgcmFuZG9tQnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIGNWY0J0bi5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgdWkucmVtb3ZlQm9hcmRQb2ludGVyKCk7XG4gICAgICAgIHlpZWxkIGhhbmRsZU5ld0dhbWUoKTtcbiAgICAgICAgY29uc3Qgc2Vjb25kID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NlY29uZEJvYXJkJyk7XG4gICAgICAgIHNlY29uZC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlJyk7XG4gICAgICAgIGlmIChwVmNCdG4uY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpKSB7XG4gICAgICAgICAgICBzZWNvbmQuY2xhc3NMaXN0LnJlbW92ZSgnc3RhcnQnKTtcbiAgICAgICAgICAgIHVuRmlsbENlbGxzKCdmaXJzdCcpO1xuICAgICAgICAgICAgc3RhcnRCdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgcFZjQnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY1ZjQnRuLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSkge1xuICAgICAgICAgICAgc2Vjb25kLmNsYXNzTGlzdC5hZGQoJ3N0YXJ0Jyk7XG4gICAgICAgICAgICByYW5kb21CdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgUHJvbWlzZS5hbGwoW3VuRmlsbENlbGxzKCdmaXJzdCcpLCB1bkZpbGxDZWxscygnc2Vjb25kJyldKTtcbiAgICAgICAgICAgIHN0YXJ0QnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHJhbmRvbUJ0bi5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgICAgICBjVmNCdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfSkpO1xuICAgIHN0YXJ0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBjb250cm9sbGVyLnN0YXJ0KCk7XG4gICAgICAgIGNvbnN0IGZpcnN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2ZpcnN0Qm9hcmQnKTtcbiAgICAgICAgZmlyc3QuY2xhc3NMaXN0LmFkZCgnaGlkZScpO1xuICAgICAgICBjb25zdCBzZWNvbmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc2Vjb25kQm9hcmQnKTtcbiAgICAgICAgc2Vjb25kLmNsYXNzTGlzdC5hZGQoJ2hpZGUnKTtcbiAgICAgICAgc2Vjb25kLmNsYXNzTGlzdC5hZGQoJ3N0YXJ0Jyk7XG4gICAgICAgIHN0YXJ0QnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgcmFuZG9tQnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgdW5GaWxsQ2VsbHMoJ3NlY29uZCcpO1xuICAgIH0pO1xuICAgIHJhbmRvbUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgY29udHJvbGxlci5jb21wdXRlckdhbWVib2FyZC5jbGVhckJvYXJkKCk7XG4gICAgICAgIHJlZnJlc2hCb2FyZChjb250cm9sbGVyLmNvbXB1dGVyR2FtZWJvYXJkKTtcbiAgICAgICAgY29udHJvbGxlci5yYW5kb21pemVTaGlwc1BsYWNlbWVudChjb250cm9sbGVyLmh1bWFuR2FtZWJvYXJkKTtcbiAgICAgICAgZHJhZ0FuZERyb3AoY29udHJvbGxlci5odW1hbkdhbWVib2FyZCwgY29udHJvbGxlci5jb21wdXRlckdhbWVib2FyZCwgY29udHJvbGxlci5odW1hblNoaXBzKTtcbiAgICAgICAgY2FuQmVTdGFydGVkKCk7XG4gICAgICAgIHNldFN0YXJ0TWVzc2FnZSgpO1xuICAgICAgICBmaWxsQ2VsbHMoJ3NlY29uZCcpO1xuICAgIH0pO1xuICAgIHNwZWVkcy5mb3JFYWNoKChzcGVlZEJ0bikgPT4ge1xuICAgICAgICBzcGVlZEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIGxldCBpbnB1dCA9IHNwZWVkQnRuO1xuICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQpIHtcbiAgICAgICAgICAgICAgICBzcGVlZFZhbHVlID0gTnVtYmVyKGlucHV0LnZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgY29uc3QgZ2V0U3BlZWRWYWx1ZSA9ICgpID0+IHtcbiAgICAgICAgcmV0dXJuIHNwZWVkVmFsdWU7XG4gICAgfTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgc2V0SW5pdE1lc3NhZ2UpO1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlbmRlckJvYXJkLFxuICAgICAgICBjbGVhclNoaXAsXG4gICAgICAgIHJlZnJlc2hCb2FyZCxcbiAgICAgICAgaGFuZGxlVXNlcklucHV0LFxuICAgICAgICBwVmNCdG4sXG4gICAgICAgIGNWY0J0bixcbiAgICAgICAgd2FpdGluZyxcbiAgICAgICAgc2V0Qm9hcmRQb2ludGVyLFxuICAgICAgICByZW1vdmVCb2FyZFBvaW50ZXIsXG4gICAgICAgIGNyZWF0ZVNoaXBPdmVybGF5LFxuICAgICAgICBjYW5CZVN0YXJ0ZWQsXG4gICAgICAgIHNldEluaXRNZXNzYWdlLFxuICAgICAgICBzZXRTdGFydE1lc3NhZ2UsXG4gICAgICAgIHNldFR1cm5NZXNzYWdlUHZDLFxuICAgICAgICBzZXRUdXJuTWVzc2FnZUN2QyxcbiAgICAgICAgc2V0R2FtZU92ZXJNZXNzYWdlUHZDLFxuICAgICAgICBzZXRHYW1lT3Zlck1lc3NhZ2VDdkMsXG4gICAgICAgIHNldFJlc3RhcnRNZXNzYWdlLFxuICAgICAgICBnZXRTcGVlZFZhbHVlLFxuICAgICAgICBmaWxsQ2VsbHMsXG4gICAgICAgIHVuRmlsbENlbGxzLFxuICAgIH07XG59KSgpO1xuZXhwb3J0IGRlZmF1bHQgdWk7XG4iLCJ2YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbmltcG9ydCBnYW1lYm9hcmRGYWN0b3J5IGZyb20gJy4vZ2FtZWJvYXJkJztcbmltcG9ydCBzaGlwRmFjdG9yeSBmcm9tICcuL3NoaXAnO1xuaW1wb3J0IHBsYXllckZhY3RvcnkgZnJvbSAnLi9wbGF5ZXInO1xuaW1wb3J0IHVpIGZyb20gJy4vdWknO1xuaW1wb3J0IGRyYWdBbmREcm9wIGZyb20gJy4vZHJhZ0FuZERyb3AnO1xuY29uc3QgY29udHJvbGxlciA9ICgoKSA9PiB7XG4gICAgY29uc3QgaHVtYW5HYW1lYm9hcmQgPSBnYW1lYm9hcmRGYWN0b3J5KCk7XG4gICAgY29uc3QgY29tcHV0ZXJHYW1lYm9hcmQgPSBnYW1lYm9hcmRGYWN0b3J5KCk7XG4gICAgY29uc3QgaHVtYW4gPSBwbGF5ZXJGYWN0b3J5KCk7XG4gICAgY29uc3QgY29tcHV0ZXIgPSBwbGF5ZXJGYWN0b3J5KCk7XG4gICAgbGV0IGlzU3RvcHBlZCA9IHRydWU7XG4gICAgbGV0IGh1bWFuQ2FycmllciA9IHNoaXBGYWN0b3J5KCdDYXJyaWVyJyk7XG4gICAgbGV0IGh1bWFuQmF0dGxlc2hpcCA9IHNoaXBGYWN0b3J5KCdCYXR0bGVzaGlwJyk7XG4gICAgbGV0IGh1bWFuRGVzdHJveWVyID0gc2hpcEZhY3RvcnkoJ0Rlc3Ryb3llcicpO1xuICAgIGxldCBodW1hblN1Ym1hcmluZSA9IHNoaXBGYWN0b3J5KCdTdWJtYXJpbmUnKTtcbiAgICBsZXQgaHVtYW5QYXRyb2xib2F0ID0gc2hpcEZhY3RvcnkoJ1BhdHJvbEJvYXQnKTtcbiAgICBjb25zdCBodW1hblNoaXBzID0gW2h1bWFuQ2FycmllciwgaHVtYW5CYXR0bGVzaGlwLCBodW1hbkRlc3Ryb3llciwgaHVtYW5TdWJtYXJpbmUsIGh1bWFuUGF0cm9sYm9hdF07XG4gICAgY29uc3QgcG9wdWxhdGVTaGlwcyA9ICgpID0+IHtcbiAgICAgICAgY29tcHV0ZXJHYW1lYm9hcmQucGxhY2VTaGlwKGh1bWFuQ2FycmllciwgJ0EnLCAnMScsICdob3Jpem9udGFsJyk7XG4gICAgICAgIGNvbXB1dGVyR2FtZWJvYXJkLnBsYWNlU2hpcChodW1hbkJhdHRsZXNoaXAsICdBJywgJzMnLCAnaG9yaXpvbnRhbCcpO1xuICAgICAgICBjb21wdXRlckdhbWVib2FyZC5wbGFjZVNoaXAoaHVtYW5EZXN0cm95ZXIsICdBJywgJzUnLCAnaG9yaXpvbnRhbCcpO1xuICAgICAgICBjb21wdXRlckdhbWVib2FyZC5wbGFjZVNoaXAoaHVtYW5TdWJtYXJpbmUsICdBJywgJzcnLCAnaG9yaXpvbnRhbCcpO1xuICAgICAgICBjb21wdXRlckdhbWVib2FyZC5wbGFjZVNoaXAoaHVtYW5QYXRyb2xib2F0LCAnQScsICc5JywgJ2hvcml6b250YWwnKTtcbiAgICAgICAgY29tcHV0ZXJHYW1lYm9hcmQucmVzZXJ2ZVNwYWNlKGNvbXB1dGVyR2FtZWJvYXJkLCAnQScsICcxJyk7XG4gICAgICAgIGNvbXB1dGVyR2FtZWJvYXJkLnJlc2VydmVTcGFjZShjb21wdXRlckdhbWVib2FyZCwgJ0EnLCAnMycpO1xuICAgICAgICBjb21wdXRlckdhbWVib2FyZC5yZXNlcnZlU3BhY2UoY29tcHV0ZXJHYW1lYm9hcmQsICdBJywgJzUnKTtcbiAgICAgICAgY29tcHV0ZXJHYW1lYm9hcmQucmVzZXJ2ZVNwYWNlKGNvbXB1dGVyR2FtZWJvYXJkLCAnQScsICc3Jyk7XG4gICAgICAgIGNvbXB1dGVyR2FtZWJvYXJkLnJlc2VydmVTcGFjZShjb21wdXRlckdhbWVib2FyZCwgJ0EnLCAnOScpO1xuICAgIH07XG4gICAgY29uc3QgcmVuZXcgPSAoKSA9PiB7XG4gICAgICAgIHVpLnJlZnJlc2hCb2FyZChodW1hbkdhbWVib2FyZCk7XG4gICAgICAgIHVpLnJlZnJlc2hCb2FyZChjb21wdXRlckdhbWVib2FyZCk7XG4gICAgICAgIHVpLmNyZWF0ZVNoaXBPdmVybGF5KGh1bWFuR2FtZWJvYXJkKTtcbiAgICAgICAgdWkuY3JlYXRlU2hpcE92ZXJsYXkoY29tcHV0ZXJHYW1lYm9hcmQpO1xuICAgICAgICBkcmFnQW5kRHJvcChodW1hbkdhbWVib2FyZCwgY29tcHV0ZXJHYW1lYm9hcmQsIGh1bWFuU2hpcHMpO1xuICAgIH07XG4gICAgY29uc3QgaXNHYW1lT3ZlciA9ICgpID0+IHtcbiAgICAgICAgaWYgKGNvbXB1dGVyR2FtZWJvYXJkLmFsbFN1bmsoY29tcHV0ZXJHYW1lYm9hcmQpKSB7XG4gICAgICAgICAgICB1aS5yZW1vdmVCb2FyZFBvaW50ZXIoKTtcbiAgICAgICAgICAgIGlmICh1aS5wVmNCdG4uY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpKSB7XG4gICAgICAgICAgICAgICAgdWkuc2V0R2FtZU92ZXJNZXNzYWdlUHZDKCdwbGF5ZXInKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh1aS5jVmNCdG4uY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpKSB7XG4gICAgICAgICAgICAgICAgdWkuc2V0R2FtZU92ZXJNZXNzYWdlQ3ZDKCdwbGF5ZXInKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChodW1hbkdhbWVib2FyZC5hbGxTdW5rKGh1bWFuR2FtZWJvYXJkKSkge1xuICAgICAgICAgICAgdWkucmVtb3ZlQm9hcmRQb2ludGVyKCk7XG4gICAgICAgICAgICBpZiAodWkucFZjQnRuLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSkge1xuICAgICAgICAgICAgICAgIHVpLnNldEdhbWVPdmVyTWVzc2FnZVB2QygnY29tcHV0ZXInKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh1aS5jVmNCdG4uY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpKSB7XG4gICAgICAgICAgICAgICAgdWkuc2V0R2FtZU92ZXJNZXNzYWdlQ3ZDKCdjb21wdXRlcicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgY29uc3QgY29tcHV0ZXJBSSA9IChnYW1lYm9hcmQpID0+IHtcbiAgICAgICAgbGV0IHBsYXllcjtcbiAgICAgICAgaWYgKGdhbWVib2FyZCA9PT0gaHVtYW5HYW1lYm9hcmQpIHtcbiAgICAgICAgICAgIHBsYXllciA9IGNvbXB1dGVyO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGdhbWVib2FyZCA9PT0gY29tcHV0ZXJHYW1lYm9hcmQpIHtcbiAgICAgICAgICAgIHBsYXllciA9IGh1bWFuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChnYW1lYm9hcmQuaGl0QnV0Tm90U3VuayhnYW1lYm9hcmQpKSB7XG4gICAgICAgICAgICBpZiAocGxheWVyLmdldFByZXZIaXQoKSAhPT0gbnVsbCAmJlxuICAgICAgICAgICAgICAgIHBsYXllci5nZXRMYXN0SGl0KCkgIT09IG51bGwgJiZcbiAgICAgICAgICAgICAgICBnYW1lYm9hcmQuZ2V0Q2VsbChwbGF5ZXIuZ2V0TGFzdEhpdCgpLmNvbCwgcGxheWVyLmdldExhc3RIaXQoKS5yb3cpLnRha2VuQnkuaGl0Q291bnQgPj0gMiAmJlxuICAgICAgICAgICAgICAgIGdhbWVib2FyZC5nZXRDZWxsKHBsYXllci5nZXRMYXN0SGl0KCkuY29sLCBwbGF5ZXIuZ2V0TGFzdEhpdCgpLnJvdykudGFrZW5CeS5oaXRDb3VudCA8PSA0KSB7XG4gICAgICAgICAgICAgICAgcGxheWVyLmZpbmlzaGluZ0F0dGFjayhnYW1lYm9hcmQsIHBsYXllci5nZXRMYXN0SGl0KCkuY29sLCBwbGF5ZXIuZ2V0TGFzdEhpdCgpLnJvdywgcGxheWVyLmdldFByZXZIaXQoKSk7XG4gICAgICAgICAgICAgICAgZ2FtZWJvYXJkLnNpbmtTaGlwKGdhbWVib2FyZCwgcGxheWVyLmdldExhc3RIaXQoKS5jb2wsIHBsYXllci5nZXRMYXN0SGl0KCkucm93KTtcbiAgICAgICAgICAgICAgICBpZiAoaXNHYW1lT3ZlcigpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChnYW1lYm9hcmQuZ2V0Q2VsbChwbGF5ZXIuZ2V0TGFzdEhpdCgpLmNvbCwgcGxheWVyLmdldExhc3RIaXQoKS5yb3cpLnRha2VuQnkuaGl0Q291bnQgPT09IDEpIHtcbiAgICAgICAgICAgICAgICBwbGF5ZXIuZm9sbG93dXBBdHRhY2soZ2FtZWJvYXJkLCBwbGF5ZXIuZ2V0TGFzdEhpdCgpLmNvbCwgcGxheWVyLmdldExhc3RIaXQoKS5yb3cpO1xuICAgICAgICAgICAgICAgIGdhbWVib2FyZC5zaW5rU2hpcChnYW1lYm9hcmQsIHBsYXllci5nZXRMYXN0SGl0KCkuY29sLCBwbGF5ZXIuZ2V0TGFzdEhpdCgpLnJvdyk7XG4gICAgICAgICAgICAgICAgaWYgKGlzR2FtZU92ZXIoKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgeyBjb2wsIHJvdyB9ID0gcGxheWVyLnJhbmRvbUF0dGFjayhnYW1lYm9hcmQpO1xuICAgICAgICAgICAgaWYgKGdhbWVib2FyZC5nZXRDZWxsKGNvbCwgcm93KS5zdGF0dXMgPT09ICdoaXQnKSB7XG4gICAgICAgICAgICAgICAgcGxheWVyLnNldFByZXZIaXQocGxheWVyLmdldExhc3RIaXQoKSk7XG4gICAgICAgICAgICAgICAgcGxheWVyLnNldExhc3RIaXQoeyBjb2wsIHJvdyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIHJvdykuc3RhdHVzID09PSAnaGl0JyAmJiBnYW1lYm9hcmQuZ2V0Q2VsbChjb2wsIHJvdykudGFrZW5CeS5pc1N1bmsoKSkge1xuICAgICAgICAgICAgICAgIGdhbWVib2FyZC5zaW5rU2hpcChnYW1lYm9hcmQsIGNvbCwgcm93KTtcbiAgICAgICAgICAgICAgICBwbGF5ZXIuc2V0UHJldkhpdChudWxsKTtcbiAgICAgICAgICAgICAgICBwbGF5ZXIuc2V0TGFzdEhpdChudWxsKTtcbiAgICAgICAgICAgICAgICBpZiAoaXNHYW1lT3ZlcigpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IHBsYXllclZzQ29tcHV0ZXJNb2RlID0gKCkgPT4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgIGxldCBpc1BsYXllclR1cm4gPSB0cnVlO1xuICAgICAgICB3aGlsZSAoIWlzR2FtZU92ZXIoKSAmJiAhaXNTdG9wcGVkKSB7XG4gICAgICAgICAgICBpZiAoaXNQbGF5ZXJUdXJuKSB7XG4gICAgICAgICAgICAgICAgdWkuc2V0VHVybk1lc3NhZ2VQdkMoaXNQbGF5ZXJUdXJuKTtcbiAgICAgICAgICAgICAgICB1aS5zZXRCb2FyZFBvaW50ZXIoJ3BsYXllcicpO1xuICAgICAgICAgICAgICAgIHVpLndhaXRpbmcoZmFsc2UpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgY29sLCByb3cgfSA9IHlpZWxkIHVpLmhhbmRsZVVzZXJJbnB1dCgpO1xuICAgICAgICAgICAgICAgIGh1bWFuLmF0dGFjayhjb21wdXRlckdhbWVib2FyZCwgY29sLCByb3cpO1xuICAgICAgICAgICAgICAgIGNvbXB1dGVyR2FtZWJvYXJkLnNpbmtTaGlwKGNvbXB1dGVyR2FtZWJvYXJkLCBjb2wsIHJvdyk7XG4gICAgICAgICAgICAgICAgdWkucmVmcmVzaEJvYXJkKGNvbXB1dGVyR2FtZWJvYXJkKTtcbiAgICAgICAgICAgICAgICBpc1BsYXllclR1cm4gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpc0dhbWVPdmVyKCkgfHwgaXNTdG9wcGVkKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWlzUGxheWVyVHVybikge1xuICAgICAgICAgICAgICAgIHVpLnNldFR1cm5NZXNzYWdlUHZDKGlzUGxheWVyVHVybik7XG4gICAgICAgICAgICAgICAgdWkuc2V0Qm9hcmRQb2ludGVyKCdjb21wdXRlcicpO1xuICAgICAgICAgICAgICAgIHVpLndhaXRpbmcodHJ1ZSk7XG4gICAgICAgICAgICAgICAgeWllbGQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgdWkuZ2V0U3BlZWRWYWx1ZSgpKSk7XG4gICAgICAgICAgICAgICAgaWYgKCF1aS5wVmNCdG4uY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpIHx8IGlzU3RvcHBlZCkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29tcHV0ZXJBSShodW1hbkdhbWVib2FyZCk7XG4gICAgICAgICAgICAgICAgdWkucmVmcmVzaEJvYXJkKGh1bWFuR2FtZWJvYXJkKTtcbiAgICAgICAgICAgICAgICBpc1BsYXllclR1cm4gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlzU3RvcHBlZCA9IGZhbHNlO1xuICAgICAgICB1aS53YWl0aW5nKGZhbHNlKTtcbiAgICB9KTtcbiAgICBjb25zdCBjb21wdXRlclZzQ29tcHV0ZXJNb2RlID0gKCkgPT4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgIHVpLnJlbW92ZUJvYXJkUG9pbnRlcigpO1xuICAgICAgICBsZXQgaXNQbGF5ZXJUdXJuID0gdHJ1ZTtcbiAgICAgICAgd2hpbGUgKCFpc0dhbWVPdmVyKCkgJiYgIWlzU3RvcHBlZCkge1xuICAgICAgICAgICAgdWkud2FpdGluZyh0cnVlKTtcbiAgICAgICAgICAgIGlmIChpc1BsYXllclR1cm4pIHtcbiAgICAgICAgICAgICAgICB1aS5zZXRUdXJuTWVzc2FnZUN2Qyhpc1BsYXllclR1cm4pO1xuICAgICAgICAgICAgICAgIHlpZWxkIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIHVpLmdldFNwZWVkVmFsdWUoKSkpO1xuICAgICAgICAgICAgICAgIGlmICghdWkuY1ZjQnRuLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSB8fCBpc1N0b3BwZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbXB1dGVyQUkoaHVtYW5HYW1lYm9hcmQpO1xuICAgICAgICAgICAgICAgIHVpLnJlZnJlc2hCb2FyZChodW1hbkdhbWVib2FyZCk7XG4gICAgICAgICAgICAgICAgaXNQbGF5ZXJUdXJuID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXNHYW1lT3ZlcigpIHx8IGlzU3RvcHBlZCkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFpc1BsYXllclR1cm4pIHtcbiAgICAgICAgICAgICAgICB1aS5zZXRUdXJuTWVzc2FnZUN2Qyhpc1BsYXllclR1cm4pO1xuICAgICAgICAgICAgICAgIHlpZWxkIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIHVpLmdldFNwZWVkVmFsdWUoKSkpO1xuICAgICAgICAgICAgICAgIGlmICghdWkuY1ZjQnRuLmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSB8fCBpc1N0b3BwZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbXB1dGVyQUkoY29tcHV0ZXJHYW1lYm9hcmQpO1xuICAgICAgICAgICAgICAgIHVpLnJlZnJlc2hCb2FyZChjb21wdXRlckdhbWVib2FyZCk7XG4gICAgICAgICAgICAgICAgaXNQbGF5ZXJUdXJuID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpc1N0b3BwZWQgPSBmYWxzZTtcbiAgICAgICAgdWkud2FpdGluZyhmYWxzZSk7XG4gICAgfSk7XG4gICAgY29uc3QgcmFuZG9tUGxhY2VtZW50ID0gKGdhbWVib2FyZCkgPT4ge1xuICAgICAgICBsZXQgYWxsU2hpcHM7XG4gICAgICAgIGlmIChnYW1lYm9hcmQgPT09IGh1bWFuR2FtZWJvYXJkKSB7XG4gICAgICAgICAgICBodW1hbkNhcnJpZXIgPSBzaGlwRmFjdG9yeSgnQ2FycmllcicpO1xuICAgICAgICAgICAgaHVtYW5CYXR0bGVzaGlwID0gc2hpcEZhY3RvcnkoJ0JhdHRsZXNoaXAnKTtcbiAgICAgICAgICAgIGh1bWFuRGVzdHJveWVyID0gc2hpcEZhY3RvcnkoJ0Rlc3Ryb3llcicpO1xuICAgICAgICAgICAgaHVtYW5TdWJtYXJpbmUgPSBzaGlwRmFjdG9yeSgnU3VibWFyaW5lJyk7XG4gICAgICAgICAgICBodW1hblBhdHJvbGJvYXQgPSBzaGlwRmFjdG9yeSgnUGF0cm9sQm9hdCcpO1xuICAgICAgICAgICAgYWxsU2hpcHMgPSBbaHVtYW5DYXJyaWVyLCBodW1hbkJhdHRsZXNoaXAsIGh1bWFuRGVzdHJveWVyLCBodW1hblN1Ym1hcmluZSwgaHVtYW5QYXRyb2xib2F0XTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChnYW1lYm9hcmQgPT09IGNvbXB1dGVyR2FtZWJvYXJkKSB7XG4gICAgICAgICAgICBjb25zdCBjb21wdXRlckNhcnJpZXIgPSBzaGlwRmFjdG9yeSgnQ2FycmllcicpO1xuICAgICAgICAgICAgY29uc3QgY29tcHV0ZXJCYXR0bGVzaGlwID0gc2hpcEZhY3RvcnkoJ0JhdHRsZXNoaXAnKTtcbiAgICAgICAgICAgIGNvbnN0IGNvbXB1dGVyRGVzdHJveWVyID0gc2hpcEZhY3RvcnkoJ0Rlc3Ryb3llcicpO1xuICAgICAgICAgICAgY29uc3QgY29tcHV0ZXJTdWJtYXJpbmUgPSBzaGlwRmFjdG9yeSgnU3VibWFyaW5lJyk7XG4gICAgICAgICAgICBjb25zdCBjb21wdXRlclBhdHJvbGJvYXQgPSBzaGlwRmFjdG9yeSgnUGF0cm9sQm9hdCcpO1xuICAgICAgICAgICAgYWxsU2hpcHMgPSBbY29tcHV0ZXJDYXJyaWVyLCBjb21wdXRlckJhdHRsZXNoaXAsIGNvbXB1dGVyRGVzdHJveWVyLCBjb21wdXRlclN1Ym1hcmluZSwgY29tcHV0ZXJQYXRyb2xib2F0XTtcbiAgICAgICAgfVxuICAgICAgICBjb250cm9sbGVyLmh1bWFuU2hpcHMubGVuZ3RoID0gMDtcbiAgICAgICAgY29uc3QgY29scyA9IFsnQScsICdCJywgJ0MnLCAnRCcsICdFJywgJ0YnLCAnRycsICdIJywgJ0knLCAnSiddO1xuICAgICAgICBjb25zdCByYW5kb21Db2wgPSAoKSA9PiBjb2xzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNvbHMubGVuZ3RoKV07XG4gICAgICAgIGNvbnN0IHJhbmRvbVJvdyA9ICgpID0+IE1hdGguY2VpbChNYXRoLnJhbmRvbSgpICogMTApLnRvU3RyaW5nKCk7XG4gICAgICAgIGNvbnN0IHJhbmRvbU9yaWVudGF0aW9uID0gKCkgPT4gKE1hdGgucmFuZG9tKCkgPiAwLjUgPyAnaG9yaXpvbnRhbCcgOiAndmVydGljYWwnKTtcbiAgICAgICAgYWxsU2hpcHMuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgICAgICAgICAgbGV0IGNvbCA9IHJhbmRvbUNvbCgpO1xuICAgICAgICAgICAgbGV0IHJvdyA9IHJhbmRvbVJvdygpO1xuICAgICAgICAgICAgbGV0IG9yaWVudGF0aW9uID0gcmFuZG9tT3JpZW50YXRpb24oKTtcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSBnYW1lYm9hcmQuY2FuQmVQbGFjZWQoc2hpcC5zaXplLCBjb2wsIHJvdywgb3JpZW50YXRpb24pO1xuICAgICAgICAgICAgd2hpbGUgKCFyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBjb2wgPSByYW5kb21Db2woKTtcbiAgICAgICAgICAgICAgICByb3cgPSByYW5kb21Sb3coKTtcbiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbiA9IHJhbmRvbU9yaWVudGF0aW9uKCk7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gZ2FtZWJvYXJkLmNhbkJlUGxhY2VkKHNoaXAuc2l6ZSwgY29sLCByb3csIG9yaWVudGF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBnYW1lYm9hcmQucGxhY2VTaGlwKHNoaXAsIGNvbCwgcm93LCBvcmllbnRhdGlvbik7XG4gICAgICAgICAgICAgICAgZ2FtZWJvYXJkLnJlc2VydmVTcGFjZShnYW1lYm9hcmQsIGNvbCwgcm93KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnRyb2xsZXIuaHVtYW5TaGlwcy5wdXNoKHNoaXApO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIGNvbnN0IHJhbmRvbWl6ZVNoaXBzUGxhY2VtZW50ID0gKGdhbWVib2FyZCkgPT4ge1xuICAgICAgICBnYW1lYm9hcmQuY2xlYXJCb2FyZCgpO1xuICAgICAgICByYW5kb21QbGFjZW1lbnQoZ2FtZWJvYXJkKTtcbiAgICAgICAgdWkucmVmcmVzaEJvYXJkKGdhbWVib2FyZCk7XG4gICAgICAgIGlmIChnYW1lYm9hcmQgPT09IGh1bWFuR2FtZWJvYXJkKSB7XG4gICAgICAgICAgICB1aS5jcmVhdGVTaGlwT3ZlcmxheShnYW1lYm9hcmQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCByZXNldE9yaWVudGF0aW9uID0gKCkgPT4ge1xuICAgICAgICBodW1hblNoaXBzLmZvckVhY2goKHNoaXApID0+IHtcbiAgICAgICAgICAgIGlmIChzaGlwLmlzVmVydGljYWwgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICBzaGlwLmlzVmVydGljYWwgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBjb25zdCBwaWNrR2FtZU1vZGUgPSAoKSA9PiB7XG4gICAgICAgIGlmICh1aS5jVmNCdG4uY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpKSB7XG4gICAgICAgICAgICByYW5kb21pemVTaGlwc1BsYWNlbWVudChodW1hbkdhbWVib2FyZCk7XG4gICAgICAgICAgICByYW5kb21pemVTaGlwc1BsYWNlbWVudChjb21wdXRlckdhbWVib2FyZCk7XG4gICAgICAgICAgICBpc1N0b3BwZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGNvbXB1dGVyVnNDb21wdXRlck1vZGUoKTtcbiAgICAgICAgICAgIHVpLnJlZnJlc2hCb2FyZChodW1hbkdhbWVib2FyZCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IHN0YXJ0ID0gKCkgPT4ge1xuICAgICAgICB1aS5yZWZyZXNoQm9hcmQoaHVtYW5HYW1lYm9hcmQpO1xuICAgICAgICByYW5kb21pemVTaGlwc1BsYWNlbWVudChjb21wdXRlckdhbWVib2FyZCk7XG4gICAgICAgIGlzU3RvcHBlZCA9IGZhbHNlO1xuICAgICAgICBwbGF5ZXJWc0NvbXB1dGVyTW9kZSgpO1xuICAgIH07XG4gICAgY29uc3QgcmVzdGFydCA9ICgpID0+IHtcbiAgICAgICAgaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgaHVtYW4uc2V0UHJldkhpdChudWxsKTtcbiAgICAgICAgaHVtYW4uc2V0TGFzdEhpdChudWxsKTtcbiAgICAgICAgY29tcHV0ZXIuc2V0UHJldkhpdChudWxsKTtcbiAgICAgICAgY29tcHV0ZXIuc2V0TGFzdEhpdChudWxsKTtcbiAgICAgICAgaHVtYW5HYW1lYm9hcmQuY2xlYXJCb2FyZCgpO1xuICAgICAgICBjb21wdXRlckdhbWVib2FyZC5jbGVhckJvYXJkKCk7XG4gICAgICAgIHBvcHVsYXRlU2hpcHMoKTtcbiAgICAgICAgdWkucmVmcmVzaEJvYXJkKGh1bWFuR2FtZWJvYXJkKTtcbiAgICAgICAgdWkucmVmcmVzaEJvYXJkKGNvbXB1dGVyR2FtZWJvYXJkKTtcbiAgICAgICAgdWkuY3JlYXRlU2hpcE92ZXJsYXkoY29tcHV0ZXJHYW1lYm9hcmQpO1xuICAgICAgICBkcmFnQW5kRHJvcChodW1hbkdhbWVib2FyZCwgY29tcHV0ZXJHYW1lYm9hcmQsIGh1bWFuU2hpcHMpO1xuICAgICAgICB1aS5jYW5CZVN0YXJ0ZWQoKTtcbiAgICAgICAgcGlja0dhbWVNb2RlKCk7XG4gICAgICAgIHJlc2V0T3JpZW50YXRpb24oKTtcbiAgICB9O1xuICAgIGNvbnN0IG5ld0dhbWUgPSAoKSA9PiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgeWllbGQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgdWkuZ2V0U3BlZWRWYWx1ZSgpKSk7XG4gICAgICAgIGlzU3RvcHBlZCA9IGZhbHNlO1xuICAgICAgICByZXN0YXJ0KCk7XG4gICAgfSk7XG4gICAgY29uc3QgaW5pdCA9ICgpID0+IHtcbiAgICAgICAgdWkuc2V0SW5pdE1lc3NhZ2UoKTtcbiAgICAgICAgaHVtYW5HYW1lYm9hcmQuZ2VuZXJhdGVBcnJheSgpO1xuICAgICAgICBjb21wdXRlckdhbWVib2FyZC5nZW5lcmF0ZUFycmF5KCk7XG4gICAgICAgIHVpLnJlbmRlckJvYXJkKGh1bWFuR2FtZWJvYXJkKTtcbiAgICAgICAgdWkucmVuZGVyQm9hcmQoY29tcHV0ZXJHYW1lYm9hcmQpO1xuICAgICAgICBwb3B1bGF0ZVNoaXBzKCk7XG4gICAgICAgIHVpLnJlZnJlc2hCb2FyZChjb21wdXRlckdhbWVib2FyZCk7XG4gICAgICAgIHVpLmNyZWF0ZVNoaXBPdmVybGF5KGNvbXB1dGVyR2FtZWJvYXJkKTtcbiAgICAgICAgZHJhZ0FuZERyb3AoaHVtYW5HYW1lYm9hcmQsIGNvbXB1dGVyR2FtZWJvYXJkLCBodW1hblNoaXBzKTtcbiAgICAgICAgdWkuY2FuQmVTdGFydGVkKCk7XG4gICAgICAgIHBpY2tHYW1lTW9kZSgpO1xuICAgICAgICB1aS51bkZpbGxDZWxscygnZmlyc3QnKTtcbiAgICAgICAgdWkucFZjQnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9O1xuICAgIHJldHVybiB7IGluaXQsIHJlbmV3LCBodW1hbkdhbWVib2FyZCwgY29tcHV0ZXJHYW1lYm9hcmQsIHJlc3RhcnQsIG5ld0dhbWUsIHN0YXJ0LCByYW5kb21pemVTaGlwc1BsYWNlbWVudCwgaHVtYW5TaGlwcyB9O1xufSkoKTtcbmV4cG9ydCBkZWZhdWx0IGNvbnRyb2xsZXI7XG4iLCJpbXBvcnQgJ25vcm1hbGl6ZS5jc3MnO1xuaW1wb3J0ICcuL3N0eWxlL3N0eWxlLmNzcyc7XG5pbXBvcnQgY29udHJvbGxlciBmcm9tICcuL21vZHVsZXMvY29udHJvbGxlcic7XG5jb250cm9sbGVyLmluaXQoKTtcbiJdLCJuYW1lcyI6WyJjb2xzIiwicm93cyIsImFycmF5Iiwic2hpcHNQbGFjZWQiLCJnZXRDZWxsIiwiY29sIiwicm93IiwiY29sSW5kZXgiLCJpbmRleE9mIiwicm93SW5kZXgiLCJzZXRDZWxsIiwibmV3U3RhdHVzIiwibmV3VGFrZW5CeSIsInN0YXR1cyIsInRha2VuQnkiLCJnZW5lcmF0ZUFycmF5IiwiaSIsImoiLCJjbGVhckJvYXJkIiwiZmxhdCIsImZvckVhY2giLCJjZWxsIiwidW5kZWZpbmVkIiwibGVuZ3RoIiwicmVtb3ZlU2hpcCIsInNoaXAiLCJnYW1lYm9hcmQiLCJuYW1lIiwic2hpcEluZGV4Iiwic3BsaWNlIiwicGxhY2VTaGlwIiwib3JpZW50YXRpb24iLCJpc0hvcml6b250YWwiLCJjZWxscyIsInN0YXJ0IiwiaXNWZXJ0aWNhbCIsInNoaXBDZWxscyIsInNpemUiLCJjdXJyZW50Q29sIiwiY3VycmVudFJvdyIsInB1c2giLCJyZWNlaXZlQXR0YWNrIiwiaGl0IiwicmVjZWl2ZUFyb3VuZCIsInJlc2VydmVTcGFjZSIsImZpbHRlciIsImMiLCJkaXJlY3Rpb24iLCJuZXdDb2wiLCJTdHJpbmciLCJmcm9tQ2hhckNvZGUiLCJjaGFyQ29kZUF0IiwibmV3Um93IiwiTnVtYmVyIiwidG9TdHJpbmciLCJyZXNlcnZlU3BhY2VGb3JBbGwiLCJoaXRCdXROb3RTdW5rIiwic29tZSIsImlzU3VuayIsInNpbmtTaGlwIiwiYWxsU3VuayIsInRha2VuQnlDZWxscyIsImV2ZXJ5IiwiY2FuQmVQbGFjZWQiLCJhcmVFbXB0eSIsIml0ZW0iLCJyZW1vdmVSZXNlcnZlZFNwYWNlIiwiaGl0Q291bnQiLCJyb3RhdGUiLCJ0aGlzIiwicHJldkhpdCIsImxhc3RIaXQiLCJyYW5nZSIsImdvUmlnaHQiLCJnb0Rvd24iLCJmaW5pc2hpbmdBdHRhY2siLCJzZXRQcmV2SGl0Iiwic2V0TGFzdEhpdCIsIm5ld1ByZXZIaXQiLCJuZXdMYXN0SGl0IiwiYXR0YWNrIiwicmVzdWx0IiwicmFuZG9tQXR0YWNrIiwicmFuZG9tQ29sIiwicmFuZG9tUm93IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiY2VpbCIsImZvbGxvd3VwQXR0YWNrIiwidmFsaWREaXJlY3Rpb25zIiwicmFuZG9tRGlyZWN0aW9uIiwiZ2V0UHJldkhpdCIsImdldExhc3RIaXQiLCJfX2F3YWl0ZXIiLCJ0aGlzQXJnIiwiX2FyZ3VtZW50cyIsIlAiLCJnZW5lcmF0b3IiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImZ1bGZpbGxlZCIsInZhbHVlIiwic3RlcCIsIm5leHQiLCJlIiwicmVqZWN0ZWQiLCJkb25lIiwidGhlbiIsImFwcGx5IiwiZmlyc3RHYW1lYm9hcmQiLCJzZWNvbmRHYW1lYm9hcmQiLCJzaGlwcyIsImZpcnN0Qm9hcmRFbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwic2Vjb25kQm9hcmRFbGVtZW50IiwiZmlyc3RCb2FyZENlbGxzIiwicXVlcnlTZWxlY3RvckFsbCIsInNlY29uZEJvYXJkQ2VsbHMiLCJzaGlwTmFtZSIsInNoaXBTaXplIiwic2hpcE9iaiIsImdyYWJQb2ludFgiLCJncmFiUG9pbnRZIiwiaGlnaGxpZ2h0ZWRDZWxscyIsInNoaXBOYW1lVG9PYmoiLCJjYXJyaWVyIiwiYmF0dGxlc2hpcCIsImRlc3Ryb3llciIsInN1Ym1hcmluZSIsInBhdHJvbGJvYXQiLCJsYXN0RHJhZ2dlZCIsImRyYWdnYWJsZXMiLCJnZXROb25TaGlwQ2VsbHMiLCJib2FyZENlbGxzIiwiQXJyYXkiLCJmcm9tIiwiY2xhc3NMaXN0IiwiY29udGFpbnMiLCJub25TaGlwQ2VsbHMiLCJnZXRMYXN0U2hpcFNpemVFbGVtZW50cyIsInNsaWNlIiwibWluIiwiZ2V0R2FtZWJvYXJkIiwidGFyZ2V0IiwiYm9hcmRJZCIsImNsb3Nlc3QiLCJpZCIsInNldFNoaXBBdHRyaWJ1dGVzIiwiZ2V0QXR0cmlidXRlIiwib2Zmc2V0WCIsIm9mZnNldFkiLCJyZW1vdmVIaWdobGlnaHQiLCJoaWdobGlnaHRlZENlbGwiLCJyZW1vdmUiLCJpc0JvYXJkVmFsaWQiLCJoYW5kbGVNb3VzZWRvd24iLCJ0YXJnZXRTaGlwTmFtZSIsInJlbWFpbmluZ1NoaXBzIiwidG9Mb3dlckNhc2UiLCJyZXNlcnZlU3BhY2VGb3JSZW1haW5pbmdTaGlwcyIsInJlbmV3Iiwic2V0SW5pdE1lc3NhZ2UiLCJoYW5kbGVEcmFnU3RhcnQiLCJzZXRUaW1lb3V0Iiwic3R5bGUiLCJ2aXNpYmlsaXR5IiwiY2xlYXJTaGlwIiwiaGFuZGxlRHJhZ092ZXIiLCJpbmRleCIsInByZXZlbnREZWZhdWx0Iiwic3RhcnRDZWxsIiwib2Zmc2V0SGVpZ2h0Iiwib2Zmc2V0V2lkdGgiLCJnZXRTdGFydENlbGwiLCJnZXRCb2FyZENlbGxzIiwidG9IaWdobGlnaHQiLCJjZWxsSW5kZXgiLCJoaWdobGlnaHRDZWxsc09uQm9hcmQiLCJkYXRhc2V0IiwiaXNWYWxpZFBsYWNlbWVudCIsImFkZCIsImhpZ2hsaWdodENlbGxzIiwiaGFuZGxlRHJhZ0xlYXZlIiwiaGFuZGxlRHJvcCIsImxhc3QiLCJwbGFjZVNoaXBPbkJvYXJkIiwiY2FuQmVTdGFydGVkIiwic2V0U3RhcnRNZXNzYWdlIiwiaGFuZGxlRHJhZ0VuZCIsImJvYXJkIiwicHJldmVudE9mZkJvYXJkUGxhY2VtZW50IiwiZmlsbENlbGxzIiwiaGFuZGxlTW91c2V1cCIsImhhbmRsZVJvdGF0ZSIsImN1cnJlbnQiLCJibG9ja1JpZ2h0Q2xpY2siLCJhZGRFdmVudExpc3RlbmVyc1RvQ2VsbHMiLCJhZGRFdmVudExpc3RlbmVyIiwiZHJhZ2dhYmxlIiwidWkiLCJzdGF0dXNCb3giLCJib2FyZHMiLCJwVmNCdG4iLCJuZXdHYW1lQnRuIiwiY1ZjQnRuIiwic3RhcnRCdG4iLCJyYW5kb21CdG4iLCJhbGxCdG5zIiwic3BlZWRzIiwiZ2V0RWxlbWVudHNCeU5hbWUiLCJzcGVlZFZhbHVlIiwicmVuZGVyQ2VsbHMiLCJlbGVtZW50IiwiY3JlYXRlRWxlbWVudCIsInNldEF0dHJpYnV0ZSIsImNyZWF0ZUNlbGwiLCJhcHBlbmQiLCJnZXRCb2FyZElkIiwiaHVtYW5HYW1lYm9hcmQiLCJjb21wdXRlckdhbWVib2FyZCIsInJlZnJlc2hCb2FyZCIsImlubmVySFRNTCIsImdldFVzZXJJbnB1dCIsImhhbmRsZUdhbWVNb2RlIiwic2VsZWN0ZWRFbGVtZW50IiwiZGVzZWxlY3RlZEVsZW1lbnQiLCJ3YWl0aW5nIiwiYnRuIiwiZGlzYWJsZWQiLCJnZXRTcGVlZFZhbHVlIiwicmVzdGFydCIsInNldFJlc3RhcnRNZXNzYWdlIiwiYm9vbCIsImRvY3VtZW50RWxlbWVudCIsInRvZ2dsZSIsInN0YXR1c1RleHRNb2JpbGUiLCJzdGF0dXNUZXh0RGVza3RvcCIsInRleHRDb250ZW50Iiwid2luZG93IiwibWF0Y2hNZWRpYSIsIm1hdGNoZXMiLCJpbnB1dCIsInVuRmlsbENlbGxzIiwic2Vjb25kIiwiYWxsIiwicmVtb3ZlQm9hcmRQb2ludGVyIiwibmV3R2FtZSIsInJhbmRvbWl6ZVNoaXBzUGxhY2VtZW50IiwiaHVtYW5TaGlwcyIsInNwZWVkQnRuIiwiY2hlY2tlZCIsInJlbmRlckJvYXJkIiwicmVtb3ZlQXR0cmlidXRlIiwiaGFuZGxlVXNlcklucHV0IiwidXNlcklucHV0Iiwib25jZSIsInNldEJvYXJkUG9pbnRlciIsIndoaWNoIiwiY3JlYXRlU2hpcE92ZXJsYXkiLCJmaXJzdENlbGwiLCJzaGlwRWxlbWVudCIsInNldFNoaXBTdHlsZSIsImh0bWxFbGVtZW50Iiwicm9vdEZvbnRTaXplIiwicGFyc2VGbG9hdCIsImdldENvbXB1dGVkU3R5bGUiLCJnZXRQcm9wZXJ0eVZhbHVlIiwid2lkdGgiLCJjZWxsU2l6ZSIsImhlaWdodCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImFwcGVuZENoaWxkIiwic2V0VHVybk1lc3NhZ2VQdkMiLCJpc1BsYXllclR1cm4iLCJzZXRUdXJuTWVzc2FnZUN2QyIsInNldEdhbWVPdmVyTWVzc2FnZVB2QyIsIndobyIsInNldEdhbWVPdmVyTWVzc2FnZUN2QyIsImNvbnRyb2xsZXIiLCJodW1hbiIsInBsYXllciIsImNvbXB1dGVyIiwiaXNTdG9wcGVkIiwiaHVtYW5DYXJyaWVyIiwiaHVtYW5CYXR0bGVzaGlwIiwiaHVtYW5EZXN0cm95ZXIiLCJodW1hblN1Ym1hcmluZSIsImh1bWFuUGF0cm9sYm9hdCIsInBvcHVsYXRlU2hpcHMiLCJpc0dhbWVPdmVyIiwiY29tcHV0ZXJBSSIsImFsbFNoaXBzIiwicmFuZG9tT3JpZW50YXRpb24iLCJyYW5kb21QbGFjZW1lbnQiLCJwaWNrR2FtZU1vZGUiLCJpbml0Il0sInNvdXJjZVJvb3QiOiIifQ==